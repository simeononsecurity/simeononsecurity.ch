<!doctype html><html lang=en><head><title>Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts :: simeononsecurity — a security and automation blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts Download all supporting files from the GitHub Repository
 In today&amp;rsquo;s modern workplace environment, system administrators constantly are battling for time. Rolling out the latest Windows updates can be extremely time consuming taking up to a week given enough systems. Along with some assistance from Chocolatey, PSWindowsUpdates, and Startup Scripts, Systems Administrators can roll out update with as little as a single reboot of each machine."><meta name=keywords content="python python,compliance windows 10,cybersecurity hardening,automation hardening,python hardening,compliance compliance,compliance automation,automation compliance,compliance hardening,powershell security,windows 10 python,automation automation,automation windows 10,security hardening,windows 10 automation,powershell compliance,windows 10 powershell,security powershell,windows 10 cybersecurity,windows 10 hardening,automation python,security python,hardening powershell,compliance cybersecurity,cybersecurity security,python windows 10,windows 10 security,automation powershell,hardening compliance,security security,windows 10 compliance,hardening cybersecurity,powershell automation,security windows 10,python powershell,compliance powershell,powershell python,security cybersecurity,hardening windows 10,cybersecurity compliance,hardening python,hardening automation,security automation,powershell powershell,security compliance,hardening security,windows 10 windows 10,python compliance,powershell cybersecurity,compliance security,cybersecurity python,automation security,cybersecurity cybersecurity,compliance python,cybersecurity windows 10,cybersecurity powershell,python security,python cybersecurity,hardening hardening,automation cybersecurity,python automation,powershell windows 10,powershell hardening,cybersecurity automation,"><meta name=robots content="index,follow" content="all"><link rel=canonical href=../../posts/automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts/><meta name=author content="SimeonOnSecurity"><meta name=revisit-after content="1 days"><meta name=distribution content="article"><meta name=copyright content="SimeonOnSecurity"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="SimeonOnSecurity"><meta property="og:image" content="/img/banner.png"><meta property="og:url" content="https://simeononsecurity.ch"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts"><meta name=twitter:description content="Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts Download all supporting files from the GitHub Repository
 In today&rsquo;s modern workplace environment, system administrators constantly are battling for time. Rolling out the latest Windows updates can be extremely time consuming taking up to a week given enough systems. Along with some assistance from Chocolatey, PSWindowsUpdates, and Startup Scripts, Systems Administrators can roll out update with as little as a single reboot of each machine."><link rel=stylesheet href=../../css/style.min.css><link rel=stylesheet href=../../style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=../../img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=../../img/favicon.png><link rel=icon href=../../img/favicon.ico type=image/x-icon><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts"><meta name=twitter:description content="Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts Download all supporting files from the GitHub Repository
 In today&rsquo;s modern workplace environment, system administrators constantly are battling for time. Rolling out the latest Windows updates can be extremely time consuming taking up to a week given enough systems. Along with some assistance from Chocolatey, PSWindowsUpdates, and Startup Scripts, Systems Administrators can roll out update with as little as a single reboot of each machine."><meta property="og:title" content="Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts"><meta property="og:description" content="Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts Download all supporting files from the GitHub Repository
 In today&rsquo;s modern workplace environment, system administrators constantly are battling for time. Rolling out the latest Windows updates can be extremely time consuming taking up to a week given enough systems. Along with some assistance from Chocolatey, PSWindowsUpdates, and Startup Scripts, Systems Administrators can roll out update with as little as a single reboot of each machine."><meta property="og:type" content="article"><meta property="og:url" content="/posts/automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts/"><meta property="og:image" content="/img/banner.png"><meta property="article:published_time" content="2020-07-22T17:46:00-05:00"><meta property="article:modified_time" content="2020-07-22T17:46:00-05:00"><meta property="og:site_name" content="simeononsecurity"><link rel=alternate type=application/rss+xml title=simeononsecurity href=../../sitemap.xml><script data-ad-client=ca-pub-4092442123207538 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173461240-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-173461240-1');ga('set','userId','USER_ID');gtag('set',{'user_id':'USER_ID'});</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=../../ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=../../about>About</a></li><li><a href=../../posts>Posts</a></li><li><a href=../../recommendations>Recommendations</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=../../about>About</a></li><li><a href=../../posts>Posts</a></li><li><a href=../../recommendations>Recommendations</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title><a href=../../posts/automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts/>Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts</a></h1><div class=post-meta><span class=post-date>2020-07-22</span></div><span class=post-tags>#<a href=../../tags/automation/>Automation</a>&nbsp;
#<a href=../../tags/how-to-automate-windows-updates/>How To Automate Windows Updates</a>&nbsp;
#<a href=../../tags/windows-updates/>Windows Updates</a>&nbsp;
#<a href=../../tags/windows-10/>Windows 10</a>&nbsp;
#<a href=../../tags/powershell/>Powershell</a>&nbsp;
#<a href=../../tags/script/>Script</a>&nbsp;</span><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><a href=#how-to-set-up-the-shutdown-script>How to set up the shutdown script</a></li><li><a href=#how-the-script-works>How the script works</a></li></ul></nav></aside><h1 id=automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts>Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts</h1><p>Download all supporting files from the <a href=https://github.com/simeononsecurity/ChocoAutomateWindowsUpdates>GitHub Repository</a></p><p>     In today&rsquo;s modern workplace environment, system administrators constantly are battling for time. Rolling out the latest Windows updates can be extremely time consuming taking up to a week given enough systems.
Along with some assistance from Chocolatey, PSWindowsUpdates, and Startup Scripts, Systems Administrators can roll out update with as little as a single reboot of each machine.</p><h2 id=how-to-set-up-the-shutdown-script>How to set up the shutdown script</h2><p>We have chosen to set it up as a shutdown script to avoid having to reboot twice.
We will be following the tutorial from <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn789190(v=ws.11)">Microsoft</a> to do this.</p><p>In the windows gui perform the following steps:</p><p>1.) Open the Local Group Policy Editor by hitting <strong>&ldquo;Win + R&rdquo;</strong> and typing <strong>&ldquo;gpedit.msc&rdquo;</strong> followed by <strong>&ldquo;Ctrl + Shift + Enter&rdquo;</strong></p><p>2.) Navigate to Computer <strong>Configuration\Windows Settings\Scripts (Startup/Shutdown).</strong></p><p>3.) In the results pane, double-click Shutdown.</p><p>4.) Select the powershell tab</p><p>5.) In the Shutdown Properties dialog box, click Add.</p><p>6.) In the Script Name box, type the path to the script, or click Browse to search &ldquo;<em>chocoautomatewindowsupdates.ps1</em>&rdquo; in the Netlogon shared folder on the domain controller.</p><p>7.) Reboot</p><p>8.) Profit?</p><p>Now in the future, all an administrator has to do is reboot the computer to perform windows updates.</p><p>The same steps can be performed in GPO to acomplish the same thing on multiple Windows machines at the same time.</p><h2 id=how-the-script-works>How the script works</h2><p><strong>The script we will be working with today titled &ldquo;<em>chocoautomatewindowsupdates.ps1</em>":</strong></p><pre><code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
choco feature enable -n=allowGlobalConfirmation
choco feature enable -n useFipsCompliantChecksums
choco upgrade all
choco install pswindowsupdate
Add-WUServiceManager -ServiceID 7971f918-a847-4430-9279-4a52d1efe18d -Confirm:$false
Install-WindowsUpdate -MicrosoftUpdate -AcceptAll 
Get-WuInstall -AcceptAll -IgnoreReboot
</code></pre><p><strong>From <a href=https://chocolatey.org/install>Chocolatey</a>, the script below installs the Chocolatey package manager:</strong></p><pre><code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
</code></pre><p><strong>Folowed by a couple prefered Chocolatey configuration changes;</strong></p><pre><code>choco feature enable -n=allowGlobalConfirmation
choco feature enable -n useFipsCompliantChecksums
choco upgrade all
</code></pre><p><strong>Lastly we will install and run <a href=https://www.powershellgallery.com/packages/PSWindowsUpdate/2.0.0.4>PSWindowsUpdates</a> to install all of the available windows updates.</strong></p><pre><code>choco install pswindowsupdate
Add-WUServiceManager -ServiceID 7971f918-a847-4430-9279-4a52d1efe18d -Confirm:$false
Install-WindowsUpdate -MicrosoftUpdate -AcceptAll 
Get-WuInstall -AcceptAll -IgnoreReboot
</code></pre></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=../../posts/optimizing-and-hardening-windows10-deployments/><span class=button__icon>←</span>
<span class=button__text>Optimizing and Hardening Windows 10 Deployments</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div><span><a href=../../contactus/ target=_blank rel=noopener>Contact</a></span></span></div><div><span><a href=../../privacypolicy/ target=_blank rel=noopener>Privacy</a></span></div><div><span><a href=../../termsandconditions/ target=_blank rel=noopener>Terms</a></span></span></div><div><span><a href=../../sitemap.xml target=_blank rel=noopener>Sitemap</a></span></span></div><div><span><a href=../../index.xml target=_blank rel=noopener>RSS</a></span></span></div><div class=copyright><span>© 2020 SimeonOnSecurity</span></div></div></footer><script src=../../js/menu.js></script><script src=../../js/theme.js></script><script src=../../js/prism.js></script></div></body></html>