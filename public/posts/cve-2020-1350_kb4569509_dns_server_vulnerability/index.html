<!doctype html><html lang=en><head><title>CVE-2020-1350 KB4569509 DNS Server Vulnerability :: simeononsecurity — a security and automation blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content><meta name=keywords content="python python,compliance windows 10,cybersecurity hardening,automation hardening,python hardening,compliance compliance,compliance automation,automation compliance,compliance hardening,powershell security,windows 10 python,automation automation,automation windows 10,security hardening,windows 10 automation,powershell compliance,windows 10 powershell,security powershell,windows 10 cybersecurity,windows 10 hardening,automation python,security python,hardening powershell,compliance cybersecurity,cybersecurity security,python windows 10,windows 10 security,automation powershell,hardening compliance,security security,windows 10 compliance,hardening cybersecurity,powershell automation,security windows 10,python powershell,compliance powershell,powershell python,security cybersecurity,hardening windows 10,cybersecurity compliance,hardening python,hardening automation,security automation,powershell powershell,security compliance,hardening security,windows 10 windows 10,python compliance,powershell cybersecurity,compliance security,cybersecurity python,automation security,cybersecurity cybersecurity,compliance python,cybersecurity windows 10,cybersecurity powershell,python security,python cybersecurity,hardening hardening,automation cybersecurity,python automation,powershell windows 10,powershell hardening,cybersecurity automation,"><meta name=robots content="noodp"><link rel=canonical href=../../posts/cve-2020-1350_kb4569509_dns_server_vulnerability/><link rel=stylesheet href=../../assets/style.css><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro" rel=stylesheet type=text/css><link rel=stylesheet href=../../assets/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=../../img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=../../img/favicon.png><meta name=twitter:card content="summary"><meta name=twitter:title content="CVE-2020-1350 KB4569509 DNS Server Vulnerability :: simeononsecurity — a security and automation blog"><meta name=twitter:description content="KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350 Introduction On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience."><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:image content="/img/default.jpg"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="CVE-2020-1350 KB4569509 DNS Server Vulnerability :: simeononsecurity — a security and automation blog"><meta property="og:description" content><meta property="og:url" content="/posts/cve-2020-1350_kb4569509_dns_server_vulnerability/"><meta property="og:site_name" content="CVE-2020-1350 KB4569509 DNS Server Vulnerability"><meta property="og:image" content="/img/default.jpg"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-07-25 21:09:37 -0500 CDT"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=../../ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=../../about>About</a></li><li><a href=../../posts>Posts</a></li><li><a href=../../recommendations>Recommendations</a></li><li><a href=../../writeups>Writeups</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h2 class=post-title><a href=../../posts/cve-2020-1350_kb4569509_dns_server_vulnerability/>CVE-2020-1350 KB4569509 DNS Server Vulnerability</a></h2><div class=post-meta><span class=post-date>2020-07-25</span>
<span class=post-author>Written by</span></div><span class=post-tags>#<a href=../../tags/cve-2020-1350>CVE-2020-1350</a>&nbsp;
#<a href=../../tags/kb4569509>KB4569509</a>&nbsp;
#<a href=../../tags/dns-server-vulnerability>DNS Server Vulnerability</a>&nbsp;
#<a href=../../tags/windows-server>Windows Server</a>&nbsp;
#<a href=../../tags/powershell>Powershell</a>&nbsp;
#<a href=../../tags/script>Script</a>&nbsp;</span><div class=post-content><h1 id=kb4569509-guidance-for-dns-server-vulnerability-cve-2020-1350httpssupportmicrosoftcomen-ushelp4569509windows-dns-server-remote-code-execution-vulnerability><a href=https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability>KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350</a></h1><h2 id=introduction>Introduction</h2><p>On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience.</p><p>A registry-based workaround can be used to help protect an affected Windows server, and it can be implemented without requiring an administrator to restart the server. Because of the volatility of this vulnerability, administrators may have to implement the workaround before they apply the security update in order to enable them to update their systems by using a standard deployment cadence.</p><h2 id=workaround>Workaround</h2><p><strong>Optional:</strong> Download the workaround script from the <a href=https://github.com/simeononsecurity/CVE-2020-1350-Fix>GitHub Repository</a></p><p>To work around this vulnerability, make the following registry change to restrict the size of the largest inbound TCP-based DNS response packet that&rsquo;s allowed:</p><p>Subkey: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters</p><p>Value: TcpReceivePacketSize</p><p>Type: DWORD</p><p>Value data: 0xFF00</p><p><strong>Notes:</strong></p><pre><code>The default (also maximum) Value data = 0xFFFF.

The recommended Value data = 0xFF00 (255 bytes less than the maximum).

You must restart the DNS Service for the registry change to take effect. To do this, run the following command at an elevated command prompt:
</code></pre><p>          <code>net stop dns && net start dns</code></p><h2 id=important-information-about-this-workaround>Important information about this workaround</h2><p>TCP-based DNS response packets that exceed the recommended value will be dropped without error. Therefore, it is possible that some queries might not be answered. This could cause an unanticipated failure. A DNS server will be negatively impacted by this workaround only if it receives valid TCP responses that are greater than allowed in the previous mitigation (more than 65,280 bytes).</p><p>The reduced value is unlikely to affect standard deployments or recursive queries. However, a non-standard use-case may exist in a given environment. To determine whether the server implementation will be adversely affected by this workaround, you should enable diagnostic logging, and capture a sample set that is representative of your typical business flow. Then, you will have to review the log files to identify the presence of anomalously large TCP response packets</p><p>For more information, see <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn800669%28v=ws.11%29">DNS Logging and Diagnostics</a>.</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=../../posts/hardening-apache/><span class=button__icon>←</span>
<span class=button__text>Hardening Apache Web Server</span></a></span>
<span class="button next"><a href=../../posts/brave-admx-templates/><span class=button__text>Brave ADMX Templates</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><a href=../../ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></div></a><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Theme created by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=../../assets/main.js></script><script src=../../assets/prism.js></script></div></body></html>