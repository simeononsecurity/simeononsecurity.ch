<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Powershell on simeononsecurity</title><link>/tags/powershell/</link><description>Recent content in Powershell on simeononsecurity</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 18 Feb 2021 00:00:00 +0000</lastBuildDate><atom:link href="/tags/powershell/index.xml" rel="self" type="application/rss+xml"/><item><title>Today I Learned How to Manipulate and Parse JSON in PowerShell and Bash</title><link>/til/2021-02-17/</link><pubDate>Thu, 18 Feb 2021 00:00:00 +0000</pubDate><guid>/til/2021-02-17/</guid><description>
&lt;h1 id="today-i-learned--read-about">Today I learned / Read About&amp;hellip;&lt;/h1>
&lt;p>&lt;strong>What SimeonOnSecurity learned about and found interesting today&lt;/strong>&lt;/p>
&lt;h2 id="updated-pages">Updated Pages:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://simeononsecurity.com/writeups/hackthebox-invite-challenge/">HackTheBox - Invite Challenge (Windows/Linux)&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="learning-resources">Learning Resources:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://cameronnokes.com/blog/working-with-json-in-bash-using-jq/">Cameron Nokes - Working with JSON in bash using jq&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertfrom-json?view=powershell-7.1">Microsoft - ConvertFrom-Json&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertto-json?view=powershell-7.1">Microsoft - ConvertTo-Json&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Optimize and Debloat Windows 10 Deployments</title><link>/github/windows-optimize-harden-debloat/</link><pubDate>Tue, 29 Dec 2020 00:00:00 +0000</pubDate><guid>/github/windows-optimize-harden-debloat/</guid><description>
&lt;h1 id="windows-optimize-debloat">Windows-Optimize-Debloat&lt;/h1>
&lt;p>For those who seek to minimize their Windows 10 installs.&lt;/p>
&lt;p>&lt;strong>Download all the required files from the &lt;a href="https://github.com/simeononsecurity/Windows-Optimize-Debloat">GitHub Repository&lt;/a>&lt;/strong>&lt;/p>
&lt;h2 id="introduction">Introduction:&lt;/h2>
&lt;p>Windows 10 is an invasive and insecure operating system out of the box.
Organizations like &lt;a href="https://microsoft.com">Microsoft&lt;/a>, &lt;a href="https://PrivacyTools.io">PrivacyTools.io&lt;/a>, and others have recommended configuration changes to optimize and debloat the Windows 10 operating system. These changes are include blocking telemetry, deleting logs, and removing bloatware to name a few. This script aims to automate the configurations recommended by those organizations.&lt;/p>
&lt;h2 id="notes">Notes:&lt;/h2>
&lt;ul>
&lt;li>This script is designed for operation in primarily &lt;strong>Personal Use&lt;/strong> environments.&lt;/li>
&lt;li>This script is designed in such a way that the optimizations, unlike some other scripts, will not break core windows functionality.&lt;/li>
&lt;li>Features like Windows Update, Windows Defender, the Windows Store, and Cortona have been restricted, but are not in a disfunctional state like most other Windows 10 Privacy scripts.&lt;/li>
&lt;li>If you seek a minimized script targeted only to commercial environments, please see this &lt;a href="https://github.com/simeononsecurity/Standalone-Windows-STIG-Script">GitHub Repository&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="requirements">Requirements:&lt;/h2>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Windows 10 Enterprise, Windows 10 Professional, or Windows 10 Home
&lt;ul>
&lt;li>Windows 10 Home does not allow for GPO configurations.
&lt;ul>
&lt;li>Script will still work but not all settings will apply.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Windows 10 &amp;ldquo;N&amp;rdquo; Editions are not tested.&lt;/li>
&lt;li>Currently Windows 10 &lt;strong>v1909&lt;/strong>, &lt;strong>v2004&lt;/strong>, or &lt;strong>20H2&lt;/strong>.&lt;/li>
&lt;li>Run the &lt;a href="https://support.microsoft.com/en-us/help/3159635/windows-10-update-assistant">Windows 10 Upgrade Assistant&lt;/a> to update and verify latest major release.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="a-list-of-scripts-and-tools-this-collection-utilizes">A list of scripts and tools this collection utilizes:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=55319">Microsoft Security Compliance Toolkit 1.0&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="additional-configurations-were-considered-from">Additional configurations were considered from:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/builtbybel/privatezilla">BuiltByBel - PrivateZilla&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kb.cert.org/vuls/id/573168/">CERT - IE Scripting Engine Memory Corruption&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft-services">Microsoft - Managing Windows 10 Telemetry and Callbacks&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/privacy/">Microsoft - Windows 10 Privacy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds_vdi-recommendations-1909">Microsoft - Windows 10 VDI Recomendations&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/builtbybel/sharpapp">Mirinsoft - SharpApp&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/builtbybel/debotnet">Mirinsoft - debotnet&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/undergroundwires/privacy.sexy">UnderGroundWires - Privacy.S**Y&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/Sycnex/Windows10Debloater">Sycnex - Windows10Debloater&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/The-Virtual-Desktop-Team/Virtual-Desktop-Optimization-Tool">The-Virtual-Desktop-Team - Virtual-Desktop-Optimization-Tool&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/TheVDIGuys/Windows_10_VDI_Optimize">TheVDIGuys - Windows 10 VDI Optimize&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/W4RH4WK/Debloat-Windows-10/tree/master/scripts">W4H4WK - Debloat Windows 10&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;h3 id="manual-install">Manual Install:&lt;/h3>
&lt;p>If manually downloaded, the script must be launched from an administrative powershell in the directory containing all the files from the &lt;a href="https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat">GitHub Repository&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
Get-ChildItem -Recurse *.ps1 | Unblock-File
.\sos-optimize-windows.ps1
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="automated-install">Automated Install:&lt;/h3>
&lt;p>The script may be launched from the extracted GitHub download like this:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">iex ((New-Object System.Net.WebClient).DownloadString(&lt;span style="color:#e6db74">&amp;#39;https://simeononsecurity.ch/scripts/windowsoptimizeanddebloat.ps1&amp;#39;&lt;/span>))
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>GLVK Auto Install Script for KMS Activation</title><link>/github/kms-auto-ps/</link><pubDate>Fri, 18 Dec 2020 00:00:00 +0000</pubDate><guid>/github/kms-auto-ps/</guid><description>
&lt;h1 id="simeononsecurity---kms-auto-ps">SimeonOnSecurity - KMS-Auto-PS&lt;/h1>
&lt;p>GLVK Auto Install Script for KMS Activation&lt;/p>
&lt;h2 id="recommened-reading">Recommened Reading:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows-server/get-started/kmsclientkeys">Microsoft - KMS Client Keys (GLVK)&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;h3 id="manual-install">Manual Install:&lt;/h3>
&lt;p>If manually downloaded, the script must be launched from an administrative powershell in the directory containing all the files from the &lt;a href="https://github.com/simeononsecurity/KMS-Auto-PS/archive/main.zip">GitHub Repository&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ps" data-lang="ps">&lt;span style="color:#a6e22e">Set-ExecutionPolicy&lt;/span> &lt;span style="color:#a6e22e">-ExecutionPolicy&lt;/span> &lt;span style="color:#a6e22e">RemoteSigned&lt;/span> &lt;span style="color:#a6e22e">-Force&lt;/span>
&lt;span style="color:#a6e22e">Get-ChildItem&lt;/span> &lt;span style="color:#a6e22e">-Recurse&lt;/span> &lt;span style="color:#a6e22e">*.ps1&lt;/span> &lt;span style="color:#a6e22e">|&lt;/span> &lt;span style="color:#a6e22e">Unblock-File&lt;/span>
&lt;span style="color:#a6e22e">.\sos-kmsglvkactivationauto.ps1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Harden Windows with Windows Defender Application Control (WDAC)</title><link>/github/windows-defender-application-control-hardening/</link><pubDate>Wed, 16 Dec 2020 00:00:00 +0000</pubDate><guid>/github/windows-defender-application-control-hardening/</guid><description>
&lt;h1 id="windows-defender-application-control-hardening">Windows-Defender-Application-Control-Hardening&lt;/h1>
&lt;p>Harden Windows with Windows Defender Application Control (WDAC)&lt;/p>
&lt;h2 id="a-list-of-scripts-and-tools-this-collection-utilizes">A list of scripts and tools this collection utilizes:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/MicrosoftDocs/WDAC-Toolkit">MicrosoftDocs - WDAC-Toolkit&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="additional-configurations-were-considered-from">Additional configurations were considered from:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules">Microsoft - Recommended block rules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules">Microsoft - Recommended driver block rules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control-design-guide">Microsoft - Windows Defender Application Control&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="explanation">Explanation:&lt;/h2>
&lt;h3 id="xml-vs-bin">XML vs. BIN:&lt;/h3>
&lt;ul>
&lt;li>Simply put, the &lt;strong>&amp;ldquo;XML&amp;rdquo;&lt;/strong> policies are for applying to a machine locally and the &lt;strong>&amp;ldquo;BIN&amp;rdquo;&lt;/strong> files are for enforcing them with either &lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-using-group-policy">Group Policy&lt;/a> or &lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-using-intune">Microsoft Intune&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h3 id="policy-descriptions">Policy Descriptions:&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>Default Policies:&lt;/strong>
&lt;ul>
&lt;li>The &amp;ldquo;Default&amp;rdquo; policies use only the default features available in the WDAC-Toolkit.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>Recommended Policies:&lt;/strong>
&lt;ul>
&lt;li>The &amp;ldquo;Recommended&amp;rdquo; policies use the default features as well as Microsoft&amp;rsquo;s recommended &lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules">blocks&lt;/a> and &lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules">driver block&lt;/a> rules.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>Audit Policies:&lt;/strong>
&lt;ul>
&lt;li>The &amp;ldquo;Audit&amp;rdquo; policies, just log exceptions to the rules. This is for testing in your environment, so that you may modify the policies, at will, to fit your environments needs.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>Enforced Policies:&lt;/strong>
&lt;ul>
&lt;li>The &amp;ldquo;Enforced&amp;rdquo; policies will not allow any exceptions to the rules, applications, drivers, dlls, etc. will be blocked if they do not comply.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="available-policies">Available Policies:&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>XML:&lt;/strong>
&lt;ul>
&lt;li>&lt;strong>Audit Only:&lt;/strong>
&lt;ul>
&lt;li>&lt;code>WDAC_V1_Default_Audit.xml&lt;/code>&lt;/li>
&lt;li>&lt;code>WDAC_V1_Recommended_Audit.xml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>Enforced:&lt;/strong>
&lt;ul>
&lt;li>&lt;code>WDAC_V1_Default_Enforced.xml&lt;/code>&lt;/li>
&lt;li>&lt;code>WDAC_V1_Recommended_Enforced.xml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>BIN:&lt;/strong>
&lt;ul>
&lt;li>&lt;strong>Audit Only:&lt;/strong>
&lt;ul>
&lt;li>&lt;code>WDAC_V1_Default_Audit.bin&lt;/code>&lt;/li>
&lt;li>&lt;code>WDAC_V1_Recommended_Audit.bin&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>Enforced:&lt;/strong>
&lt;ul>
&lt;li>&lt;code>WDAC_V1_Default_Enforced.bin&lt;/code>&lt;/li>
&lt;li>&lt;code>WDAC_V1_Recommended_Enforced.bin&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Update the following line in the script to use the policy that you desire locally:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">$PolicyPath = &lt;span style="color:#e6db74">&amp;#34;C:\temp\Windows Defender\WDAC_V1_Recommended_Enforced.xml&amp;#34;&lt;/span>
&lt;span style="color:#66d9ef">ForEach&lt;/span> ($PolicyNumber &lt;span style="color:#66d9ef">in&lt;/span> (1..10)) {
Write-Host &lt;span style="color:#e6db74">&amp;#34;Importing WDAC Policy Option $PolicyNumber&amp;#34;&lt;/span>
Set-RuleOption -FilePath $PolicyPath -Option $PolicyNumber
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Alternatively, you may use &lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-using-group-policy">Group Policy&lt;/a> or &lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-using-intune">Microsoft Intune&lt;/a> to enforce the WDAC policies.&lt;/p>
&lt;h2 id="auditing">Auditing:&lt;/h2>
&lt;p>You can view the WDAC event logs in event viewer under:&lt;/p>
&lt;p>&lt;code>Applications and Services Logs\Microsoft\Windows\CodeIntegrity\Operational&lt;/code>&lt;/p>
&lt;h2 id="recommended-reading">Recommended Reading:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/audit-windows-defender-application-control-policies">Microsoft - Audit Windows Defender Application Control Policies&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-using-group-policy">Microsoft - Deploy Windows Defender Application Control policies by using Group Policy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-using-intune">Microsoft - Deploy Windows Defender Application Control policies by using Microsoft Intune&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/enforce-windows-defender-application-control-policies">Microsoft - Enforce Windows Defencer Application Control Policies&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;h3 id="manual-install">Manual Install:&lt;/h3>
&lt;p>If manually downloaded, the script must be launched from an administrative powershell in the directory containing all the files from the &lt;a href="https://github.com/simeononsecurity/Windows-Defender-Application-Control-Hardening/archive/main.zip">GitHub Repository&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ps" data-lang="ps">&lt;span style="color:#a6e22e">Set-ExecutionPolicy&lt;/span> &lt;span style="color:#a6e22e">-ExecutionPolicy&lt;/span> &lt;span style="color:#a6e22e">RemoteSigned&lt;/span> &lt;span style="color:#a6e22e">-Force&lt;/span>
&lt;span style="color:#a6e22e">Get-ChildItem&lt;/span> &lt;span style="color:#a6e22e">-Recurse&lt;/span> &lt;span style="color:#a6e22e">*.ps1&lt;/span> &lt;span style="color:#a6e22e">|&lt;/span> &lt;span style="color:#a6e22e">Unblock-File&lt;/span>
&lt;span style="color:#a6e22e">.\sos-wdachardening.ps1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Install RSAT ActiveDirectory PowerShell Module Offline</title><link>/github/offine-ps-activedirectory-install/</link><pubDate>Wed, 16 Dec 2020 00:00:00 +0000</pubDate><guid>/github/offine-ps-activedirectory-install/</guid><description>
&lt;h1 id="offine-ps-activedirectory-install">Offine-PS-ActiveDirectory-Install&lt;/h1>
&lt;p>Install the PowerShell RSAT ActiveDirectory Module Offline&lt;/p>
&lt;h3 id="how-to-install">How to install:&lt;/h3>
&lt;ol>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Offine-PS-ActiveDirectory-Install/archive/master.zip">Download the script&lt;/a>&lt;/li>
&lt;li>From the extracted folder, run &lt;code>.\sos-offlinepsadinstall.ps1&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">&lt;span style="color:#75715e">#Require elivation for script run&lt;/span>
&lt;span style="color:#75715e">#Requires -RunAsAdministrator&lt;/span>
&lt;span style="color:#75715e">#Copy Files&lt;/span>
&lt;span style="color:#75715e">#Install PowerShell Modules&lt;/span>
Copy-Item -Path .\Files\ActiveDirectory -Destination &lt;span style="color:#e6db74">&amp;#34;C:\Windows\System32\WindowsPowerShell\v1.0\Modules\&amp;#34;&lt;/span> -Force -Recurse
&lt;span style="color:#75715e">#Install Required DLLs&lt;/span>
Copy-Item -Path .\Files\WinSxS\* -Destination &lt;span style="color:#e6db74">&amp;#34;C:\Windows\WinSxS\&amp;#34;&lt;/span> -Force -Recurse
&lt;span style="color:#75715e">#Unblock New PowerShell Modules and DLLs&lt;/span>
Get-ChildItem &lt;span style="color:#e6db74">&amp;#34;C:\Windows\System32\WindowsPowerShell\v1.0\Modules\ActiveDirectory\&amp;#34;&lt;/span> -recurse | Unblock-File
Unblock-File -Path &lt;span style="color:#e6db74">&amp;#34;C:\Windows\WinSxS\Microsoft.ActiveDirectory.Management.resources.dll&amp;#34;&lt;/span>
Unblock-File -Path &lt;span style="color:#e6db74">&amp;#34;C:\Windows\WinSxS\Microsoft.ActiveDirectory.Management.dll&amp;#34;&lt;/span>
&lt;span style="color:#75715e">#Install PowerShell Modules and DLLs&lt;/span>
Import-Module -Name ActiveDirectory -Force -Global
Import-Module &lt;span style="color:#e6db74">&amp;#34;C:\Windows\WinSxS\Microsoft.ActiveDirectory.Management.resources.dll&amp;#34;&lt;/span> -Force -Global
Import-Module &lt;span style="color:#e6db74">&amp;#34;C:\Windows\WinSxS\Microsoft.ActiveDirectory.Management.dll&amp;#34;&lt;/span> -Force -Global
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>VirusTotal PowerShell Modules</title><link>/github/virustotal-ps/</link><pubDate>Tue, 24 Nov 2020 00:00:00 +0000</pubDate><guid>/github/virustotal-ps/</guid><description>
&lt;p>A collection of PowerShell Modules for Interacting with the VirusTotal API&lt;/p>
&lt;p>&lt;strong>Notes:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>You&amp;rsquo;ll need your VirusTotal API key, which can be found on your &lt;a href="https://www.virustotal.com/gui/">Shodan Account&lt;/a>&lt;/li>
&lt;li>Examples of the APIs used in the modules may be found on the &lt;a href="https://developers.virustotal.com/reference#getting-started">VirusTotal Developers Page&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="download-and-install">Download and Install&lt;/h2>
&lt;ul>
&lt;li>Download the modules from the &lt;a href="https://github.com/simeononsecurity/VirusTotal-PS">GitHub Repository&lt;/a>&lt;/li>
&lt;li>Install all the modules&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ps" data-lang="ps">&lt;span style="color:#a6e22e">Get-ChildItem&lt;/span> &lt;span style="color:#a6e22e">-Recurse&lt;/span> &lt;span style="color:#a6e22e">*.ps1&lt;/span> &lt;span style="color:#a6e22e">|&lt;/span> &lt;span style="color:#a6e22e">Import-Module&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Hardening Windows Systems with Applocker</title><link>/github/applocker-hardening/</link><pubDate>Thu, 19 Nov 2020 00:00:00 +0000</pubDate><guid>/github/applocker-hardening/</guid><description>
&lt;p>Ultimate Applocker Hardening Configuration Script.&lt;/p>
&lt;h2 id="what-does-this-script-do">What does this script do?&lt;/h2>
&lt;ul>
&lt;li>Locks down system resources to bare minumum needed for basic OS functionality&lt;/li>
&lt;/ul>
&lt;h2 id="recommended-reading">Recommended reading:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/api0cradle/UltimateAppLockerByPassList">api0cradle/UltimateAppLockerByPassList)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules">Microsoft Recommended Block Rules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/MotiBa/AppLocker">MotiBa/AppLocker&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/nsacyber/AppLocker-Guidance">NSA Cyber Bitlocker Gidance&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="download-the-required-files">Download the required files:&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/Applocker-Hardening">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-applockerhardening.ps1
&lt;/code>&lt;/pre></description></item><item><title>Hardening Windows Terminals. Command Prompt and PowerShell</title><link>/github/windows-terminal-hardening/</link><pubDate>Wed, 18 Nov 2020 00:00:00 +0000</pubDate><guid>/github/windows-terminal-hardening/</guid><description>
&lt;p>Scripts and Documentation for Hardening Windows Command Prompt and PowerShell&lt;/p>
&lt;h2 id="what-does-this-script-do">What does this script do?&lt;/h2>
&lt;ul>
&lt;li>Disables Command Prompt&lt;/li>
&lt;li>Disables PowerShell v2&lt;/li>
&lt;li>Disables WSMAN and PSRemoting&lt;/li>
&lt;li>Enables PowerShell Constrained Language Mode&lt;/li>
&lt;li>Enables PowerShell Logging&lt;/li>
&lt;/ul>
&lt;h2 id="recommended-reading">Recommended Reading:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.digitalshadows.com/blog-and-research/powershell-security-best-practices/">PowerShell Best Practices&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/">PowerShell Constrained Language Mode&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cyber.gov.au/acsc/view-all-content/publications/securing-powershell-enterprise">Securing PowerShell in the Enterprise&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Windows-Defender-Hardening">Windows Defender Hardening&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="download-the-required-files">Download the required files:&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/Windows-Terminal-Hardening">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-windowsterminalhardening.ps1
&lt;/code>&lt;/pre></description></item><item><title>Shodan Powershell Modules</title><link>/github/shodan-powershell/</link><pubDate>Sat, 14 Nov 2020 19:34:03 -0600</pubDate><guid>/github/shodan-powershell/</guid><description>
&lt;h1 id="shodan_ps">Shodan_PS&lt;/h1>
&lt;p>A collection of PowerShell Modules for Interacting with the Shodan API&lt;/p>
&lt;p>&lt;strong>Notes:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>You&amp;rsquo;ll need you Shodan API key, which can be found on your &lt;a href="https://account.shodan.io/">Shodan Account&lt;/a>&lt;/li>
&lt;li>Examples of the APIs used in the modules may be found on the &lt;a href="https://developer.shodan.io/api">Shodan Developers Page&lt;/a>&lt;/li>
&lt;li>Certain Modules may use scan or query credits Query Credits are used when you download data via the website, CLI or API (what these scripts do).
Since we are using the API it is important to note that query credits are deducted if:
&lt;ol>
&lt;li>A search filter is used&lt;/li>
&lt;li>Page 2 or beyond is requested
The credits renew at the start of the month and 1 credit lets you download 100 results.
As for scan credits, 1 scan credit lets you scan 1 IP, and they also renew at the start of the month.
Please view the Shodan Help Center &lt;a href="https://help.shodan.io/the-basics/credit-types-explained">HERE&lt;/a> for full details.&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h2 id="table-of-contents">Table of Contents&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS#download">Download Instructions&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS#install">Installation Instructions&lt;/a>&lt;/li>
&lt;li>&lt;strong>Modules&lt;/strong>
&lt;ul>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanAPIInfo">Get-ShodanAPIInfo&lt;/a> - Return information about the API plan belonging to the given API key.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanClientHTTPHeaders">Get-ShodanClientHTTPHeaders&lt;/a> - Shows the HTTP headers that your client sends when connecting to a webserver.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanClientIP">Get-ShodanClientIP&lt;/a> - Gets your current IP address as seen from the Internet.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanDNSDomain">Get-ShodanDNSDomain&lt;/a> - Gets all the subdomains and other DNS entries for the given domain&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanDNSResolve">Get-ShodanDNSResolve&lt;/a> - Looks up the IP addresses for the provided hostname(s).&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanDNSReverse">Get-ShodanDNSReverse&lt;/a> - Looks up the hostnames that have been defined for the given list of IP addresses.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanExploitCount">Get-ShodanExploitCount&lt;/a> - Searches for exploits but only returns information about the total number of matches related to the search term, and optionally the exploit author, platform, port, source, or type.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanHoneyScore">Get-ShodanHoneyScore&lt;/a> - Calculates a honeypot probability score ranging from 0 (not a honeypot) to 1.0 (is a honeypot).&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanHostCount">Get-ShodanHostCount&lt;/a> - Returns the total number of results of &amp;ldquo;/shodan/host/search&amp;rdquo; provides.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanHostIP">Get-ShodanHostIP&lt;/a> - Search Shodan with IP address.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanHostSearch">Get-ShodanHostSearch&lt;/a> - Search Shodan using the same query syntax as the website and use facets to get summary information for different properties.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanHostSearchFacets">Get-ShodanHostSearchFacets&lt;/a> - This module returns a list of search filters that can be used in the search query.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanHostSearchFilters">Get-ShodanHostSearchFilters&lt;/a> - This module returns a list of search filters that can be used in the search query.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanPorts">Get-ShodanPorts&lt;/a> - List all ports that Shodan is crawling on the Internet.&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanProfile">Get-ShodanProfile&lt;/a> - Returns information about the Shodan account linked to this API key&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanScanID">Get-ShodanScanID&lt;/a> - Check the progress of a previously submitted scan request&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Get-ShodanScanProtocols">Get-ShodanScanProtocols&lt;/a> - List all protocols that can be used when performing on-demand Internet scans via Shodan&lt;/li>
&lt;li>&lt;a href="https://github.com/simeononsecurity/Shodan_PS/tree/main/Set-ShodanScanIP">Set-ShodanScanIP&lt;/a> - Use this module to request Shodan to crawl a network.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="download">Download&lt;/h2>
&lt;p>You will need to clone or download the scripts to your computer.&lt;/p>
&lt;p>You can use the Code dropdown menu on this repo page by scrolling up, or just copy and paste the following link: &lt;a href="https://github.com/simeononsecurity/Shodan_PS.git">https://github.com/simeononsecurity/Shodan_PS.git&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://github.com/simeononsecurity/Shodan_PS/blob/main/demo/download.gif?raw=true" alt="On the project page click the code button which opens the dropdown menu containing clone, Open with Github Desktop, Download Zip. Select the copy icon next to the clone url">&lt;/p>
&lt;p>For this example we will be cloning the repo within Git Bash, after clicking on the clipboard icon as seen above, we can type git clone and right click the Git Bash window to select paste from the dropdown menu:&lt;/p>
&lt;pre>&lt;code>exampleuser@exampleComputer MINGW64 ~/Documents/Github git clone https://github.com/simeononsecurity/Shodan_PS.git
&lt;/code>&lt;/pre>&lt;p>For detailed instructions on cloning please view &lt;a href="https://docs.github.com/en/free-pro-team@latest/github/creating-cloning-and-archiving-repositories/cloning-a-repository">the github documentation.&lt;/a>&lt;/p>
&lt;p>Once you have the files, you need to copy the files to C:\Program Files\WindowsPowerShell\Modules, doing this will prompt dialog saying that access is denied, click continue to finish copying the files to this location and then proceed to the installation instructions &lt;a href="#Install">here&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://github.com/simeononsecurity/Shodan_PS/blob/main/demo/copyasadmin.png?raw=true" alt="Open file explorer path C:\Program Files\WindowsPowerShell\Modules , copy dialog says access is denied, click on continue to copy the files">&lt;/p>
&lt;p>&lt;strong>OR&lt;/strong>&lt;/p>
&lt;p>You can use the Code dropdown menu on this repo page by scrolling up, or just click on the following link:
&lt;a href="https://github.com/simeononsecurity/Shodan_PS/archive/main.zip">https://github.com/simeononsecurity/Shodan_PS/archive/main.zip&lt;/a>
&lt;img src="https://github.com/simeononsecurity/Shodan_PS/blob/main/demo/downloadzip.gif?raw=true" alt="On the project page click the code button which opens the dropdown menu containing clone, Open with Github Desktop, Download Zip. Select Download Zip option">&lt;/p>
&lt;p>Unzip main.zip by right clicking on the file and selecting extract here from the dropdown menu.&lt;/p>
&lt;p>Once you have the files, you need to copy the files to C:\Program Files\WindowsPowerShell\Modules, doing this will prompt dialog saying that access is denied, click continue to finish copying the files to this location and then proceed to the installation instructions &lt;a href="#Install">here&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://github.com/simeononsecurity/Shodan_PS/blob/main/demo/copyasadmin.png?raw=true" alt="Open file explorer path C:\Program Files\WindowsPowerShell\Modules , copy dialog says access is denied, click on continue to copy the files">&lt;/p>
&lt;h1 id="install">Install&lt;/h1>
&lt;p>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>To install the modules You will need to run a PowerShell window as administrator.
There are two ways of doing this:&lt;/p>
&lt;p>The first way is by right clicking the PowerShell icon on the Desktop and selecting Run as Administrator from the dropdown menu.&lt;/p>
&lt;p>&lt;img src="https://github.com/simeononsecurity/Shodan_PS/blob/main/demo/RcRunAsAdmin.gif?raw=true" alt="Right click the powershell icon on the Desktop and select run as administrator from dropdown menu">&lt;/p>
&lt;p>&lt;strong>OR&lt;/strong>&lt;/p>
&lt;p>By typing p (or however many characters it takes PowerShell to show up) into the search bar and clicking on Run as Administrator.&lt;/p>
&lt;p>&lt;img src="https://github.com/simeononsecurity/Shodan_PS/blob/main/demo/SearchBarRunAsAdmin.gif?raw=true" alt="type p in the search bar and when powershell comes up click on run as administrator">&lt;/p>
&lt;p>You will need to be in the directory that you copied the scripts to.
Run the following command to change your working directory:&lt;/p>
&lt;pre>&lt;code>PS C:\WINDOWS\system32&amp;gt; cd 'C:\Program Files\WindowsPowerShell\Modules\Shodan_PS'
PS C:\Program Files\WindowsPowerShell\Modules\Shodan_PS&amp;gt;
&lt;/code>&lt;/pre>&lt;p>On Windows client computers we need to change the PowerShell execution policy which is Restricted by default.&lt;/p>
&lt;p>For more information please read this &lt;a href="https:/go.microsoft.com/fwlink/?LinkID=135170">Microsoft documentation.&lt;/a>&lt;/p>
&lt;p>Run the following command to set the policy to RemoteSigned and enter y to select that Yes you want to change the policy.&lt;/p>
&lt;pre>&lt;code>PS C:\Program Files\WindowsPowerShell\Modules\Shodan_PS&amp;gt; Set-ExecutionPolicy RemoteSigned
Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose you to the
security risks described in the about_Execution_Policies help topic at https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to
change the execution policy?
[Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is &amp;quot;N&amp;quot;): y
&lt;/code>&lt;/pre>&lt;p>Once the execution policy has been changed, you can run the following command to Import the modules.&lt;/p>
&lt;pre>&lt;code>PS C:\Program Files\WindowsPowerShell\Modules\Shodan_PS&amp;gt; Set-ChildItem -Recurse *.psm1 | Import-Module
&lt;/code>&lt;/pre>&lt;p>Now you can run any of the scripts as a module via powershell.&lt;/p></description></item><item><title>Automating the Windows Defender STIG</title><link>/github/windows-defender-stig-script/</link><pubDate>Sun, 15 Nov 2020 00:00:00 +0000</pubDate><guid>/github/windows-defender-stig-script/</guid><description>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_Defender_Antivirus_V1R9_STIG.zip">Windows Defender Antivirus V1R9&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="download-the-required-files">Download the required files:&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/Windows-Defender-STIG-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-windowsdefenderstig.ps1
&lt;/code>&lt;/pre></description></item><item><title>Hardening Windows Defender</title><link>/github/windows-defender-hardening/</link><pubDate>Sun, 15 Nov 2020 00:00:00 +0000</pubDate><guid>/github/windows-defender-hardening/</guid><description>
&lt;h2 id="what-does-this-script-do">What does this script do?&lt;/h2>
&lt;ul>
&lt;li>Enables Cloud-delivered Protections&lt;/li>
&lt;li>Enables Controlled Folder Access&lt;/li>
&lt;li>Enables Network Protections&lt;/li>
&lt;li>Enables Intrusion Prevention System&lt;/li>
&lt;li>Enables Windows Defender Application Control Policies&lt;/li>
&lt;li>Enables Windows Defender Attack Surface Reduction Rules&lt;/li>
&lt;li>Enables Windows Defender Exploit Protections&lt;/li>
&lt;li>Implements all requirements listed in the &lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_Defender_Antivirus_V1R9_STIG.zip">Windows Defender Antivirus STIG&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="download-the-required-files">Download the required files:&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/Windows-Defender-STIG-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-windowsdefenderhardening.ps1
&lt;/code>&lt;/pre></description></item><item><title>STIG Compliant GPOs and Importing them into a Windows Domain</title><link>/github/stig-compliant-domain-prep/</link><pubDate>Tue, 08 Sep 2020 15:13:17 -0500</pubDate><guid>/github/stig-compliant-domain-prep/</guid><description>
&lt;h1 id="stig-compliant-domain-prep">STIG Compliant Domain Prep&lt;/h1>
&lt;p>Import all the GPOs provided by SimeonOnSecurity to assist in making your domain compliant with all applicable STIGs and SRGs.&lt;/p>
&lt;h2 id="notes">Notes:&lt;/h2>
&lt;p>&lt;strong>This script is designed for use in Enterprise environments&lt;/strong>&lt;/p>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_10_V1R23_STIG.zip">Windows 10 V1R23&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_Defender_Antivirus_V1R9_STIG.zip">Windows Defender Antivirus V1R9&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Windows_Firewall_V1R7_STIG.zip">Windows Firewall V1R7&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_IE11_V1R19_STIG.zip">Internet Explorer 11 V1R19&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Adobe_Acrobat_Pro_DC_Classic_V1R3_STIG.zip">Adobe Reader Pro DC Continous V1R2&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Adobe_Acrobat_Pro_DC_Continuous_V1R2_STIG.zip">Adobe Reader Pro DC Classic V1R3&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Office_365_ProPlus_V1R2_STIG.zip">Microsoft Office 2019/Office 365 Pro Plus V1R2&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/pdf/U_Microsoft_Office_2016_V1R2_Overview.pdf">Microsoft Office 2016 V1R2&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MicrosoftOffice2013_V1R5_Overview.zip">Microsoft Office 2013 V1R5&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Chrome_V1R19_STIG.zip">Google Chrome V1R19&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_FireFox_V4R29_STIG.zip">Firefox V4R29&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_DotNet_Framework_4-0_V1R9_STIG.zip">Microsoft .Net Framework 4 V1R9&lt;/a> - &lt;strong>Work in Progress&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_8_Windows_V1R5_STIG.zip">Oracle JRE 8 V1R5&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="additional-configurations-were-considered-from">Additional configurations were considered from:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance">NSACyber - Hardware-and-Firmware-Security-Guidance&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://apps.nsa.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm">NSACyber - Application Whitelisting Using Microsoft AppLocker&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.whonix.org/wiki/Disable_TCP_and_ICMP_Timestamps">Whonix - Disable TCP Timestamps&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://kb.cert.org/vuls/id/573168/">CERT - IE Scripting Engine Memory Corruption&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dirteam.com/sander/2019/07/30/howto-disable-weak-protocols-cipher-suites-and-hashing-algorithms-on-web-application-proxies-ad-fs-servers-and-windows-servers-running-azure-ad-connect/">Dirteam - SSL Hardening&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://support.microsoft.com/en-us/help/4072698/windows-server-speculative-execution-side-channel-vulnerabilities">Microsoft - Specture and Meltdown Mitigations&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://docs.microsoft.com/en-us/windows/privacy/">Microsoft - Windows 10 Privacy&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://docs.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft-services">Microsoft - Managing Windows 10 Telemetry and Callbacks&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds_vdi-recommendations-1909">Microsoft - Windows 10 VDI Recomendations&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;p>&lt;strong>The script may be launched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-stig-compliant-domain-prep.ps1
&lt;/code>&lt;/pre>&lt;p>The script we will be using must be launched from the directory containing all the other files from the &lt;a href="https://github.com/simeononsecurity/STIG-Compliant-Domain-Prep">GitHub Repository&lt;/a>&lt;/p></description></item><item><title>Adobe Reader DC STIG Script</title><link>/github/adobe-reader-dc-stig-script/</link><pubDate>Thu, 27 Aug 2020 16:50:08 -0500</pubDate><guid>/github/adobe-reader-dc-stig-script/</guid><description>
&lt;h1 id="automate-adobe-reader-pro-dc-stig">Automate Adobe Reader Pro DC STIG&lt;/h1>
&lt;p>Apply the Adobe Reader Pro DC STIGs in one simple script.&lt;/p>
&lt;h2 id="notes">Notes:&lt;/h2>
&lt;p>&lt;strong>This script is designed for use in Enterprise environments and will insure 100% compliance with the applicable stigs.&lt;/strong>&lt;/p>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Adobe_Acrobat_Pro_DC_Classic_V1R3_STIG.zip">Adobe Reader Pro DC Continous V1R2&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Adobe_Acrobat_Pro_DC_Continuous_V1R2_STIG.zip">Adobe Reader Pro DC Classic V1R3&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="download-the-script">Download the script:&lt;/h2>
&lt;p>You may download the script from the &lt;a href="https://github.com/simeononsecurity/Adobe-Reader-DC-STIG-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;p>&lt;strong>The script may be launched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-adobe-stig.ps1
&lt;/code>&lt;/pre></description></item><item><title>STIGing Standalone Windows Systems</title><link>/github/stiging-standalone-windows-systems/</link><pubDate>Wed, 26 Aug 2020 11:59:03 -0500</pubDate><guid>/github/stiging-standalone-windows-systems/</guid><description>
&lt;h1 id="stiging-standalone-windows-10-systems">STIGing Standalone Windows 10 Systems&lt;/h1>
&lt;p>&lt;strong>Download all the required files from the &lt;a href="https://github.com/simeononsecurity/Standalone-Windows-STIG-Script">GitHub Repository&lt;/a>&lt;/strong>&lt;/p>
&lt;p>&lt;strong>We are seeking help with the following &lt;a href="https://github.com/simeononsecurity/W10-Optimize-and-Harden/issues/3">.Net issue&lt;/a>&lt;/strong>&lt;/p>
&lt;h2 id="introduction">Introduction:&lt;/h2>
&lt;p>Windows 10 is insecure operating system out of the box and requires many changes to insure &lt;a href="https://www.cisa.gov/federal-information-security-modernization-act">FISMA&lt;/a> compliance.
Organizations like &lt;a href="https://microsoft.com">Microsoft&lt;/a>, &lt;a href="https://public.cyber.mil">Cyber.mil&lt;/a>, the &lt;a href="https://dod.gov">Department of Defense&lt;/a>, and the &lt;a href="https://www.nsa.gov/">National Security Agency&lt;/a> have recommended and required configuration changes to lockdown, harden, and secure the operating system and ensure government compliance. These changes cover a wide range of mitigations including blocking telemetry, macros, removing bloatware, and preventing many physical attacks on a system.&lt;/p>
&lt;p>Standalone systems are some of the most difficult and annoying systems to secure. When not automated, they require manual changes of each STIG/SRG. Totalling over 1000 configuration changes on a typical deployment and an average of 5 minutes per change equaling 3.5 days worth of work. This script aims to speed up that process significantly.&lt;/p>
&lt;h2 id="notes">Notes:&lt;/h2>
&lt;ul>
&lt;li>This script is designed for operation in &lt;strong>Enterprise&lt;/strong> environments and assumes you have hardware support for all the requirements.
&lt;ul>
&lt;li>For personal systems please see this &lt;a href="https://github.com/simeononsecurity/W10-Optimize-and-Harden">GitHub Repository&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>This script is not designed to bring a system to 100% compliance, rather it should be used as a stepping stone to complete most, if not all, the configuration changes that can be scripted.
&lt;ul>
&lt;li>Minus system documentation, this collection should bring you up to about 95% compliance on all the STIGS/SRGs applied.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="requirements">Requirements:&lt;/h2>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Windows 10 Enterprise is &lt;strong>Required&lt;/strong> per STIG.&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-highly-secure">Standards&lt;/a> for a highly secure Windows 10 device&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> System is &lt;a href="https://support.microsoft.com/en-gb/help/4027667/windows-10-update">fully up to date&lt;/a>
&lt;ul>
&lt;li>Currently Windows 10 &lt;strong>v1909&lt;/strong> or &lt;strong>v2004&lt;/strong>.&lt;/li>
&lt;li>Run the &lt;a href="https://support.microsoft.com/en-us/help/3159635/windows-10-update-assistant">Windows 10 Upgrade Assistant&lt;/a> to be update and verify latest major release.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Hardware Requirements
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/requirements-and-deployment-planning-guidelines-for-virtualization-based-protection-of-code-integrity#baseline-protections">Hardware Requirements for Memory Integrity&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/reqs-wd-app-guard">Hardware Requirements for Windows Defender Application Guard&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements">Hardware Requirements for Windows Defender Credential Guard&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="recommended-reading-material">Recommended reading material:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-secure-launch-and-smm-protection#requirements-met-by-system-guard-enabled-machines">System Guard Secure Launch&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-how-hardware-based-root-of-trust-helps-protect-windows">System Guard Root of Trust&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/overview-hardware-based-isolation">Hardware-based Isolation&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/memory-integrity">Memory integrity&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/wd-app-guard-overview">Windows Defender Application Guard&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-how-it-works">Windows Defender Credential Guard&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="a-list-of-scripts-and-tools-this-collection-utilizes">A list of scripts and tools this collection utilizes:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=55319">Microsoft Security Compliance Toolkit 1.0&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://public.cyber.mil/stigs/gpo/">Cyber.mil - Group Policy Objects&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://github.com/nsacyber/BitLocker-Guidance">NSACyber - Bitlocker Guidance&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="additional-configurations-were-considered-from">Additional configurations were considered from:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance">NSACyber - Hardware-and-Firmware-Security-Guidance&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://apps.nsa.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm">NSACyber - Application Whitelisting Using Microsoft AppLocker&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_10_V1R23_STIG.zip">Windows 10 V1R23&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_Defender_Antivirus_V1R9_STIG.zip">Windows Defender Antivirus V1R9&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Windows_Firewall_V1R7_STIG.zip">Windows Firewall V1R7&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_IE11_V1R19_STIG.zip">Internet Explorer 11 V1R19&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Adobe_Acrobat_Pro_DC_Continuous_V1R2_STIG.zip">Adobe Reader Pro DC Continous V1R2&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Office_365_ProPlus_V1R2_STIG.zip">Microsoft Office 2019/Office 365 Pro Plus V1R2&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/pdf/U_Microsoft_Office_2016_V1R2_Overview.pdf">Microsoft Office 2016 V1R2&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MicrosoftOffice2013_V1R5_Overview.zip">Microsoft Office 2013 V1R5&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Chrome_V1R19_STIG.zip">Google Chrome V1R19&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_FireFox_V4R29_STIG.zip">Firefox V4R29&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_DotNet_Framework_4-0_V1R9_STIG.zip">Microsoft .Net Framework 4 V1R9&lt;/a> - &lt;strong>Work in Progress&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_8_Windows_V1R5_STIG.zip">Oracle JRE 8 V1R5&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\secure-standalone.ps1
&lt;/code>&lt;/pre>&lt;p>The script we will be using must be launched from the directory containing all the other files from the &lt;a href="https://github.com/simeononsecurity/Standalone-Windows-STIG-Script">GitHub Repository&lt;/a>&lt;/p></description></item><item><title>Dot NET STIG Script</title><link>/github/dot-net-stig-script/</link><pubDate>Thu, 20 Aug 2020 22:14:22 -0500</pubDate><guid>/github/dot-net-stig-script/</guid><description>
&lt;h1 id="automate-the-net-framework-4-stig">Automate the .NET Framework 4 STIG&lt;/h1>
&lt;p>Applying the .NET STIG is definitely not straightforward. For many administrators it can take hours to fully implement on a single system. This script applies the required registry changes and modifies the machine.config file to implement FIPS and other controls as required.&lt;/p>
&lt;p>&lt;strong>Work in Progress&lt;/strong>&lt;/p>
&lt;p>&lt;strong>DO NOT APPLY IN PRODUCTION&lt;/strong>&lt;/p>
&lt;h2 id="notes">Notes:&lt;/h2>
&lt;p>This script can not and will not ever get the .NET stig to 100% compliance.
Manual intervention is required for any .NET application or IIS Site.&lt;/p>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_DotNet_Framework_4-0_V1R9_STIG.zip">Microsoft .Net Framework 4 V1R9&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="sources">Sources:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/dotnet/framework/">Microsoft .NET Framework Documentation&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="download-the-required-files">Download the required files:&lt;/h2>
&lt;p>You may download the required files from the &lt;a href="https://raw.githubusercontent.com/simeononsecurity/.NET-STIG-Script/">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-scripta">How to run the scripta;&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-.net-4-stig.ps1
&lt;/code>&lt;/pre></description></item><item><title>FireFox Privacy Script</title><link>/github/firefox-privacy-script/</link><pubDate>Mon, 17 Aug 2020 03:32:03 -0500</pubDate><guid>/github/firefox-privacy-script/</guid><description>
&lt;h1 id="firefox-privacy-script">FireFox Privacy Script&lt;/h1>
&lt;p>Organizations like &lt;a href="https://www.privacytools.io/browsers/#about_config">PrivacyTools.io&lt;/a> and &lt;a href="https://ffprofile.com/">ffprofile&lt;/a> have suggested changes to make FireFox more secure and private.
These changes cover suggested browser extentions, blocking telemetry, disabling 3rd-party cookies, disabling trackers, etc.&lt;/p>
&lt;p>This script will take the pregenerated FireFox configuration files and install them in the proper directories on a Windows system.&lt;/p>
&lt;h2 id="download-the-required-files">Download the required files&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/FireFox-Privacy-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-firefoxprivacy.ps1
&lt;/code>&lt;/pre></description></item><item><title>FireFox STIG Script</title><link>/github/firefox-stig-script/</link><pubDate>Sat, 15 Aug 2020 19:17:57 -0500</pubDate><guid>/github/firefox-stig-script/</guid><description>
&lt;h1 id="firefox-stig-script">FireFox STIG Script&lt;/h1>
&lt;p>The &lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_FireFox_V4R29_STIG.zip">Firefox V4R29&lt;/a> isn&amp;rsquo;t the easiest of STIGs to apply.
This script will implement most of the required FireFox policies. In the future, the FireFox ADMX templates and GPO&amp;rsquo;s will be applied in this script.&lt;/p>
&lt;p>&lt;strong>Work In Progress&lt;/strong>&lt;/p>
&lt;h2 id="download-the-required-files">Download the required files&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/FireFox-STIG-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-firefoxstig.ps1
&lt;/code>&lt;/pre></description></item><item><title>Windows 10 Branding</title><link>/github/windows-10-branding/</link><pubDate>Fri, 14 Aug 2020 14:37:16 -0500</pubDate><guid>/github/windows-10-branding/</guid><description>
&lt;h1 id="setup-branding-on-windows-10-and-server-20162019-systems">Setup branding on Windows 10 and Server 2016/2019 Systems&lt;/h1>
&lt;p>Many organizations have a need or want to control the branding of a Windows system.
This includes the desktop wallpaper, the users avatar, the Windows lock screen, and sometimes the OEM Logo.
In Windows 10, Windows Server 2016, and Windows Server 2019 this is not particularly easy.
But, with the aide of the linked script, we can partially automate it and make the process much easier.&lt;/p>
&lt;h2 id="download-the-required-files">Download the required files&lt;/h2>
&lt;p>&lt;strong>Download the required files from the &lt;a href="https://github.com/simeononsecurity/Windows-Branding-Script">GitHub Repository&lt;/a>&lt;/strong>&lt;/p>
&lt;h2 id="how-to-set-up-the-branding-files">How to set up the branding files&lt;/h2>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Replace all images with your branding images
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> OEM logo must be either 95x95 or 120x20 and in &amp;ldquo;.bmp&amp;rdquo; format&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Generate the User Image along with 32x32, 40x40, 48x48, 192x192 variants.&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Generate or copy user image for guest image.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;pre>&lt;code>.\sos-copybranding.ps1
&lt;/code>&lt;/pre>&lt;h2 id="this-script-utilizes-the-following-tool">This script utilizes the following tool:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=55319">Microsoft Security Compliance Toolkit 1.0 - LGPO&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Automating Oracle JRE 8 STIG</title><link>/github/oracle-jre-8-stig/</link><pubDate>Wed, 05 Aug 2020 21:54:53 -0500</pubDate><guid>/github/oracle-jre-8-stig/</guid><description>
&lt;h1 id="automate-oracle-jre-8-stigs">Automate Oracle JRE 8 STIGS&lt;/h1>
&lt;p>The Oracle JRE STIGs arent so straight forward, requiring administrators to research JAVA documentation and generate java config files, when most administrators are used to solely STIG-ing using group policy.&lt;/p>
&lt;h2 id="download-the-required-files">Download the required files&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/JAVA-STIG-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_8_Windows_V1R5_STIG.zip">Oracle JRE 8 V1R5&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="sources">Sources:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://gist.github.com/MyITGuy/9628895">MyITGuy - deployment.properties&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="http://stu.cbu.edu/java/docs/technotes/guides/deploy/properties.html">cbu.edu - Java Technotes&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-install-java-config.ps1
&lt;/code>&lt;/pre></description></item><item><title>CVE-2020-1350 KB4569509 DNS Server Vulnerability</title><link>/github/cve-2020-1350_kb4569509_dns_server_vulnerability/</link><pubDate>Sat, 25 Jul 2020 21:09:37 -0500</pubDate><guid>/github/cve-2020-1350_kb4569509_dns_server_vulnerability/</guid><description>
&lt;h1 id="kb4569509-guidance-for-dns-server-vulnerability-cve-2020-1350httpssupportmicrosoftcomen-ushelp4569509windows-dns-server-remote-code-execution-vulnerability">&lt;a href="https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability">KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350&lt;/a>&lt;/h1>
&lt;h2 id="introduction">Introduction&lt;/h2>
&lt;p>On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience.&lt;/p>
&lt;p>A registry-based workaround can be used to help protect an affected Windows server, and it can be implemented without requiring an administrator to restart the server. Because of the volatility of this vulnerability, administrators may have to implement the workaround before they apply the security update in order to enable them to update their systems by using a standard deployment cadence.&lt;/p>
&lt;h2 id="workaround">Workaround&lt;/h2>
&lt;p>&lt;strong>Optional:&lt;/strong> Download the workaround script from the &lt;a href="https://github.com/simeononsecurity/CVE-2020-1350-Fix">GitHub Repository&lt;/a>&lt;/p>
&lt;p>To work around this vulnerability, make the following registry change to restrict the size of the largest inbound TCP-based DNS response packet that&amp;rsquo;s allowed:&lt;/p>
&lt;p>Subkey: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters&lt;/p>
&lt;p>Value: TcpReceivePacketSize&lt;/p>
&lt;p>Type: DWORD&lt;/p>
&lt;p>Value data: 0xFF00&lt;/p>
&lt;p>&lt;strong>Notes:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>The default (also maximum) Value data = 0xFFFF.
The recommended Value data = 0xFF00 (255 bytes less than the maximum).
You must restart the DNS Service for the registry change to take effect. To do this, run the following command at an elevated command prompt:
&lt;/code>&lt;/pre>
&lt;p>&lt;code>net stop dns &amp;amp;&amp;amp; net start dns&lt;/code>&lt;/p>
&lt;h2 id="important-information-about-this-workaround">Important information about this workaround&lt;/h2>
&lt;p>TCP-based DNS response packets that exceed the recommended value will be dropped without error. Therefore, it is possible that some queries might not be answered. This could cause an unanticipated failure. A DNS server will be negatively impacted by this workaround only if it receives valid TCP responses that are greater than allowed in the previous mitigation (more than 65,280 bytes).&lt;/p>
&lt;p>The reduced value is unlikely to affect standard deployments or recursive queries. However, a non-standard use-case may exist in a given environment. To determine whether the server implementation will be adversely affected by this workaround, you should enable diagnostic logging, and capture a sample set that is representative of your typical business flow. Then, you will have to review the log files to identify the presence of anomalously large TCP response packets&lt;/p>
&lt;p>For more information, see &lt;a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn800669%28v=ws.11%29">DNS Logging and Diagnostics&lt;/a>.&lt;/p></description></item><item><title>Optimize, Harden, and Debloat Windows 10 Deployments</title><link>/github/optimizing-and-hardening-windows10-deployments/</link><pubDate>Wed, 22 Jul 2020 20:15:14 -0500</pubDate><guid>/github/optimizing-and-hardening-windows10-deployments/</guid><description>
&lt;h1 id="optimize-harden-and-debloat-windows-10-deployments">Optimize, Harden, and Debloat Windows 10 Deployments&lt;/h1>
&lt;p>&lt;strong>Download all the required files from the &lt;a href="https://github.com/smiltech/Windows-Optimize-Harden-Debloat">GitHub Repository&lt;/a>&lt;/strong>&lt;/p>
&lt;p>&lt;strong>We are seeking help with the following &lt;a href="https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat/issues/3">.Net issue&lt;/a>&lt;/strong>&lt;/p>
&lt;h2 id="introduction">Introduction:&lt;/h2>
&lt;p>Windows 10 is an invasive and insecure operating system out of the box.
Organizations like &lt;a href="https://PrivacyTools.io">PrivacyTools.io&lt;/a>, &lt;a href="https://microsoft.com">Microsoft&lt;/a>, &lt;a href="https://public.cyber.mil">Cyber.mil&lt;/a>, the &lt;a href="https://dod.gov">Department of Defense&lt;/a>, and the &lt;a href="https://www.nsa.gov/">National Security Agency&lt;/a> have recommended configuration changes to lockdown, harden, and secure the operating system. These changes cover a wide range of mitigations including blocking telemetry, macros, removing bloatware, and preventing many digital and physical attacks on a system. This script aims to automate the configurations recommended by those organizations.&lt;/p>
&lt;h2 id="notes">Notes:&lt;/h2>
&lt;ul>
&lt;li>This script is designed for operation in primarily &lt;strong>Personal Use&lt;/strong> environments. With that in mind, certain enterprise configuration settings are not implemented. This script is not designed to bring a system to 100% compliance. Rather it should be used as a stepping stone to complete most, if not all, the configuration changes that can be scripted while skipping past issues like branding and banners where those should not be implemented even in a hardened personal use environment.&lt;/li>
&lt;li>This script is designed in such a way that the optimizations, unlike some other scripts, will not break core windows functionality.&lt;/li>
&lt;li>Features like Windows Update, Windows Defender, the Windows Store, and Cortona have been restricted, but are not in a disfunctional state like most other Windows 10 Privacy scripts.&lt;/li>
&lt;li>If you seek a minimized script targeted only to commercial environments, please see this &lt;a href="https://github.com/simeononsecurity/Standalone-Windows-STIG-Script">GitHub Repository&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="requirements">Requirements:&lt;/h2>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Windows 10 Enterprise (&lt;strong>Preferred&lt;/strong>) or Windows 10 Professional
&lt;ul>
&lt;li>Windows 10 Home does not allow for GPO configurations.&lt;/li>
&lt;li>Windows 10 &amp;ldquo;N&amp;rdquo; Editions are not tested.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-highly-secure">Standards&lt;/a> for a highly secure Windows 10 device&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> System is &lt;a href="https://support.microsoft.com/en-gb/help/4027667/windows-10-update">fully up to date&lt;/a>
&lt;ul>
&lt;li>Currently Windows 10 &lt;strong>v1909&lt;/strong>, &lt;strong>v2004&lt;/strong>, or &lt;strong>20H2&lt;/strong>.&lt;/li>
&lt;li>Run the &lt;a href="https://support.microsoft.com/en-us/help/3159635/windows-10-update-assistant">Windows 10 Upgrade Assistant&lt;/a> to update and verify latest major release.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Bitlocker must be suspended or turned off prior to implementing this script, it can be enabled again after rebooting.
&lt;ul>
&lt;li>Follow-up runs of this script can be run without disabling bitlocker.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Hardware Requirements
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/requirements-and-deployment-planning-guidelines-for-virtualization-based-protection-of-code-integrity#baseline-protections">Hardware Requirements for Memory Integrity&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-vbs">Hardware Requirements for Virtualization-Based Security&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/reqs-wd-app-guard">Hardware Requirements for Windows Defender Application Guard&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements">Hardware Requirements for Windows Defender Credential Guard&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="recommended-reading-material">Recommended reading material:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-secure-launch-and-smm-protection#requirements-met-by-system-guard-enabled-machines">System Guard Secure Launch&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-how-hardware-based-root-of-trust-helps-protect-windows">System Guard Root of Trust&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/overview-hardware-based-isolation">Hardware-based Isolation&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/memory-integrity">Memory integrity&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/wd-app-guard-overview">Windows Defender Application Guard&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-how-it-works">Windows Defender Credential Guard&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="a-list-of-scripts-and-tools-this-collection-utilizes">A list of scripts and tools this collection utilizes:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://public.cyber.mil/stigs/gpo/">Cyber.mil - Group Policy Objects&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=55319">Microsoft Security Compliance Toolkit 1.0&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="additional-configurations-were-considered-from">Additional configurations were considered from:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/builtbybel/privatezilla">BuiltByBel - PrivateZilla&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kb.cert.org/vuls/id/573168/">CERT - IE Scripting Engine Memory Corruption&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dirteam.com/sander/2019/07/30/howto-disable-weak-protocols-cipher-suites-and-hashing-algorithms-on-web-application-proxies-ad-fs-servers-and-windows-servers-running-azure-ad-connect/">Dirteam - SSL Hardening&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft-services">Microsoft - Managing Windows 10 Telemetry and Callbacks&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction">Microsoft - Reduce attack surfaces with attack surface reduction rules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules">Microsoft - Recommended block rules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules">Microsoft - Recommended driver block rules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://support.microsoft.com/en-us/help/4072698/windows-server-speculative-execution-side-channel-vulnerabilities">Microsoft - Specture and Meltdown Mitigations&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/privacy/">Microsoft - Windows 10 Privacy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds_vdi-recommendations-1909">Microsoft - Windows 10 VDI Recomendations&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control-design-guide">Microsoft - Windows Defender Application Control&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/builtbybel/sharpapp">Mirinsoft - SharpApp&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/builtbybel/debotnet">Mirinsoft - debotnet&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://apps.nsa.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm">NSACyber - Application Whitelisting Using Microsoft AppLocker&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/nsacyber/BitLocker-Guidance">NSACyber - Bitlocker Guidance&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance">NSACyber - Hardware-and-Firmware-Security-Guidance&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/nsacyber/Windows-Secure-Host-Baseline">NSACyber - Windows Secure Host Baseline&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/undergroundwires/privacy.sexy">UnderGroundWires - Privacy.S**Y&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/Sycnex/Windows10Debloater">Sycnex - Windows10Debloater&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/The-Virtual-Desktop-Team/Virtual-Desktop-Optimization-Tool">The-Virtual-Desktop-Team - Virtual-Desktop-Optimization-Tool&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/TheVDIGuys/Windows_10_VDI_Optimize">TheVDIGuys - Windows 10 VDI Optimize&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/W4RH4WK/Debloat-Windows-10/tree/master/scripts">W4H4WK - Debloat Windows 10&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.whonix.org/wiki/Disable_TCP_and_ICMP_Timestamps">Whonix - Disable TCP Timestamps&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Adobe_Acrobat_Pro_DC_Continuous_V1R2_STIG.zip">Adobe Reader Pro DC Classic V1R3&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Adobe_Acrobat_Pro_DC_Classic_V1R3_STIG.zip">Adobe Reader Pro DC Continous V1R2&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_FireFox_V4R29_STIG.zip">Firefox V4R29&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Chrome_V1R19_STIG.zip">Google Chrome V1R19&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_IE11_V1R19_STIG.zip">Internet Explorer 11 V1R19&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_DotNet_Framework_4-0_V1R9_STIG.zip">Microsoft .Net Framework 4 V1R9&lt;/a> - &lt;strong>Work in Progress&lt;/strong>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MicrosoftOffice2013_V1R5_Overview.zip">Microsoft Office 2013 V1R5&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/pdf/U_Microsoft_Office_2016_V1R2_Overview.pdf">Microsoft Office 2016 V1R2&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Office_365_ProPlus_V1R2_STIG.zip">Microsoft Office 2019/Office 365 Pro Plus V1R2&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.cyber.mil/stigs/zip/U_MS_OneDrive_V2R1_STIG.zip">Microsoft OneDrive STIG V2R1&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_8_Windows_V1R5_STIG.zip">Oracle JRE 8 V1R5&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.cyber.mil/stigs/zip/U_MS_Windows_Defender_Antivirus_V2R1_STIG.zip">Windows 10 V2R1&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.cyber.mil/stigs/zip/U_MS_Windows_Defender_Antivirus_V2R1_STIG.zip">Windows Defender Antivirus V2R1&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Windows_Firewall_V1R7_STIG.zip">Windows Firewall V1R7&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;h3 id="manual-install">Manual Install:&lt;/h3>
&lt;p>If manually downloaded, the script must be launched from an administrative powershell in the directory containing all the files from the &lt;a href="https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat">GitHub Repository&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
Get-ChildItem -Recurse *.ps1 | Unblock-File
.\sos-optimize-windows.ps1
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="automated-install">Automated Install:&lt;/h3>
&lt;p>The script may be launched from the extracted GitHub download like this:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">iex ((New-Object System.Net.WebClient).DownloadString(&lt;span style="color:#e6db74">&amp;#39;https://simeononsecurity.ch/scripts/windowsoptimizeandharden.ps1&amp;#39;&lt;/span>))
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;!-- raw HTML omitted -->&lt;/p></description></item><item><title>Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts</title><link>/github/automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts/</link><pubDate>Wed, 22 Jul 2020 17:46:00 -0500</pubDate><guid>/github/automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts/</guid><description>
&lt;h1 id="automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts">Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts&lt;/h1>
&lt;p>Download all supporting files from the &lt;a href="https://github.com/simeononsecurity/ChocoAutomateWindowsUpdates">GitHub Repository&lt;/a>&lt;/p>
&lt;p>In today&amp;rsquo;s modern workplace environment, system administrators constantly are battling for time. Rolling out the latest Windows updates can be extremely time consuming taking up to a week given enough systems.
Along with some assistance from Chocolatey, PSWindowsUpdates, and Startup Scripts, Systems Administrators can roll out update with as little as a single reboot of each machine.&lt;/p>
&lt;h2 id="how-to-set-up-the-shutdown-script">How to set up the shutdown script&lt;/h2>
&lt;p>We have chosen to set it up as a shutdown script to avoid having to reboot twice.
We will be following the tutorial from &lt;a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn789190(v=ws.11)">Microsoft&lt;/a> to do this.&lt;/p>
&lt;p>In the windows gui perform the following steps:&lt;/p>
&lt;p>1.) Open the Local Group Policy Editor by hitting &lt;strong>&amp;ldquo;Win + R&amp;rdquo;&lt;/strong> and typing &lt;strong>&amp;ldquo;gpedit.msc&amp;rdquo;&lt;/strong> followed by &lt;strong>&amp;ldquo;Ctrl + Shift + Enter&amp;rdquo;&lt;/strong>&lt;/p>
&lt;p>2.) Navigate to Computer &lt;strong>Configuration\Windows Settings\Scripts (Startup/Shutdown).&lt;/strong>&lt;/p>
&lt;p>3.) In the results pane, double-click Shutdown.&lt;/p>
&lt;p>4.) Select the powershell tab&lt;/p>
&lt;p>5.) In the Shutdown Properties dialog box, click Add.&lt;/p>
&lt;p>6.) In the Script Name box, type the path to the script, or click Browse to search &amp;ldquo;&lt;em>chocoautomatewindowsupdates.ps1&lt;/em>&amp;rdquo; in the Netlogon shared folder on the domain controller.&lt;/p>
&lt;p>7.) Reboot&lt;/p>
&lt;p>8.) Profit?&lt;/p>
&lt;p>Now in the future, all an administrator has to do is reboot the computer to perform windows updates.&lt;/p>
&lt;p>The same steps can be performed in GPO to acomplish the same thing on multiple Windows machines at the same time.&lt;/p>
&lt;h2 id="how-the-script-works">How the script works&lt;/h2>
&lt;p>&lt;strong>The script we will be working with today titled &amp;ldquo;&lt;em>chocoautomatewindowsupdates.ps1&lt;/em>&amp;quot;:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
choco feature enable -n=allowGlobalConfirmation
choco feature enable -n useFipsCompliantChecksums
choco upgrade all
choco install pswindowsupdate
Add-WUServiceManager -ServiceID 7971f918-a847-4430-9279-4a52d1efe18d -Confirm:$false
Install-WindowsUpdate -MicrosoftUpdate -AcceptAll
Get-WuInstall -AcceptAll -IgnoreReboot
&lt;/code>&lt;/pre>&lt;p>&lt;strong>From &lt;a href="https://chocolatey.org/install">Chocolatey&lt;/a>, the script below installs the Chocolatey package manager:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
&lt;/code>&lt;/pre>&lt;p>&lt;strong>Folowed by a couple prefered Chocolatey configuration changes;&lt;/strong>&lt;/p>
&lt;pre>&lt;code>choco feature enable -n=allowGlobalConfirmation
choco feature enable -n useFipsCompliantChecksums
choco upgrade all
&lt;/code>&lt;/pre>&lt;p>&lt;strong>Lastly we will install and run &lt;a href="https://www.powershellgallery.com/packages/PSWindowsUpdate/2.0.0.4">PSWindowsUpdates&lt;/a> to install all of the available windows updates.&lt;/strong>&lt;/p>
&lt;pre>&lt;code>choco install pswindowsupdate
Add-WUServiceManager -ServiceID 7971f918-a847-4430-9279-4a52d1efe18d -Confirm:$false
Install-WindowsUpdate -MicrosoftUpdate -AcceptAll
Get-WuInstall -AcceptAll -IgnoreReboot
&lt;/code>&lt;/pre></description></item><item><title>Windows Spectre Meltdown Mitigation Script</title><link>/github/windows-spectre-meltdown-mitigation-script/</link><pubDate>Thu, 18 Jun 2020 00:00:00 +0000</pubDate><guid>/github/windows-spectre-meltdown-mitigation-script/</guid><description>
&lt;h4 id="httpssupportmicrosoftcomen-ushelp4073119protect-against-speculative-execution-side-channel-vulnerabilities-in">&lt;a href="https://support.microsoft.com/en-us/help/4073119/protect-against-speculative-execution-side-channel-vulnerabilities-in">https://support.microsoft.com/en-us/help/4073119/protect-against-speculative-execution-side-channel-vulnerabilities-in&lt;/a>&lt;/h4>
&lt;p>&lt;strong>Simple script to implement protections against speculative execution side-channel vulnerabilities in Windows systems.&lt;/strong>&lt;/p>
&lt;p>Microsoft is aware of a new publicly disclosed class of vulnerabilities that are called speculative execution side-channel attacks and that affect many modern processors including Intel, AMD, VIA, and ARM.&lt;/p>
&lt;p>&lt;strong>Note:&lt;/strong> This issue also affects other operating systems, such as Android, Chrome, iOS, and macOS. Therefore, we advise customers to seek guidance from those vendors.&lt;/p>
&lt;p>We have released several updates to help mitigate these vulnerabilities. We have also taken action to secure our cloud services. See the following sections for more details.&lt;/p>
&lt;p>We have not yet received any information to indicate that these vulnerabilities were used to attack customers. We are working closely with industry partners including chip makers, hardware OEMs, and application vendors to protect customers. To get all available protections, firmware (microcode) and software updates are required. This includes microcode from device OEMs and, in some cases, updates to antivirus software.&lt;/p>
&lt;p>&lt;strong>This article addresses the following vulnerabilities:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>CVE-2017-5715  &amp;ldquo;Branch Target Injection&amp;rdquo;&lt;/li>
&lt;li>CVE-2017-5753  &amp;ldquo;Bounds Check Bypass&amp;rdquo;&lt;/li>
&lt;li>CVE-2017-5754  &amp;ldquo;Rogue Data Cache Load&amp;rdquo;&lt;/li>
&lt;li>CVE-2018-3639  &amp;ldquo;Speculative Store Bypass&amp;rdquo;&lt;/li>
&lt;li>CVE-2018-11091  Microarchitectural Data Sampling Uncacheable Memory (MDSUM)&lt;/li>
&lt;li>CVE-2018-12126  Microarchitectural Store Buffer Data Sampling (MSBDS)&lt;/li>
&lt;li>CVE-2018-12127  Microarchitectural Fill Buffer Data Sampling (MFBDS)&lt;/li>
&lt;li>CVE-2018-12130  Microarchitectural Load Port Data Sampling (MLPDS)&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>UPDATED ON AUGUST 6, 2019&lt;/strong> On August 6, 2019 Intel released details about a Windows kernel information disclosure vulnerability. This vulnerability is a variant of the Spectre Variant 1 speculative execution side channel vulnerability and has been assigned CVE-2019-1125.&lt;/p>
&lt;p>&lt;strong>UPDATED ON NOVEMBER 12, 2019&lt;/strong> On November 12, 2019, Intel published a technical advisory around Intel Transactional Synchronization Extensions (Intel TSX) Transaction Asynchronous Abort vulnerability that is assigned CVE-2019-11135. Microsoft has released updates to help mitigate this vulnerability and the OS protections are enabled by default for Windows Client OS Editions.&lt;/p>
&lt;h2 id="recommended-actions">Recommended actions&lt;/h2>
&lt;p>Customers should take the following actions to help protect against the vulnerabilities:&lt;/p>
&lt;ul>
&lt;li>Apply all available Windows operating system updates, including the monthly Windows security updates.&lt;/li>
&lt;li>Apply the applicable firmware (microcode) update that is provided by the device manufacturer.&lt;/li>
&lt;li>Evaluate the risk to your environment based on the information that is provided on Microsoft Security Advisories: ADV180002, ADV180012, ADV190013 and information provided in this Knowledge Base article.&lt;/li>
&lt;li>Take action as required by using the advisories and registry key information that are provided in this Knowledge Base article.&lt;/li>
&lt;/ul>
&lt;h2 id="download-the-required-files">Download the required files:&lt;/h2>
&lt;p>Download the required files from the &lt;a href="https://github.com/simeononsecurity/Windows-Spectre-Meltdown-Mitigation-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="how-to-run-the-script">How to run the script:&lt;/h2>
&lt;p>&lt;strong>The script may be lauched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-spectre-meltdown-mitigations.ps1
&lt;/code>&lt;/pre></description></item><item><title>STIGing Standalone Windows Servers</title><link>/github/stiging-standalone-windows-servers/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/github/stiging-standalone-windows-servers/</guid><description>
&lt;h1 id="stiging-standalone-windows-servers">STIGing Standalone Windows Servers&lt;/h1>
&lt;p>Download all the required files from the &lt;a href="https://github.com/simeononsecurity/Standalone-Windows-Server-STIG-Script">GitHub Repository&lt;/a>&lt;/p>
&lt;h2 id="introduction">Introduction:&lt;/h2>
&lt;p>Windows Server 2012, 2016, and 2019 are insecure operating systems out of the box and requires many changes to insure &lt;a href="https://www.cisa.gov/federal-information-security-modernization-act">FISMA&lt;/a> compliance.
&lt;a href="https://microsoft.com">Microsoft&lt;/a>, &lt;a href="https://public.cyber.mil">Cyber.mil&lt;/a>, the &lt;a href="https://dod.gov">Department of Defense&lt;/a>, and the &lt;a href="https://www.nsa.gov/">National Security Agency&lt;/a> have recommended and required configuration changes to lockdown, harden, and secure the operating system and ensure government compliance. These changes cover a wide range of mitigations including blocking telemetry, macros, removing bloatware, and preventing many physical attacks on a system.&lt;/p>
&lt;p>Standalone systems are some of the most difficult and annoying systems to secure. When not automated, they require manual changes of each STIG/SRG. Totalling over 1000 configuration changes on a typical deployment and an average of 5 minutes per change equaling 3.5 days worth of work. This script aims to speed up that process significantly.&lt;/p>
&lt;h2 id="notes">Notes:&lt;/h2>
&lt;ul>
&lt;li>This script is designed for operation in &lt;strong>Enterprise&lt;/strong> environments and assumes you have hardware support for all the requirements.&lt;/li>
&lt;li>This script is not designed to bring a system to 100% compliance, rather it should be used as a stepping stone to complete most, if not all, the configuration changes that can be scripted.
&lt;ul>
&lt;li>Minus system documentation, this collection should bring you up to about 95% compliance on all the STIGS/SRGs applied.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="requirements">Requirements:&lt;/h2>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Windows 10 Enterprise is &lt;strong>Required&lt;/strong> per STIG.&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-highly-secure">Standards&lt;/a> for a highly secure Windows 10 device&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> System is &lt;a href="https://support.microsoft.com/en-gb/help/4027667/windows-10-update">fully up to date&lt;/a>
&lt;ul>
&lt;li>Currently Windows 10 &lt;strong>v1909&lt;/strong> or &lt;strong>v2004&lt;/strong>.&lt;/li>
&lt;li>Run the &lt;a href="https://support.microsoft.com/en-us/help/3159635/windows-10-update-assistant">Windows 10 Upgrade Assistant&lt;/a> to be update and verify latest major release.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Hardware Requirements
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/requirements-and-deployment-planning-guidelines-for-virtualization-based-protection-of-code-integrity#baseline-protections">Hardware Requirements for Memory Integrity&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/reqs-wd-app-guard">Hardware Requirements for Windows Defender Application Guard&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements">Hardware Requirements for Windows Defender Credential Guard&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="recommended-reading-material">Recommended reading material:&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-secure-launch-and-smm-protection#requirements-met-by-system-guard-enabled-machines">System Guard Secure Launch&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-how-hardware-based-root-of-trust-helps-protect-windows">System Guard Root of Trust&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/overview-hardware-based-isolation">Hardware-based Isolation&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/memory-integrity">Memory integrity&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/wd-app-guard-overview">Windows Defender Application Guard&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-how-it-works">Windows Defender Credential Guard&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="a-list-of-scripts-and-tools-this-collection-utilizes">A list of scripts and tools this collection utilizes:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=55319">Microsoft Security Compliance Toolkit 1.0&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://public.cyber.mil/stigs/gpo/">Cyber.mil - Group Policy Objects&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://github.com/nsacyber/BitLocker-Guidance">NSACyber - Bitlocker Guidance&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="additional-configurations-were-considered-from">Additional configurations were considered from:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance">NSACyber - Hardware-and-Firmware-Security-Guidance&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://apps.nsa.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm">NSACyber - Application Whitelisting Using Microsoft AppLocker&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="stigssrgs-applied">STIGS/SRGs Applied:&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_2012_and_2012_R2_MS_V2R19_STIG_SCAP_1-2_Benchmark.zip">Windows Server 2012(R2)&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_Server_2016_V1R12_STIG.zip">Windows Server 2016&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="#">Windows Server 2019&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_Defender_Antivirus_V1R9_STIG.zip">Windows Defender Antivirus V1R9&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Windows_Firewall_V1R7_STIG.zip">Windows Firewall V1R7&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_IE11_V1R19_STIG.zip">Internet Explorer 11 V1R19&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Google_Chrome_V1R19_STIG.zip">Google Chrome V1R19&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_FireFox_V4R29_STIG.zip">Firefox V4R29&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_DotNet_Framework_4-0_V1R9_STIG.zip">Microsoft .Net Framework 4 V1R9&lt;/a> - &lt;strong>Work in Progress&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_JRE_8_Windows_V1R5_STIG.zip">Oracle JRE 8 V1R5&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="how-to-run-the-script">How to run the script&lt;/h2>
&lt;p>&lt;strong>The script may be launched from the extracted GitHub download like this:&lt;/strong>&lt;/p>
&lt;pre>&lt;code>.\sos-secure-standalone-server.ps1
&lt;/code>&lt;/pre>&lt;p>The script we will be must be launched from the directory containing all the files from the &lt;a href="https://github.com/simeononsecurity/Standalone-Windows-Server-STIG-Script">GitHub Repository&lt;/a>&lt;/p></description></item></channel></rss>