<!doctype html><html lang=en><head><title>SolarWinds Orion Supply Chain Compromised, C2, and Mitigations :: simeononsecurity — a security and automation blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="For guidance on the solarwinds issue please see DHS, SolarWinds, FireEYE, MSRC, and Microsoft.
Advanced users, please see the FireEYE repo on this issue.
SANS has a good video on the topic here.
Executables: The DLL in question is SolarWinds.Orion.Core.BusinessLayer.dll and was signed as a ligitimate part of the SolarWinds suite, bypassing application control technologies. It is installed as a service.
The malicious code was injected into a legitimate DLL and is loaded into memory when the application runs."><meta name=keywords content="python python,compliance windows 10,cybersecurity hardening,automation hardening,python hardening,compliance compliance,compliance automation,automation compliance,compliance hardening,powershell security,windows 10 python,automation automation,automation windows 10,security hardening,windows 10 automation,powershell compliance,windows 10 powershell,security powershell,windows 10 cybersecurity,windows 10 hardening,automation python,security python,hardening powershell,compliance cybersecurity,cybersecurity security,python windows 10,windows 10 security,automation powershell,hardening compliance,security security,windows 10 compliance,hardening cybersecurity,powershell automation,security windows 10,python powershell,compliance powershell,powershell python,security cybersecurity,hardening windows 10,cybersecurity compliance,hardening python,hardening automation,security automation,powershell powershell,security compliance,hardening security,windows 10 windows 10,python compliance,powershell cybersecurity,compliance security,cybersecurity python,automation security,cybersecurity cybersecurity,compliance python,cybersecurity windows 10,cybersecurity powershell,python security,python cybersecurity,hardening hardening,automation cybersecurity,python automation,powershell windows 10,powershell hardening,cybersecurity automation,"><meta name=robots content="index,follow" content="all"><link rel=canonical href=../../blog/solarwinds-orion-mitigations/><meta name=author content="SimeonOnSecurity"><meta name=revisit-after content="1 days"><meta name=distribution content="article"><meta name=copyright content="SimeonOnSecurity"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="SimeonOnSecurity"><meta property="og:image" content="/img/banner.png"><meta property="og:url" content="https://simeononsecurity.ch"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta name=twitter:description content="For guidance on the solarwinds issue please see DHS, SolarWinds, FireEYE, MSRC, and Microsoft.
Advanced users, please see the FireEYE repo on this issue.
SANS has a good video on the topic here.
Executables: The DLL in question is SolarWinds.Orion.Core.BusinessLayer.dll and was signed as a ligitimate part of the SolarWinds suite, bypassing application control technologies. It is installed as a service.
The malicious code was injected into a legitimate DLL and is loaded into memory when the application runs."><link rel=stylesheet href=../../css/style.min.css><link rel=stylesheet href=../../style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=../../img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=../../img/favicon.png><link rel=icon href=../../img/favicon.ico type=image/x-icon><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta name=twitter:description content="For guidance on the solarwinds issue please see DHS, SolarWinds, FireEYE, MSRC, and Microsoft.
Advanced users, please see the FireEYE repo on this issue.
SANS has a good video on the topic here.
Executables: The DLL in question is SolarWinds.Orion.Core.BusinessLayer.dll and was signed as a ligitimate part of the SolarWinds suite, bypassing application control technologies. It is installed as a service.
The malicious code was injected into a legitimate DLL and is loaded into memory when the application runs."><meta property="og:title" content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta property="og:description" content="For guidance on the solarwinds issue please see DHS, SolarWinds, FireEYE, MSRC, and Microsoft.
Advanced users, please see the FireEYE repo on this issue.
SANS has a good video on the topic here.
Executables: The DLL in question is SolarWinds.Orion.Core.BusinessLayer.dll and was signed as a ligitimate part of the SolarWinds suite, bypassing application control technologies. It is installed as a service.
The malicious code was injected into a legitimate DLL and is loaded into memory when the application runs."><meta property="og:type" content="article"><meta property="og:url" content="/blog/solarwinds-orion-mitigations/"><meta property="og:image" content="/img/banner.png"><meta property="article:published_time" content="2020-12-14T00:00:00+00:00"><meta property="article:modified_time" content="2020-12-14T17:17:13-06:00"><meta property="og:site_name" content="simeononsecurity"><link rel=alternate type=application/rss+xml title=simeononsecurity href=../../sitemap.xml><script data-ad-client=ca-pub-4092442123207538 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173461240-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-173461240-1');ga('set','userId','USER_ID');gtag('set',{'user_id':'USER_ID'});</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=../../ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Show more
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span></li><ul class="menu__sub-inner-more hidden"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendations>Recommendations</a></li><li><a href=../../writeups>Writeups</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendations>Recommendations</a></li><li><a href=../../writeups>Writeups</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title><a href=../../blog/solarwinds-orion-mitigations/>SolarWinds Orion Supply Chain Compromised, C2, and Mitigations</a></h1><div class=post-meta><span class=post-date>2020-12-14</span></div><span class=post-tags>#<a href=../../tags/solarwinds/>SolarWinds</a>&nbsp;
#<a href=../../tags/solarwinds-c2/>SolarWinds C2</a>&nbsp;
#<a href=../../tags/solarwinds-orion/>SolarWinds Orion</a>&nbsp;
#<a href=../../tags/solarwinds-supply-chain/>SolarWinds Supply Chain</a>&nbsp;
#<a href=../../tags/supply-chain/>Supply Chain</a>&nbsp;
#<a href=../../tags/c2/>C2</a>&nbsp;
#<a href=../../tags/command-and-control/>Command and Control</a>&nbsp;
#<a href=../../tags/mitigations/>Mitigations</a>&nbsp;
#<a href=../../tags/guidance/>Guidance</a>&nbsp;
#<a href=../../tags/threat-intelligence/>Threat Intelligence</a>&nbsp;</span><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><a href=#executables>Executables:</a></li><li><a href=#network-information>Network information:</a></li><li><a href=#dll-locationshttpsgistgithubcomkylehanslovan0c8a491104cc55d6e4bd9bff7214a99e><a href=https://gist.github.com/KyleHanslovan/0c8a491104cc55d6e4bd9bff7214a99e>DLL Locations</a>:</a></li><li><a href=#microsoft-malicious-dll-table>Microsoft Malicious DLL Table:</a></li><li><a href=#fireeye-indicator-table>FireEYE Indicator Table:</a></li></ul></nav></aside><p>For guidance on the solarwinds issue please see <a href=https://cyber.dhs.gov/ed/21-01/>DHS</a>, <a href=https://www.solarwinds.com/securityadvisory>SolarWinds</a>, <a href=https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html>FireEYE</a>, <a href=https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/>MSRC</a>, and <a href="https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/Solorigate.B!dha">Microsoft</a>.</p><p>Advanced users, please see the <a href=https://github.com/fireeye/sunburst_countermeasures>FireEYE repo</a> on this issue.</p><p>SANS has a good video on the topic <a href="https://www.youtube.com/watch?v=4tmlZCk2gCg&feature=youtu.be">here</a>.</p><h2 id=executables>Executables:</h2><p>The DLL in question is <code>SolarWinds.Orion.Core.BusinessLayer.dll</code> and was signed as a ligitimate part of the SolarWinds suite, bypassing application control technologies. It is installed as a service.</p><p>The malicious code was injected into a legitimate DLL and is loaded into memory when the application runs. The code runs before the legitimate code. According to Microsoft, the code is activated when <code>SolarWinds.BusinessLayerHost.exe</code> executable runs, but may the following may also load it:</p><ul><li><code>ConfigurationWizard.exe</code></li><li><code>NetflowDatabaseMaintenance.exe</code></li><li><code>NetFlowService.exe</code></li><li><code>SolarWinds.Administration.exe</code></li><li><code>SolarWinds.BusinessLayerHost.exe</code></li><li><code>SolarWinds.Collector.Service.exe</code></li><li><code>SolarwindsDiagnostics.exe</code></li></ul><h2 id=network-information>Network information:</h2><p><strong>General Ranges:</strong></p><ul><li>DNS CNAMEs for C2:<ul><li><code>.appsync-api.eu-west-1[.]avsvmcloud[.]com</code></li><li><code>.appsync-api.us-west-2[.]avsvmcloud[.]com</code></li><li><code>.appsync-api.us-east-1[.]avsvmcloud[.]com</code></li><li><code>.appsync-api.us-east-2[.]avsvmcloud[.]com</code></li></ul></li><li>IP Ranges for C2:<ul><li><code>20.140.0.0/15</code></li><li><code>96.31.172.0/24</code></li><li><code>131.228.12.0/22</code></li><li><code>144.86.226.0/24</code></li></ul></li></ul><p><strong>Specifically Identified:</strong></p><ul><li>DNS Names associated with C2:<ul><li><code>6a57jk2ba1d9keg15cbg.appsync-api.eu-west-1.avsvmcloud[.]com</code></li><li><code>7sbvaemscs0mc925tb99.appsync-api.us-west-2.avsvmcloud[.]com</code></li><li><code>gq1h856599gqh538acqn.appsync-api.us-west-2.avsvmcloud[.]com</code></li><li><code>ihvpgv9psvq02ffo77et.appsync-api.us-east-2.avsvmcloud[.]com</code></li><li><code>k5kcubuassl3alrf7gm3.appsync-api.eu-west-1.avsvmcloud[.]com</code></li><li><code>mhdosoksaccf9sni9icp.appsync-api.eu-west-1.avsvmcloud[.]com</code></li></ul></li><li>IPs assosciated with C2:<ul><li><code>13.59.205.66</code></li><li><code>54.193.127.66</code></li><li><code>54.215.192.52</code></li><li><code>34.203.203.23</code></li><li><code>139.99.115.204</code></li><li><code>5.252.177.25</code></li><li><code>5.252.177.21</code></li><li><code>204.188.205.176</code></li><li><code>51.89.125.18</code></li><li><code>167.114.213.199</code></li></ul></li></ul><h2 id=dll-locationshttpsgistgithubcomkylehanslovan0c8a491104cc55d6e4bd9bff7214a99e><a href=https://gist.github.com/KyleHanslovan/0c8a491104cc55d6e4bd9bff7214a99e>DLL Locations</a>:</h2><ul><li><code>C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\Solarwinds\Network Topology Mapper\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\Solarwinds\Network Topology Mapper\Service\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\DPI\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\NCM\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\Interfaces.Discovery\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\DPA\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\HardwareHealth\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\Interfaces\SolarWinds.Orion.Core.BusinessLayer.dl</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\NetFlowTrafficAnalysis\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\NPM\SolarWinds.Orion.Core.BusinessLayer.dll</code></li></ul><h2 id=microsoft-malicious-dll-table>Microsoft Malicious DLL Table:</h2><table><thead><tr><th>SHA256</th><th>File Version</th><th>Date first seen</th></tr></thead><tbody><tr><td>32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77</td><td>2019.4.5200.9083</td><td>March 2020</td></tr><tr><td>dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b</td><td>2020.2.100.12219</td><td>March 2020</td></tr><tr><td>eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed</td><td>2020.2.100.11831</td><td>March 2020</td></tr><tr><td>c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77</td><td>Not available</td><td>March 2020</td></tr><tr><td>ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c</td><td>2020.4.100.478</td><td>April 2020</td></tr><tr><td>019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134</td><td>2020.2.5200.12394</td><td>April 2020</td></tr><tr><td>ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6</td><td>2020.2.5300.12432</td><td>May 2020</td></tr><tr><td>a25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc</td><td>2019.4.5200.8890</td><td>October 2019</td></tr><tr><td>d3c6785e18fba3749fb785bc313cf8346182f532c59172b69adfb31b96a5d0af</td><td>2019.4.5200.8890</td><td>October 2019</td></tr></tbody></table><h2 id=fireeye-indicator-table>FireEYE Indicator Table:</h2><table><thead><tr><th>SHA256</th><th>SHA1</th><th>MD5</th><th>FILENAME</th><th>MIME</th><th>Malware Family</th><th>Role</th><th></th></tr></thead><tbody><tr><td>d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600</td><td>1b476f58ca366b54f34d714ffce3fd73cc30db1a</td><td>02af7cec58b9a5da1c542b5a32151ba1</td><td>CORE-2019.4.5220.20574-SolarWinds-Core-v2019.4.5220-Hotfix5.msp</td><td>application/vnd.ms-office</td><td>SUNBURST</td><td>Installer</td><td></td></tr><tr><td>53f8dfc65169ccda021b72a62e0c22a4db7c4077f002fa742717d41b3c40f2c7</td><td>47d92d49e6f7f296260da1af355f941eb25360c4</td><td>08e35543d6110ed11fdf558bb093d401</td><td>Solarwinds Worldwide, LLC</td><td>application/x-x509-server-cert</td><td>Code Signing Certificate</td><td>Legitimate SolarWinds code-signing certificate</td><td></td></tr><tr><td>019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134</td><td>2f1a5a7411d015d01aaee4535835400191645023</td><td>2c4a910a1299cdae2a4e55988a2f102e</td><td>SolarWinds.Orion.Core.BusinessLayer.dll</td><td>application/x-dosexec</td><td>SUNBURST</td><td>backdoor</td><td></td></tr><tr><td>ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6</td><td>d130bd75645c2433f88ac03e73395fba172ef676</td><td>846e27a652a5e1bfbd0ddd38a16dc865</td><td>SolarWinds.Orion.Core.BusinessLayer.dll</td><td>application/x-dosexec</td><td>SUNBURST</td><td>backdoor</td><td></td></tr><tr><td>32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77</td><td>76640508b1e7759e548771a5359eaed353bf1eec</td><td>b91ce2fa41029f6955bff20079468448</td><td>SolarWinds.Orion.Core.BusinessLayer.dll</td><td>application/x-dosexec</td><td>SUNBURST</td><td>backdoor</td><td></td></tr><tr><td>292327e5c94afa352cc5a02ca273df543f2020d0e76368ff96c84f4e90778712</td><td>c2c30b3a287d82f88753c85cfb11ec9eb1466bad</td><td>4f2eb62fa529c0283b28d05ddd311fae</td><td>OrionImprovementBusinessLayer.2.cs</td><td>text/plain</td><td>SUNBURST</td><td>Decompiled and corrected source code for SUNBURST</td><td></td></tr><tr><td>c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table></div></div></div><footer class=footer><div class=footer__inner><div><span><a href=../../contactus/ target=_blank rel=noopener>Contact</a></span></span></div><div><span><a href=../../privacypolicy/ target=_blank rel=noopener>Privacy</a></span></div><div><span><a href=../../termsandconditions/ target=_blank rel=noopener>Terms</a></span></span></div><div><span><a href=../../sitemap.xml target=_blank rel=noopener>Sitemap</a></span></span></div><div><span><a href=../../index.xml target=_blank rel=noopener>RSS</a></span></span></div><div class=copyright><span>© 2020 SimeonOnSecurity</span></div></div></footer><script src=../../js/menu.js></script><script src=../../js/theme.js></script><script src=../../js/prism.js></script></div></body></html>