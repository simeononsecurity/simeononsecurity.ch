<!doctype html><html lang=en><head><title>SolarWinds Orion Supply Chain Compromised, C2, and Mitigations :: simeononsecurity — a security and automation blog</title><meta property="og:title" content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta property="og:description" content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta property="og:type" content="article"><meta property="og:url" content="/github/solarwinds-orion-mitigations/"><meta property="og:image" content="/img/banner.png"><meta property="article:published_time" content="2020-12-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-04T01:19:13-06:00"><meta property="og:site_name" content="simeononsecurity"><base href=../../github/solarwinds-orion-mitigations/><link rel=canonical href=../../github/solarwinds-orion-mitigations/ itemprop=url><title itemprop=name>SolarWinds Orion Supply Chain Compromised, C2, and Mitigations | simeononsecurity</title><meta charset=utf-8><meta itemprop=description content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta itemprop=name content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations | simeononsecurity"><meta name=HandheldFriendly content="True"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="SimeonOnSecurity"><meta name=apple-touch-fullscreen content="yes"><meta name=application-name content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations | simeononsecurity"><meta name=copyright content="SimeonOnSecurity"><meta name=coverage content="Worldwide"><meta name=description content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta name=distribution content="Global"><meta name=googlebot content="index,follow"><meta name=imagemode content="force"><meta name=keywords content="SolarWinds,SolarWinds C2,SolarWinds Orion,SolarWinds Supply Chain,Supply Chain,C2,Command and Control,Mitigations,Guidance,Threat Intelligence,"><meta name=msapplication-TileColor content="#141414"><meta name=msapplication-tap-highlight content="no"><meta name=revisit-after content="1 days"><meta name=robots content="index, follow, noarchive, notranslate, max-snippet:20, max-image-preview:large" content="all"><meta name=theme-color content="#141414"><meta name=url content="/github/solarwinds-orion-mitigations/"><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=datePublished content="2020-12-14T00:00:00+00:00"><meta itemprop=dateModified content="2021-03-04T01:19:13-06:00"><meta itemprop=wordCount content="235"><meta itemprop=image content="/img/banner.png"><meta itemprop=keywords content="SolarWinds,SolarWinds C2,SolarWinds Orion,SolarWinds Supply Chain,Supply Chain,C2,Command and Control,Mitigations,Guidance,Threat Intelligence,"><link rel=sitemap type=application/xml title=Sitemap href=../../sitemap.xml><meta name=twitter:url content="/github/solarwinds-orion-mitigations/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta name=twitter:description content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><link rel=stylesheet href=../../css/style.min.css><link rel=stylesheet href=../../style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=../../img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=../../img/favicon.png><link rel=icon href=../../img/favicon.ico type=image/x-icon><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta name=twitter:description content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta property="og:title" content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta property="og:description" content="SolarWinds Orion Supply Chain Compromised, C2, and Mitigations"><meta property="og:type" content="article"><meta property="og:url" content="/github/solarwinds-orion-mitigations/"><meta property="og:image" content="/img/banner.png"><meta property="article:published_time" content="2020-12-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-04T01:19:13-06:00"><meta property="og:site_name" content="simeononsecurity"><link rel=alternate type=application/rss+xml title=simeononsecurity href=../../sitemap.xml><script data-ad-client=ca-pub-4092442123207538 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173461240-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-173461240-1',{'anonymize_ip':true});ga('set','userId','USER_ID');gtag('set',{'user_id':'USER_ID'});</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=../../ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Show more
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span></li><ul class="menu__sub-inner-more hidden"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendhome>Recommendations</a></li><li><a href=../../til>Today I Learned</a></li><li><a href=../../writeups>Writeups</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendhome>Recommendations</a></li><li><a href=../../til>Today I Learned</a></li><li><a href=../../writeups>Writeups</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title><a href=../../github/solarwinds-orion-mitigations/>SolarWinds Orion Supply Chain Compromised, C2, and Mitigations</a></h1><div class=post-meta><span class=post-date>2020-12-14</span>
<span class=post-moddate>(Modified: 2021-03-04)</span></div><span class=post-tags>#<a href=../../tags/solarwinds/>SolarWinds</a>&nbsp;
#<a href=../../tags/solarwinds-c2/>SolarWinds C2</a>&nbsp;
#<a href=../../tags/solarwinds-orion/>SolarWinds Orion</a>&nbsp;
#<a href=../../tags/solarwinds-supply-chain/>SolarWinds Supply Chain</a>&nbsp;
#<a href=../../tags/supply-chain/>Supply Chain</a>&nbsp;
#<a href=../../tags/c2/>C2</a>&nbsp;
#<a href=../../tags/command-and-control/>Command and Control</a>&nbsp;
#<a href=../../tags/mitigations/>Mitigations</a>&nbsp;
#<a href=../../tags/guidance/>Guidance</a>&nbsp;
#<a href=../../tags/threat-intelligence/>Threat Intelligence</a>&nbsp;</span><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><a href=#executables>Executables:</a></li><li><a href=#network-information>Network information:</a></li><li><a href=#dll-locationshttpsgistgithubcomkylehanslovan0c8a491104cc55d6e4bd9bff7214a99e><a href=https://gist.github.com/KyleHanslovan/0c8a491104cc55d6e4bd9bff7214a99e>DLL Locations</a>:</a></li><li><a href=#microsoft-malicious-dll-tablehttpsgithubcomsimeononsecuritysolarwinds-sunburst-countermeasures><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>Microsoft Malicious DLL Table:</a></a></li><li><a href=#fireeye-indicator-tablehttpsgithubcomsimeononsecuritysolarwinds-sunburst-countermeasures><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>FireEYE Indicator Table:</a></a></li><li><a href=#sites-known-to-be-hit-by-sunburstsolarflarehttpsgithubcomsimeononsecuritysolarwinds-sunburst-countermeasures><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>Sites Known to Be Hit By SunBurst/SolarFlare:</a></a></li></ul></nav></aside><p>For guidance on the solarwinds issue please see <a href=https://cyber.dhs.gov/ed/21-01/>DHS</a>, <a href=https://www.solarwinds.com/securityadvisory>SolarWinds</a>, <a href=https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html>FireEYE</a>, <a href=https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/>MSRC</a>, and <a href="https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/Solorigate.B!dha">Microsoft</a>.</p><p>Advanced users, please see the <a href=https://github.com/fireeye/sunburst_countermeasures>FireEYE Countermeasures Repo</a> on this issue.</p><p>SANS has a good video on the topic <a href="https://www.youtube.com/watch?v=4tmlZCk2gCg&feature=youtu.be">here</a>.</p><h2 id=executables>Executables:</h2><p>The DLL in question is <code>SolarWinds.Orion.Core.BusinessLayer.dll</code> and was signed as a ligitimate part of the SolarWinds suite, bypassing application control technologies. It is installed as a service.</p><p>The malicious code was injected into a legitimate DLL and is loaded into memory when the application runs. The code runs before the legitimate code. According to Microsoft, the code is activated when <code>SolarWinds.BusinessLayerHost.exe</code> executable runs, but may the following may also load it:</p><ul><li><code>ConfigurationWizard.exe</code></li><li><code>NetflowDatabaseMaintenance.exe</code></li><li><code>NetFlowService.exe</code></li><li><code>SolarWinds.Administration.exe</code></li><li><code>SolarWinds.BusinessLayerHost.exe</code></li><li><code>SolarWinds.Collector.Service.exe</code></li><li><code>SolarwindsDiagnostics.exe</code></li></ul><h2 id=network-information>Network information:</h2><p><strong>General Ranges:</strong></p><ul><li>DNS CNAMEs for C2:<ul><li><code>.appsync-api.eu-west-1[.]avsvmcloud[.]com</code></li><li><code>.appsync-api.us-west-2[.]avsvmcloud[.]com</code></li><li><code>.appsync-api.us-east-1[.]avsvmcloud[.]com</code></li><li><code>.appsync-api.us-east-2[.]avsvmcloud[.]com</code></li></ul></li><li>IP Ranges for C2:<ul><li><code>20.140.0.0/15</code></li><li><code>96.31.172.0/24</code></li><li><code>131.228.12.0/22</code></li><li><code>144.86.226.0/24</code></li></ul></li></ul><p><strong>Specifically Identified:</strong></p><ul><li>DNS Names associated with C2:<ul><li><code>6a57jk2ba1d9keg15cbg.appsync-api.eu-west-1.avsvmcloud[.]com</code></li><li><code>7sbvaemscs0mc925tb99.appsync-api.us-west-2.avsvmcloud[.]com</code></li><li><code>gq1h856599gqh538acqn.appsync-api.us-west-2.avsvmcloud[.]com</code></li><li><code>ihvpgv9psvq02ffo77et.appsync-api.us-east-2.avsvmcloud[.]com</code></li><li><code>k5kcubuassl3alrf7gm3.appsync-api.eu-west-1.avsvmcloud[.]com</code></li><li><code>mhdosoksaccf9sni9icp.appsync-api.eu-west-1.avsvmcloud[.]com</code></li></ul></li><li>IPs assosciated with C2:<ul><li><code>13.59.205.66</code></li><li><code>54.193.127.66</code></li><li><code>54.215.192.52</code></li><li><code>34.203.203.23</code></li><li><code>139.99.115.204</code></li><li><code>5.252.177.25</code></li><li><code>5.252.177.21</code></li><li><code>204.188.205.176</code></li><li><code>51.89.125.18</code></li><li><code>167.114.213.199</code></li></ul></li></ul><h2 id=dll-locationshttpsgistgithubcomkylehanslovan0c8a491104cc55d6e4bd9bff7214a99e><a href=https://gist.github.com/KyleHanslovan/0c8a491104cc55d6e4bd9bff7214a99e>DLL Locations</a>:</h2><ul><li><code>C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\Solarwinds\Network Topology Mapper\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\Solarwinds\Network Topology Mapper\Service\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\DPI\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\NCM\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\Interfaces.Discovery\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\DPA\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\HardwareHealth\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\Interfaces\SolarWinds.Orion.Core.BusinessLayer.dl</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\NetFlowTrafficAnalysis\SolarWinds.Orion.Core.BusinessLayer.dll</code></li><li><code>C:\Program Files (x86)\SolarWinds\Orion\NPM\SolarWinds.Orion.Core.BusinessLayer.dll</code></li></ul><h2 id=microsoft-malicious-dll-tablehttpsgithubcomsimeononsecuritysolarwinds-sunburst-countermeasures><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>Microsoft Malicious DLL Table:</a></h2><ul><li><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>See the GitHub Repository for more info</a></li></ul><h2 id=fireeye-indicator-tablehttpsgithubcomsimeononsecuritysolarwinds-sunburst-countermeasures><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>FireEYE Indicator Table:</a></h2><ul><li><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>See the GitHub Repository for more info</a></li></ul><h2 id=sites-known-to-be-hit-by-sunburstsolarflarehttpsgithubcomsimeononsecuritysolarwinds-sunburst-countermeasures><a href=https://github.com/simeononsecurity/SolarWinds-SunBurst-Countermeasures>Sites Known to Be Hit By SunBurst/SolarFlare:</a></h2><ul><li><a href=https://github.com/RedDrip7/SunBurst_DGA_Decode>https://github.com/RedDrip7/SunBurst_DGA_Decode</a></li><li><a href=https://pastebin.com/raw/6NukuxBN>https://pastebin.com/raw/6NukuxBN</a></li></ul></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=../../github/offine-ps-activedirectory-install/><span class=button__icon>←</span>
<span class=button__text>Install RSAT ActiveDirectory PowerShell Module Offline</span></a></span>
<span class="button next"><a href=../../github/virustotal-ps/><span class=button__text>VirusTotal PowerShell Modules</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div><span><a href=../../contactus/ target=_blank rel=noopener>Contact</a></span></span></div><div><span><a href=../../privacypolicy/ target=_blank rel=noopener>Privacy</a></span></div><div><span><a href=../../termsandconditions/ target=_blank rel=noopener>Terms</a></span></span></div><div><span><a href=../../sitemap.xml target=_blank rel=noopener>Sitemap</a></span></span></div><div><span><a href=../../index.xml target=_blank rel=noopener>RSS</a></span></span></div><div class=copyright><span>© 2021 SimeonOnSecurity</span></div></div></footer><script src=../../js/menu.js></script><script src=../../js/theme.js></script><script src=../../js/prism.js></script></div></body></html>