<!doctype html><html lang=en><head><title>CVE-2020-1350 KB4569509 DNS Server Vulnerability :: simeononsecurity — a security and automation blog</title><meta property="og:title" content="CVE-2020-1350 KB4569509 DNS Server Vulnerability"><meta property="og:description" content="KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350 Introduction On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience."><meta property="og:type" content="article"><meta property="og:url" content="/github/cve-2020-1350_kb4569509_dns_server_vulnerability/"><meta property="og:image" content="/img/banner.png"><meta property="article:published_time" content="2020-07-25T21:09:37-05:00"><meta property="article:modified_time" content="2020-11-14T22:09:01-06:00"><meta property="og:site_name" content="simeononsecurity"><base href=../../github/cve-2020-1350_kb4569509_dns_server_vulnerability/><link rel=canonical href=../../github/cve-2020-1350_kb4569509_dns_server_vulnerability/ itemprop=url><title itemprop=name>CVE-2020-1350 KB4569509 DNS Server Vulnerability | simeononsecurity</title><meta charset=utf-8><meta itemprop=description content="KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350 Introduction On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience."><meta itemprop=name content="CVE-2020-1350 KB4569509 DNS Server Vulnerability | simeononsecurity"><meta name=HandheldFriendly content="True"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="SimeonOnSecurity"><meta name=apple-touch-fullscreen content="yes"><meta name=application-name content="CVE-2020-1350 KB4569509 DNS Server Vulnerability | simeononsecurity"><meta name=copyright content="SimeonOnSecurity"><meta name=coverage content="Worldwide"><meta name=description content="KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350 Introduction On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience."><meta name=distribution content="Global"><meta name=googlebot content="index,follow"><meta name=imagemode content="force"><meta name=keywords content="CVE-2020-1350,KB4569509,DNS Server Vulnerability,Windows Server,Powershell,Script,"><meta name=msapplication-TileColor content="#141414"><meta name=msapplication-tap-highlight content="no"><meta name=revisit-after content="1 days"><meta name=robots content="index,follow" content="all"><meta name=theme-color content="#141414"><meta name=url content="/github/cve-2020-1350_kb4569509_dns_server_vulnerability/"><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=datePublished content="2020-07-25T21:09:37-05:00"><meta itemprop=dateModified content="2020-11-14T22:09:01-06:00"><meta itemprop=wordCount content="373"><meta itemprop=image content="/img/banner.png"><meta itemprop=keywords content="CVE-2020-1350,KB4569509,DNS Server Vulnerability,Windows Server,Powershell,Script,"><link rel=sitemap type=application/xml title=Sitemap href=../../sitemap.xml><meta name=twitter:url content="/github/cve-2020-1350_kb4569509_dns_server_vulnerability/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="CVE-2020-1350 KB4569509 DNS Server Vulnerability"><meta name=twitter:description content="KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350 Introduction On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience."><link rel=stylesheet href=../../css/style.min.css><link rel=stylesheet href=../../style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=../../img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=../../img/favicon.png><link rel=icon href=../../img/favicon.ico type=image/x-icon><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="CVE-2020-1350 KB4569509 DNS Server Vulnerability"><meta name=twitter:description content="KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350 Introduction On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience."><meta property="og:title" content="CVE-2020-1350 KB4569509 DNS Server Vulnerability"><meta property="og:description" content="KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350 Introduction On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience."><meta property="og:type" content="article"><meta property="og:url" content="/github/cve-2020-1350_kb4569509_dns_server_vulnerability/"><meta property="og:image" content="/img/banner.png"><meta property="article:published_time" content="2020-07-25T21:09:37-05:00"><meta property="article:modified_time" content="2020-11-14T22:09:01-06:00"><meta property="og:site_name" content="simeononsecurity"><link rel=alternate type=application/rss+xml title=simeononsecurity href=../../sitemap.xml><script data-ad-client=ca-pub-4092442123207538 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173461240-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-173461240-1',{'anonymize_ip':true});ga('set','userId','USER_ID');gtag('set',{'user_id':'USER_ID'});</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=../../ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Show more
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span></li><ul class="menu__sub-inner-more hidden"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendhome>Recommendations</a></li><li><a href=../../til>Today I Learned</a></li><li><a href=../../writeups>Writeups</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendhome>Recommendations</a></li><li><a href=../../til>Today I Learned</a></li><li><a href=../../writeups>Writeups</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title><a href=../../github/cve-2020-1350_kb4569509_dns_server_vulnerability/>CVE-2020-1350 KB4569509 DNS Server Vulnerability</a></h1><div class=post-meta><span class=post-date>2020-07-25</span></div><span class=post-tags>#<a href=../../tags/cve-2020-1350/>CVE-2020-1350</a>&nbsp;
#<a href=../../tags/kb4569509/>KB4569509</a>&nbsp;
#<a href=../../tags/dns-server-vulnerability/>DNS Server Vulnerability</a>&nbsp;
#<a href=../../tags/windows-server/>Windows Server</a>&nbsp;
#<a href=../../tags/powershell/>Powershell</a>&nbsp;
#<a href=../../tags/script/>Script</a>&nbsp;</span><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#workaround>Workaround</a></li><li><a href=#important-information-about-this-workaround>Important information about this workaround</a></li></ul></nav></aside><h1 id=kb4569509-guidance-for-dns-server-vulnerability-cve-2020-1350httpssupportmicrosoftcomen-ushelp4569509windows-dns-server-remote-code-execution-vulnerability><a href=https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability>KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350</a></h1><h2 id=introduction>Introduction</h2><p>On July 14, 2020, Microsoft released a security update for the issue that is described in CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects Windows servers that are configured to run the DNS Server role. We strongly recommend that server administrators apply the security update at their earliest convenience.</p><p>A registry-based workaround can be used to help protect an affected Windows server, and it can be implemented without requiring an administrator to restart the server. Because of the volatility of this vulnerability, administrators may have to implement the workaround before they apply the security update in order to enable them to update their systems by using a standard deployment cadence.</p><h2 id=workaround>Workaround</h2><p><strong>Optional:</strong> Download the workaround script from the <a href=https://github.com/simeononsecurity/CVE-2020-1350-Fix>GitHub Repository</a></p><p>To work around this vulnerability, make the following registry change to restrict the size of the largest inbound TCP-based DNS response packet that&rsquo;s allowed:</p><p>Subkey: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters</p><p>Value: TcpReceivePacketSize</p><p>Type: DWORD</p><p>Value data: 0xFF00</p><p><strong>Notes:</strong></p><pre><code>The default (also maximum) Value data = 0xFFFF.

The recommended Value data = 0xFF00 (255 bytes less than the maximum).

You must restart the DNS Service for the registry change to take effect. To do this, run the following command at an elevated command prompt:
</code></pre><p>          <code>net stop dns && net start dns</code></p><h2 id=important-information-about-this-workaround>Important information about this workaround</h2><p>TCP-based DNS response packets that exceed the recommended value will be dropped without error. Therefore, it is possible that some queries might not be answered. This could cause an unanticipated failure. A DNS server will be negatively impacted by this workaround only if it receives valid TCP responses that are greater than allowed in the previous mitigation (more than 65,280 bytes).</p><p>The reduced value is unlikely to affect standard deployments or recursive queries. However, a non-standard use-case may exist in a given environment. To determine whether the server implementation will be adversely affected by this workaround, you should enable diagnostic logging, and capture a sample set that is representative of your typical business flow. Then, you will have to review the log files to identify the presence of anomalously large TCP response packets</p><p>For more information, see <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn800669%28v=ws.11%29">DNS Logging and Diagnostics</a>.</p></div></div></div><footer class=footer><div class=footer__inner><div><span><a href=../../contactus/ target=_blank rel=noopener>Contact</a></span></span></div><div><span><a href=../../privacypolicy/ target=_blank rel=noopener>Privacy</a></span></div><div><span><a href=../../termsandconditions/ target=_blank rel=noopener>Terms</a></span></span></div><div><span><a href=../../sitemap.xml target=_blank rel=noopener>Sitemap</a></span></span></div><div><span><a href=../../index.xml target=_blank rel=noopener>RSS</a></span></span></div><div class=copyright><span>© 2021 SimeonOnSecurity</span></div></div></footer><script src=../../js/menu.js></script><script src=../../js/theme.js></script><script src=../../js/prism.js></script></div></body></html>