<!doctype html><html lang=en><head><title>Harden Windows with Windows Defender Application Control (WDAC) :: simeononsecurity — a security and automation blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Windows-Defender-Application-Control-Hardening Harden Windows with Windows Defender Application Control (WDAC)
A list of scripts and tools this collection utilizes:  MicrosoftDocs - WDAC-Toolkit  Additional configurations were considered from:  Microsoft - Recommended block rules Microsoft - Recommended driver block rules Microsoft - Windows Defender Application Control  Explanation:  Default Policies:  The &amp;ldquo;Default&amp;rdquo; policies use only the default features available in the WDAC-Toolkit.   Recommended Policies:  The &amp;ldquo;Recommended&amp;rdquo; policies use the default features as well as Microsoft&amp;rsquo;s recommended blocks and driver block rules."><meta name=keywords content="python python,compliance windows 10,cybersecurity hardening,automation hardening,python hardening,compliance compliance,compliance automation,automation compliance,compliance hardening,powershell security,windows 10 python,automation automation,automation windows 10,security hardening,windows 10 automation,powershell compliance,windows 10 powershell,security powershell,windows 10 cybersecurity,windows 10 hardening,automation python,security python,hardening powershell,compliance cybersecurity,cybersecurity security,python windows 10,windows 10 security,automation powershell,hardening compliance,security security,windows 10 compliance,hardening cybersecurity,powershell automation,security windows 10,python powershell,compliance powershell,powershell python,security cybersecurity,hardening windows 10,cybersecurity compliance,hardening python,hardening automation,security automation,powershell powershell,security compliance,hardening security,windows 10 windows 10,python compliance,powershell cybersecurity,compliance security,cybersecurity python,automation security,cybersecurity cybersecurity,compliance python,cybersecurity windows 10,cybersecurity powershell,python security,python cybersecurity,hardening hardening,automation cybersecurity,python automation,powershell windows 10,powershell hardening,cybersecurity automation,"><meta name=robots content="index,follow" content="all"><link rel=canonical href=../../github/windows-defender-application-control-hardening/><meta name=author content="SimeonOnSecurity"><meta name=revisit-after content="1 days"><meta name=distribution content="article"><meta name=copyright content="SimeonOnSecurity"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="SimeonOnSecurity"><meta property="og:image" content="/img/banner.png"><meta property="og:url" content="https://simeononsecurity.ch"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="Harden Windows with Windows Defender Application Control (WDAC)"><meta name=twitter:description content="Windows-Defender-Application-Control-Hardening Harden Windows with Windows Defender Application Control (WDAC)
A list of scripts and tools this collection utilizes:  MicrosoftDocs - WDAC-Toolkit  Additional configurations were considered from:  Microsoft - Recommended block rules Microsoft - Recommended driver block rules Microsoft - Windows Defender Application Control  Explanation:  Default Policies:  The &ldquo;Default&rdquo; policies use only the default features available in the WDAC-Toolkit.   Recommended Policies:  The &ldquo;Recommended&rdquo; policies use the default features as well as Microsoft&rsquo;s recommended blocks and driver block rules."><link rel=stylesheet href=../../css/style.min.css><link rel=stylesheet href=../../style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=../../img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=../../img/favicon.png><link rel=icon href=../../img/favicon.ico type=image/x-icon><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/banner.png"><meta name=twitter:title content="Harden Windows with Windows Defender Application Control (WDAC)"><meta name=twitter:description content="Windows-Defender-Application-Control-Hardening Harden Windows with Windows Defender Application Control (WDAC)
A list of scripts and tools this collection utilizes:  MicrosoftDocs - WDAC-Toolkit  Additional configurations were considered from:  Microsoft - Recommended block rules Microsoft - Recommended driver block rules Microsoft - Windows Defender Application Control  Explanation:  Default Policies:  The &ldquo;Default&rdquo; policies use only the default features available in the WDAC-Toolkit.   Recommended Policies:  The &ldquo;Recommended&rdquo; policies use the default features as well as Microsoft&rsquo;s recommended blocks and driver block rules."><meta property="og:title" content="Harden Windows with Windows Defender Application Control (WDAC)"><meta property="og:description" content="Windows-Defender-Application-Control-Hardening Harden Windows with Windows Defender Application Control (WDAC)
A list of scripts and tools this collection utilizes:  MicrosoftDocs - WDAC-Toolkit  Additional configurations were considered from:  Microsoft - Recommended block rules Microsoft - Recommended driver block rules Microsoft - Windows Defender Application Control  Explanation:  Default Policies:  The &ldquo;Default&rdquo; policies use only the default features available in the WDAC-Toolkit.   Recommended Policies:  The &ldquo;Recommended&rdquo; policies use the default features as well as Microsoft&rsquo;s recommended blocks and driver block rules."><meta property="og:type" content="article"><meta property="og:url" content="/github/windows-defender-application-control-hardening/"><meta property="og:image" content="/img/banner.png"><meta property="article:published_time" content="2020-12-16T00:00:00+00:00"><meta property="article:modified_time" content="2020-12-17T07:59:24+00:00"><meta property="og:site_name" content="simeononsecurity"><link rel=alternate type=application/rss+xml title=simeononsecurity href=../../sitemap.xml><script data-ad-client=ca-pub-4092442123207538 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173461240-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-173461240-1');ga('set','userId','USER_ID');gtag('set',{'user_id':'USER_ID'});</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=../../ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Show more
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span></li><ul class="menu__sub-inner-more hidden"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendations>Recommendations</a></li><li><a href=../../til>Today I Learned</a></li><li><a href=../../writeups>Writeups</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=../../about>About</a></li><li><a href=../../blog>Blog</a></li><li><a href=../../ctfranks>CTF Rankings</a></li><li><a href=../../github>GitHub</a></li><li><a href=../../recommendations>Recommendations</a></li><li><a href=../../til>Today I Learned</a></li><li><a href=../../writeups>Writeups</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title><a href=../../github/windows-defender-application-control-hardening/>Harden Windows with Windows Defender Application Control (WDAC)</a></h1><div class=post-meta><span class=post-date>2020-12-16</span>
<span class=post-moddate>(Modified: 2020-12-17)</span></div><span class=post-tags>#<a href=../../tags/powershell/>PowerShell</a>&nbsp;
#<a href=../../tags/powershell-script/>PowerShell Script</a>&nbsp;
#<a href=../../tags/automation/>Automation</a>&nbsp;
#<a href=../../tags/compliance/>Compliance</a>&nbsp;
#<a href=../../tags/blue-team/>Blue-Team</a>&nbsp;
#<a href=../../tags/windows-defender-stig-script/>Windows Defender STIG Script</a>&nbsp;
#<a href=../../tags/windows-defender/>Windows Defender</a>&nbsp;
#<a href=../../tags/windows-defender-hardening/>Windows Defender Hardening</a>&nbsp;
#<a href=../../tags/windows-defender-stig/>Windows Defender STIG</a>&nbsp;
#<a href=../../tags/defender-stig/>Defender STIG</a>&nbsp;
#<a href=../../tags/windows-defender-application-control/>Windows Defender Application Control</a>&nbsp;
#<a href=../../tags/wdac/>WDAC</a>&nbsp;
#<a href=../../tags/windows-defender-exploit-protection/>Windows Defender Exploit Protection</a>&nbsp;
#<a href=../../tags/wdep/>WDEP</a>&nbsp;
#<a href=../../tags/windows-defender-attack-surface-reduction/>Windows Defender Attack Surface Reduction</a>&nbsp;
#<a href=../../tags/asr/>ASR</a>&nbsp;</span><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><a href=#a-list-of-scripts-and-tools-this-collection-utilizes>A list of scripts and tools this collection utilizes:</a></li><li><a href=#additional-configurations-were-considered-from>Additional configurations were considered from:</a></li><li><a href=#explanation>Explanation:</a><ul><li><a href=#there-are-four-policy-files-available>There are four policy files available:</a></li><li><a href=#auditing>Auditing:</a></li></ul></li><li><a href=#how-to-run-the-script>How to run the script:</a><ul><li><a href=#manual-install>Manual Install:</a></li></ul></li></ul></nav></aside><h1 id=windows-defender-application-control-hardening>Windows-Defender-Application-Control-Hardening</h1><p>Harden Windows with Windows Defender Application Control (WDAC)</p><h2 id=a-list-of-scripts-and-tools-this-collection-utilizes>A list of scripts and tools this collection utilizes:</h2><ul><li><a href=https://github.com/MicrosoftDocs/WDAC-Toolkit>MicrosoftDocs - WDAC-Toolkit</a></li></ul><h2 id=additional-configurations-were-considered-from>Additional configurations were considered from:</h2><ul><li><a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules>Microsoft - Recommended block rules</a></li><li><a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules>Microsoft - Recommended driver block rules</a></li><li><a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control-design-guide>Microsoft - Windows Defender Application Control</a></li></ul><h2 id=explanation>Explanation:</h2><ul><li><strong>Default Policies:</strong><ul><li>The &ldquo;Default&rdquo; policies use only the default features available in the WDAC-Toolkit.</li></ul></li><li><strong>Recommended Policies:</strong><ul><li>The &ldquo;Recommended&rdquo; policies use the default features as well as Microsoft&rsquo;s recommended <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules>blocks</a> and <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules>driver block</a> rules.</li></ul></li><li><strong>Audit Policies:</strong><ul><li>The &ldquo;Audit&rdquo; policies, just log exceptions to the rules. This is for testing in your environment, so that you may modify the policies, at will, to fit your environments needs.</li></ul></li><li><strong>Enforced Policies:</strong><ul><li>The &ldquo;Enforced&rdquo; policies will not allow any exceptions to the rules, applications, drivers, dlls, etc. will be blocked if they do not comply.</li></ul></li></ul><h3 id=there-are-four-policy-files-available>There are four policy files available:</h3><ul><li><strong>Audit Only:</strong><ul><li><code>WDAC_V1_Default_Audit.xml</code></li><li><code>WDAC_V1_Recommended_Audit.xml</code></li></ul></li><li><strong>Enforced:</strong><ul><li><code>WDAC_V1_Default_Enforced.xml</code></li><li><code>WDAC_V1_Recommended_Enforced.xml</code></li></ul></li></ul><p>Update the following line in the script to use the policy that you desire:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps data-lang=ps><span style=color:#a6e22e>Set-RuleOption</span> <span style=color:#a6e22e>-FilePath</span> <span style=color:#a6e22e>&#34;C:\temp\Windows</span> <span style=color:#a6e22e>Defender\WDAC_V1_Recommended_Enforced.xml&#34;</span> <span style=color:#a6e22e>-Option</span> <span style=color:#ae81ff>0</span>
</code></pre></div><p>Alternatively, you may use <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-using-group-policy>Group Policy to enforce the WDAC policies</a>.</p><h3 id=auditing>Auditing:</h3><ul><li>Recommended Reading:</li><li><a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/audit-windows-defender-application-control-policies>Microsoft - Audit Windows Defender Application Control Policies</a></li></ul><p>You can view the WDAC event logs under <strong>Applications and Services Logs\Microsoft\Windows\CodeIntegrity\Operational</strong>.</p><h2 id=how-to-run-the-script>How to run the script:</h2><h3 id=manual-install>Manual Install:</h3><p>If manually downloaded, the script must be launched from an administrative powershell in the directory containing all the files from the <a href=https://github.com/simeononsecurity/Windows-Defender-Application-Control-Hardening/archive/main.zip>GitHub Repository</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
Get-ChildItem -Recurse *.ps1 | Unblock-File
.\sos-wdachardening.ps1
</code></pre></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=../../github/kms-auto-ps/><span class=button__icon>←</span>
<span class=button__text>GLVK Auto Install Script for KMS Activation</span></a></span>
<span class="button next"><a href=../../github/offine-ps-activedirectory-install/><span class=button__text>Install RSAT ActiveDirectory PowerShell Module Offline</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div><span><a href=../../contactus/ target=_blank rel=noopener>Contact</a></span></span></div><div><span><a href=../../privacypolicy/ target=_blank rel=noopener>Privacy</a></span></div><div><span><a href=../../termsandconditions/ target=_blank rel=noopener>Terms</a></span></span></div><div><span><a href=../../sitemap.xml target=_blank rel=noopener>Sitemap</a></span></span></div><div><span><a href=../../index.xml target=_blank rel=noopener>RSS</a></span></span></div><div class=copyright><span>© 2020 SimeonOnSecurity</span></div></div></footer><script src=../../js/menu.js></script><script src=../../js/theme.js></script><script src=../../js/prism.js></script></div></body></html>