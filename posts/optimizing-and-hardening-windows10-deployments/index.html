<!doctype html><html lang=en><head><title>Optimizing and Hardening Windows 10 Deployments :: simeononsecurity — a security and automation blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Optimizing and Hardening Windows 10 Deployments Download all the required files from the GitHub Repository
Windows 10 is an invasive and insecure operating system out of the box. Organizations like PrivacyTools.io, Microsoft, Cyber.mil, the Department of Defense, and the National Security Agency have recomended configuration changes to lockdown, harden, and secure the operating system. These changes cover a wide range of mitigations including blocking telemetery, macros, removing bloatware, and preventing many physical attacks on a system."><meta name=keywords content="python python,compliance windows 10,cybersecurity hardening,automation hardening,python hardening,compliance compliance,compliance automation,automation compliance,compliance hardening,powershell security,windows 10 python,automation automation,automation windows 10,security hardening,windows 10 automation,powershell compliance,windows 10 powershell,security powershell,windows 10 cybersecurity,windows 10 hardening,automation python,security python,hardening powershell,compliance cybersecurity,cybersecurity security,python windows 10,windows 10 security,automation powershell,hardening compliance,security security,windows 10 compliance,hardening cybersecurity,powershell automation,security windows 10,python powershell,compliance powershell,powershell python,security cybersecurity,hardening windows 10,cybersecurity compliance,hardening python,hardening automation,security automation,powershell powershell,security compliance,hardening security,windows 10 windows 10,python compliance,powershell cybersecurity,compliance security,cybersecurity python,automation security,cybersecurity cybersecurity,compliance python,cybersecurity windows 10,cybersecurity powershell,python security,python cybersecurity,hardening hardening,automation cybersecurity,python automation,powershell windows 10,powershell hardening,cybersecurity automation,"><meta name=robots content="noodp"><link rel=canonical href=/posts/optimizing-and-hardening-windows10-deployments/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon.png><meta name=twitter:card content="summary"><meta name=twitter:title content="Optimizing and Hardening Windows 10 Deployments"><meta name=twitter:description content="Optimizing and Hardening Windows 10 Deployments Download all the required files from the GitHub Repository
Windows 10 is an invasive and insecure operating system out of the box. Organizations like PrivacyTools.io, Microsoft, Cyber.mil, the Department of Defense, and the National Security Agency have recomended configuration changes to lockdown, harden, and secure the operating system. These changes cover a wide range of mitigations including blocking telemetery, macros, removing bloatware, and preventing many physical attacks on a system."><meta property="og:title" content="Optimizing and Hardening Windows 10 Deployments"><meta property="og:description" content="Optimizing and Hardening Windows 10 Deployments Download all the required files from the GitHub Repository
Windows 10 is an invasive and insecure operating system out of the box. Organizations like PrivacyTools.io, Microsoft, Cyber.mil, the Department of Defense, and the National Security Agency have recomended configuration changes to lockdown, harden, and secure the operating system. These changes cover a wide range of mitigations including blocking telemetery, macros, removing bloatware, and preventing many physical attacks on a system."><meta property="og:type" content="article"><meta property="og:url" content="/posts/optimizing-and-hardening-windows10-deployments/"><meta property="article:published_time" content="2020-07-22T20:15:14-05:00"><meta property="article:modified_time" content="2020-07-22T20:15:14-05:00"><meta property="og:site_name" content="simeononsecurity"><link href=data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAD9/f0AAAAAAP///wDx8fEA+vr6APz8/ADu7u4A/v7+APDw8AD5+fkA8vLyAAwM6AD7+/sAAAAAAAAAAAAAAAAAEREREREREREREbuxG7sRERERsRuxGxEREREbsRuxERERZxERERFAEREmEREREagREREYK7YhERERESUSYWIRERFnaBYhJkAREVFZNTU1GhEREcERERwRERERG3Z2sRERERG7u7u7EREREbu7u7sRERERG7u7sRERERERERERERHxjwAA4AcAAOAHAADAAwAAgAEAAIABAADAAwAAwAMAAIABAACAAQAAwAMAAMADAADgBwAA4AcAAPAPAAD4HwAA rel=icon type=image/x-icon><link href=/favicon.ico rel=icon type=image/x-icon><script data-ad-client=ca-pub-4092442123207538 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173461240-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-173461240-1');ga('set','userId','USER_ID');gtag('set',{'user_id':'USER_ID'});</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>simeononsecurity</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Show more
<span class=menu__sub-inner-more-trigger-icon><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span></li><ul class="menu__sub-inner-more hidden"><li><a href=/recommendations>Recommendations</a></li><li><a href=/sitemap.xml>Sitemap</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/recommendations>Recommendations</a></li><li><a href=/sitemap.xml>Sitemap</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title><a href=/posts/optimizing-and-hardening-windows10-deployments/>Optimizing and Hardening Windows 10 Deployments</a></h1><div class=post-meta><span class=post-date>2020-07-22</span></div><div class=post-content><h1 id=optimizing-and-hardening-windows-10-deployments>Optimizing and Hardening Windows 10 Deployments</h1><p><strong>Download all the required files from the <a href=https://github.com/smiltech/W10-Optimize-and-Harden>GitHub Repository</a></strong></p><p>Windows 10 is an invasive and insecure operating system out of the box.
Organizations like <a href=https://PrivacyTools.io>PrivacyTools.io</a>, <a href=https://microsoft.com>Microsoft</a>, <a href=https://public.cyber.mil>Cyber.mil</a>, the <a href=https://dod.gov>Department of Defense</a>, and the <a href=https://www.nsa.gov/>National Security Agency</a> have recomended configuration changes to lockdown, harden, and secure the operating system. These changes cover a wide range of mitigations including blocking telemetery, macros, removing bloatware, and preventing many physical attacks on a system.</p><h2 id=requirements>Requirements</h2><ul><li><input checked disabled type=checkbox> <a href=https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-highly-secure>Standards</a> for a highly secure Windows 10 device</li><li><input checked disabled type=checkbox> Latest <a href=https://www.microsoft.com/en-us/software-download/windows10>Windows 10 stable version</a></li><li><input checked disabled type=checkbox> System is <a href=https://support.microsoft.com/en-gb/help/4027667/windows-10-update>fully up to date</a></li><li><input checked disabled type=checkbox> (default activated) internal Windows Defender protection instead of external &ldquo;Security&rdquo; solutions</li><li><input checked disabled type=checkbox> Latest Driver and Program updates</li><li><input checked disabled type=checkbox> No &ldquo;Tuning&rdquo; tools</li><li><input checked disabled type=checkbox> Only necessary tools which you realy need</li><li><input checked disabled type=checkbox> <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-secure-launch-and-smm-protection#requirements-met-by-system-guard-enabled-machines>Hardware Requirements</a> for <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-how-hardware-based-root-of-trust-helps-protect-windows>System Guard</a> / <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/overview-hardware-based-isolation>Hardware-based Isolation</a></li><li><input checked disabled type=checkbox> <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/requirements-and-deployment-planning-guidelines-for-virtualization-based-protection-of-code-integrity#baseline-protections>Hardware Requirements</a> for <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/memory-integrity>Memory integrity</a></li><li><input checked disabled type=checkbox> <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/reqs-wd-app-guard>Hardware Requirements</a> for Windows <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/wd-app-guard-overview>Defender Application Guard</a> (WDAG)</li><li><input checked disabled type=checkbox> <a href=https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements>Hardware Requirements</a> for Windows <a href=https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-how-it-works>Defender Credential Guard</a></li></ul><h2 id=a-list-of-scripts-and-tools-this-collection-utilizes>A list of scripts and tools this collection utilizes:</h2><p>1.) <a href="https://www.microsoft.com/en-us/download/details.aspx?id=55319">Microsoft Security Compliance Toolkit 1.0</a></p><p>2.) <a href=https://public.cyber.mil/stigs/gpo/>Cyber.mil - Group Policy Objects</a></p><p>3.) <a href=https://github.com/Sycnex/Windows10Debloater>Sycnex - Windows10Debloater</a></p><p>4.) <a href=https://github.com/TheVDIGuys/Windows_10_VDI_Optimize>TheVDIGuys - Windows 10 VDI Optimize</a></p><p>5.) <a href=https://github.com/builtbybel/sharpapp>Mirinsoft - SharpApp</a></p><p>6.) <a href=https://github.com/builtbybel/debotnet>Mirinsoft - debotnet</a></p><p>7.) <a href=https://github.com/nsacyber/BitLocker-Guidance>NSACyber - Bitlocker Guidance</a></p><p>8.) <a href=https://github.com/0x6d69636b/windows_hardening>0x6d69636b - Windows Hardening</a></p><h2 id=additional-configurations-were-considered-from>Additional configurations were considered from:</h2><p><a href=https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance>NSACyber - Hardware-and-Firmware-Security-Guidance</a></p><p><a href=https://apps.nsa.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm>NSACyber - Application Whitelisting Using Microsoft AppLocker</a></p><p><a href=https://www.whonix.org/wiki/Disable_TCP_and_ICMP_Timestamps>Whonix - Disable TCP Timestamps</a></p><p><a href=https://kb.cert.org/vuls/id/573168/>CERT - IE Scripting Engine Memory Corruption</a></p><p><a href=https://dirteam.com/sander/2019/07/30/howto-disable-weak-protocols-cipher-suites-and-hashing-algorithms-on-web-application-proxies-ad-fs-servers-and-windows-servers-running-azure-ad-connect/>Dirteam - SSL Hardening</a></p><p><a href=https://support.microsoft.com/en-us/help/4072698/windows-server-speculative-execution-side-channel-vulnerabilities>Microsoft - Specture and Meltdown Mitigations</a></p><p><a href=https://docs.microsoft.com/en-us/windows/privacy/>Microsoft - Windows 10 Privacy</a></p><p><a href=https://docs.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft-services>Microsoft - Managing Windows 10 Telemetry and Callbacks</a></p><p><a href=https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds_vdi-recommendations-1909>Microsoft - Windows 10 VDI Recomendations</a></p><h2 id=how-to-run-the-script>How to run the script</h2><p><strong>The script may be lauched from the extracted GitHub download like this:</strong></p><pre><code>.\W10-Optimize-and-Harden-master\installallstandalone.ps1
</code></pre><p><strong>Or with the optional executable</strong></p><pre><code>.\W10-Optimize-and-Harden-master\installallstandalone.exe
</code></pre><p>The script we will be using must be launched from the directory containing all the other files from the <a href=https://github.com/smiltech/W10-Optimize-and-Harden>GitHub Repository</a></p><p><strong>In order to enable the Windows 10 VDI Optimizations you must uncomment the line below:</strong></p><pre><code>.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\&quot;Windows_10_VDI&quot;\1909_WindowsUpdateEnabled\Win10_1909_VDI_Optimize.ps1

</code></pre><p><strong>In order to enable the SSL Hardening you must uncomment the line below:</strong></p><pre><code>.\Scripts\&quot;Security, Hardening, and Mitigation&quot;\&quot;SSL Hardening Registries.ps1&quot;

</code></pre><p><strong>The script we will be using is called <strong>&ldquo;installallstandalone.ps1&rdquo;</strong> and its contents are:</strong></p><pre><code>######SCRIPT FOR FULL INSTALL AND CONFIGURE ON STANDALONE MACHINE#####


#Windows 10 Defenter Exploit Guard Configuration File
mkdir C:\temp\
mkdir &quot;C:\temp\Windows Defender&quot;
copy-item -Path .\Files\DOD_EP_V3.xml -Destination &quot;C:\temp\Windows Defender&quot; -Force -Recurse

#Copy  Policy Definitions for gpedit.msc
copy-item -Path .\PolicyDefinitions\* -Destination C:\Windows\PolicyDefinitions -Force -Recurse

#Package Management Scripts
#.\Scripts\&quot;Package Management and Windows Updates&quot;\installrsat.ps1
.\Scripts\&quot;Package Management and Windows Updates&quot;\chocoautomatewindowsupdates.ps1

#Security Scripts
.\Scripts\&quot;Security, Hardening, and Mitigations&quot;\&quot;disable tcp timestamps.bat&quot;
.\Scripts\&quot;Security, Hardening, and Mitigations&quot;\&quot;IE Scripting Engine Memory Corruption.bat&quot;
.\Scripts\&quot;Security, Hardening, and Mitigations&quot;\&quot;specture meltdown mitigations.bat&quot;
.\Scripts\&quot;Security, Hardening, and Mitigations&quot;\HardeningKitty\soskitty.ps1

#Security Scripts Testing Required
#Only enable after testing in your environment
#.\Scripts\&quot;Security, Hardening, and Mitigations&quot;\&quot;SSL Hardening Registries.ps1&quot;

#Debloating Scripts

#ONLY ENABLE IF ON VM
#.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\&quot;Windows_10_VDI&quot;\1909_WindowsUpdateEnabled\Win10_1909_VDI_Optimize.ps1

.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\&quot;Windows 10 Debloater&quot;\Windows10SysPrepDebloater.ps1 -Sysprep -Debloat -Privacy
.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\&quot;Windows 10 telemetry.ps1&quot;
.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\ultimate performance mode.ps1
.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\optimizevmvirtalization.ps1
.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\startupcleantelem.ps1
.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\sharpapp\sharpappscripts.ps1
.\Scripts\&quot;Debloating, Optimization, and Privacy&quot;\debotnet\debotnetscripts.ps1

#GPO Configurations
#Microsoft Security Baselines
.\LGPO\LGPO.exe /g .\GPOs\Microsoft\&quot;Windows 10 1909 Baseline&quot;\GPOs
.\LGPO\LGPO.exe /g .\GPOs\Microsoft\&quot;Microsoft Edge v80&quot;\GPOs
.\LGPO\LGPO.exe /g .\GPOs\Microsoft\Office365-ProPlus-Sept2019-FINAL\GPOs
#Cyber.mil GPOs
.\LGPO\LGPO.exe /g .\GPOs\Cyber.mil
#NSACyber GPOs
.\LGPO\LGPO.exe /g .\GPOs\NSACyber\Computer
#SIMEONONSECURITY GPOS
.\LGPO\LGPO.exe /g .\GPOs\simeononsecurity
</code></pre></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/chromium-admx-templates/><span class=button__icon>←</span>
<span class=button__text>Chromium ADMX Templates</span></a></span>
<span class="button next"><a href=/posts/automating-windows-updates-with-chocolatey-pswindowsupdate-and-startup-scripts/><span class=button__text>Automating Windows Updates with Chocolatey, PSWindowsUpdate, and Startup Scripts</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user">SimeonOnSecurity 2020</div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>