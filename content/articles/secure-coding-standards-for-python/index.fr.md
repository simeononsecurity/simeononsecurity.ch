---
title: "Secure Coding Standards for Python: Best Practices"
date: 2023-02-26
toc: true
draft: false
description: "Learn the best practices for secure coding in Python to minimize the risk of security breaches and protect sensitive data."
tags: ["Python", "Secure coding", "Security risks", "Input validation", "Cryptography libraries", "Least privilege", "Static code analyzer", "Web applications", "Python frameworks", "Django", "Flask", "Authentication system", "Password hashing", "Template system", "Session management", "MarkupSafe", "WTForms", "Blinker", "Data protection", "Vulnerabilities"]
cover: "/img/cover/A_cartoon_shield_with_the_word_Python.png"
coverAlt: "A cartoon shield with the word Python written on it to represent secure coding standards"
coverCaption: ""
---
```python
import re

def validate_input(input_string):
    """
    Function to validate input using regular expressions.
    """
    pattern = r"^[0-9]+$"
    if re.match(pattern, input_string):
        return True
    else:
        return False
```
```py
# Instead of using eval function
x = eval('10')

# Use int function
x = int('10')
```
```py
from cryptography.fernet import Fernet

def encrypt_password(password):
    """
    Function to encrypt password using cryptography library.
    """
    key = Fernet.generate_key()
    f = Fernet(key)
    encrypted_password = f.encrypt(password.encode('utf-8'))
    return encrypted_password

password = "mypassword"
encrypted_password = encrypt_password(password)
```
```py
# Instead of this
query = "SELECT * FROM users WHERE username = '" + username + "';"

# Use parameterized query
query = "SELECT * FROM users WHERE username = %s;"
cursor.execute(query, (username,))
```
```python
from [Django](https://www.djangoproject.com/).contrib.auth.hashers import make_password

password = "mypassword"
hashed_password = make_password(password)
```
```py
from markupsafe import escape

@app.route('/')
def hello():
    name = "<script>alert('xss');</script>"
    return 'Hello, ' + escape(name)
```

**Meilleures pratiques pour les normes de codage sécurisé en Python**  ### 1. Validation des entrées  ### Validation des entrées  L'entrée de l'utilisateur est souvent une source importante de risques de sécurité. La **validation des entrées** est le processus de vérification que l'entrée de l'utilisateur répond aux critères attendus et peut être utilisée en toute sécurité dans l'application.  Par exemple, lorsqu'un utilisateur entre un numéro de carte de crédit, l'entrée ne doit contenir que des chiffres et aucun caractère spécial. Pour valider l'entrée, les développeurs peuvent utiliser des fonctions intégrées telles que `isdigit()` ou des expressions régulières pour s'assurer que l'entrée répond aux critères attendus.   ### 2. Évitez d'utiliser des fonctions dangereuses  Python a plusieurs fonctions qui peuvent être vulnérables aux problèmes de sécurité si elles ne sont pas utilisées avec précaution. Des fonctions telles que `exec()`, `eval()` et `pickle` peuvent permettre aux attaquants d'exécuter du code malveillant. Les développeurs doivent **éviter d'utiliser ces fonctions** ou les utiliser avec prudence en limitant les paramètres d'entrée et en les utilisant uniquement lorsque cela est nécessaire.  Par exemple, au lieu d'utiliser la fonction `eval()` pour convertir une chaîne en entier, les développeurs doivent utiliser la fonction `int()`.  ### 3. Utiliser les bibliothèques de cryptographie  **Les bibliothèques de cryptographie** telles que [`cryptography`](https://pypi.org/project/cryptography/) et [`pycryptodome`](https://pypi.org/project/pycryptodome/) fournissent un moyen d'effectuer des opérations de chiffrement et de déchiffrement. Utilisez ces bibliothèques au lieu de créer des méthodes de chiffrement personnalisées, qui peuvent être sujettes à des vulnérabilités.  Par exemple, pour chiffrer un mot de passe, utilisez la bibliothèque [`cryptography`](https://pypi.org/project/cryptography/) comme suit : L'objet `Fernet` a généré une clé, qui est utilisé pour crypter le mot de passe en utilisant la méthode `encrypt()`.  ### 4. Suivez le principe du moindre privilège  **Le principe du moindre privilège** est une bonne pratique de sécurité qui limite les utilisateurs ou les processus au niveau d'accès minimum nécessaire pour exécuter leurs fonctions. Les développeurs doivent suivre ce principe lors de l'écriture du code afin de minimiser l'impact des failles de sécurité.  Par exemple, si une application nécessite un accès en lecture seule à une base de données, elle doit utiliser un compte de base de données avec des autorisations en lecture seule au lieu d'un compte avec des autorisations complètes. Cela réduit le risque qu'un attaquant exploite l'application pour modifier ou supprimer des données.  ### 5. Gardez les bibliothèques et les frameworks à jour  Les bibliothèques et les frameworks peuvent contenir des vulnérabilités de sécurité qui peuvent être exploitées par des attaquants. Les développeurs doivent **maintenir leurs bibliothèques et frameworks à jour** vers la dernière version pour éviter les problèmes de sécurité potentiels.  Par exemple, si l'application utilise une bibliothèque tierce, telle que [`Requests`](https://pypi.org/project/requests/), qui présente une faille de sécurité, le développeur doit mettre à jour la dernière version de la bibliothèque qui corrige la vulnérabilité.  ### 6. Utilisez un analyseur de code statique  **Un analyseur de code statique** est un outil capable d'identifier les failles de sécurité potentielles dans le code avant son exécution. Utilisez des outils tels que [`bandit`](https://pypi.org/project/bandit/), [`Pylint`](https://pypi.org/project/pylint/) et [`Pyflakes`] (https://pypi.org/project/pyflakes/) pour détecter les problèmes de sécurité dans le code et les corriger avant le déploiement.  Par exemple, [`bandit`](https://pypi.org/project/bandit/) est un analyseur de code statique populaire qui examine le code Python pour les vulnérabilités de sécurité potentielles. Il peut détecter des problèmes tels que les mots de passe codés en dur, l'injection SQL et l'utilisation de fonctions non sécurisées.  ### 7. Utilisez des pratiques de codage sécurisés pour les applications Web  Les applications Web sont vulnérables à plusieurs risques de sécurité tels que les scripts intersites, l'injection SQL et l'injection de commandes. Les développeurs doivent **suivre les pratiques de codage sécurisé** telles que la validation des entrées, le codage des sorties et les requêtes paramétrées pour s'assurer que les applications Web sont sécurisées.  Par exemple, lors de l'écriture de requêtes SQL, utilisez des **requêtes paramétrées** au lieu de concaténer l'entrée de l'utilisateur avec la requête. Les requêtes paramétrées empêchent les attaques par injection SQL en traitant les entrées utilisateur comme des données plutôt que comme du code exécutable.  Les développeurs doivent également **valider toutes les entrées utilisateur**, encoder la sortie et utiliser HTTPS pour chiffrer les données transmises sur le réseau.  ## Normes de codage sécurisé pour les frameworks Python  Les frameworks Python tels que [Django](https://www.djangoproject.com/) et [Flask](https://flask.palletsprojects.com/) ont leurs standards de codage sécurisés. Les développeurs doivent suivre ces normes lors du développement d'applications utilisant ces frameworks. Voici quelques standards de codage sécurisés pour les frameworks Python :  ### 1. [Django](https://www.djangoproject.com/)  [Django](https://www.djangoproject.com/) est un framework Web populaire pour Python. Voici quelques normes de codage sécurisés pour [Django](https://www.djangoproject.com/) :  - Utilisez le **système d'authentification** intégré de [Django](https://www.djangoproject.com/) au lieu de créer un système d'authentification personnalisé. - Utilisez les **fonctions de hachage de mot de passe** intégrées de [Django](https://www.djangoproject.com/) au lieu de créer des méthodes de hachage de mot de passe personnalisées. - Utilisez le **système de modèles** de [Django](https://www.djangoproject.com/) pour vous assurer que la sortie est sécurisée et exempte de vulnérabilités de script intersite.  Par exemple, pour utiliser la fonction de hachage de mot de passe intégré de [Django](https://www.djangoproject.com/), utilisez la fonction `make_password()` du module `django.contrib.auth.hashers` .   ### 2. [Fiole](https://flask.palletsprojects.com/) [Flask](https://flask.palletsprojects.com/) est un micro framework web pour Python. Voici quelques normes de codage sécurisés pour [Flask](https://flask.palletsprojects.com/) :  - Utilisez le **système de gestion de session** intégré de [Flask](https://flask.palletsprojects.com/) pour garantir une gestion sécurisée des sessions. - Utilisez la bibliothèque [`MarkupSafe`](https://pypi.org/project/MarkupSafe/) de [Flask](https://flask.palletsprojects.com/) pour vous assurer que la sortie est sécurisée et exempte de croisement -vulnérabilités de script de site. - Utilisez la bibliothèque [`WTForms`](https://pypi.org/project/WTForms/) de [Flask](https://flask.palletsprojects.com/) pour gérer la validation des entrées utilisateur et vous assurer que l'entrée est libre contre les risques de sécurité. - Utilisez la bibliothèque [`Blinker`](https://pypi.org/project/blinker/) de [Flask](https://flask.palletsprojects.com/) pour une gestion sécurisée du signal.  Par exemple, pour utiliser la bibliothèque [`MarkupSafe`](https://pypi.org/project/MarkupSafe/) de [Flask](https://flask.palletsprojects.com/), importez-la et utilisez-la pour éviter les balises HTML de la sortie. ______  ## À l'aide de vos connaissances et que faire maintenant ?  1. **Commencez à mettre en œuvre ces bonnes pratiques dans votre code Python dès aujourd'hui** pour minimiser le risque de failles de sécurité et protéger les données sensibles. Vous pouvez commencer par identifier les zones de votre code susceptibles de présenter des risques de sécurité, telles que la validation des entrées, le hachage du mot de passe et la gestion des sessions. Vous pouvez ensuite mettre en œuvre les meilleures pratiques comme celles décrites dans cet article pour sécuriser votre code. Par exemple, vous pouvez utiliser les expressions régulières intégrées de Python pour valider l'entrée de l'utilisateur ou utiliser une bibliothèque de hachage de mot de passe sécurisé comme [`bcrypt`](https://pypi.org/project/bcrypt /).  2. **Examinez votre base de code manquante pour détecter d'éventuelles failles de sécurité** et utilisez des analyseurs de code statiques tels que [`bandit`](https://pypi.org/project/bandit/), [ `Pylint`](https://pypi.org/project/pylint/) et [`Pyflakes`](https://pypi.org/project/pyflakes/) pour détecter et résoudre tout problème. Vous pouvez également utiliser la révision manuelle du code pour identifier les problèmes de sécurité que les analyseurs de code statiques peuvent ne pas détecter. Recherchez les vulnérabilités courantes telles que l'injection SQL, les scripts intersites et les problèmes de validation des entrées. Une fois que vous avez identifié les vulnérabilités de sécurité potentielles, vous pouvez utiliser les meilleures pratiques pour résoudre les problèmes.  3. **Restez à jour avec les dernières meilleures pratiques et outils de sécurité** pour vous assurer que votre code reste sécurisé et exempt de vulnérabilités. Suivez les blogs de sécurité, assistez aux conférences et participez aux communautés en ligne pour vous tenir au courant des dernières tendances et pratiques en matière de sécurité. Gardez vos bibliothèques et frameworks à jour pour vous assurer que vous utilisez les dernières versions sécurisées.  4. **Rejoignez des communautés en ligne et assistez à des événements** où vous pourrez apprendre des experts et d'autres développeurs sur les pratiques de codage sécurisé pour Python. Recherchez des communautés et des forums en ligne où vous pouvez discuter des problèmes de sécurité avec d'autres développeurs, découvrir les nouvelles tendances en matière de sécurité et partager vos propres connaissances. Assistez à des événements tels que des conférences, des webinaires et des rencontres pour apprendre des experts en sécurité et d'autres développeurs.  5. **Partagez ces bonnes pratiques avec votre équipe ou vos collègues** pour promouvoir une culture de sensibilisation à la sécurité et encourager les autres à adopter des pratiques de codage sécurisés dans leurs projets Python. Organisez des sessions de formation à la sécurité, partagez des articles et des ressources sur les pratiques de codage sécurisé et montrez l'exemple en œuvre ces meilleures pratiques dans votre propre code. En promouvant une culture de sensibilisation à la sécurité, vous pouvez contribuer à garantir que le code de votre équipe est sécurisé et exempt de vulnérabilités.   ## Conclusion  Les normes de codage sécurisé sont essentielles pour garantir que le code est sécurisé, fiable et exempt de vulnérabilités. Python est un langage de programmation populaire qui oblige les développeurs à suivre les normes de codage sécurisées pour prévenir les risques de sécurité. En suivant les meilleures pratiques telles que la validation des entrées, en évitant les fonctions dangereuses, en utilisant des bibliothèques de cryptographie et en gardant les bibliothèques et les frameworks à jour, les développeurs peuvent s'assurer que leur code est sécurisé et exempt de vulnérabilités . Lors de l'utilisation des frameworks Python, les développeurs doivent suivre les normes de codage sécurisées recommandées par le framework.  L'adoption des normes de codage sécurisées est un processus continu qui oblige les développeurs à rester à jour avec les dernières meilleures pratiques et outils de sécurité. En intégrant des normes de codage sécurisées dans le processus de développement, les développeurs peuvent minimiser le risque de failles de sécurité et protéger les données sensibles. 