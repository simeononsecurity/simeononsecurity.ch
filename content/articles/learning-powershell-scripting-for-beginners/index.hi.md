---
title: "PowerShell Scripting para principiantes: Guía paso a paso"
draft: false
toc: true
date: 2023-02-25
descripción: "Aprende los conceptos básicos de PowerShell scripting y empieza con la automatización usando esta guía paso a paso."
tags: ["PowerShell", "scripting", "Windows", "automatización", "cmdlets", "módulos", "bucles", "sentencias condicionales", "funciones", "buenas prácticas", "depuración", "pruebas", "variables", "PowerShell ISE", "PowerShell Remoting", "tecnologías Microsoft", "informática", "gestión informática", "codificación", "tareas administrativas"].
cover: "/img/cover/A_cartoon_character_holding_a_script_and_standing.png"
coverAlt: "Un personaje de dibujos animados sosteniendo un script y de pie frente a un ordenador con el prompt de PowerShell, indicando facilidad en el scripting de PowerShell para principiantes"
coverCaption: ""
---
```powershell
Get-Module
```
``powershell
Get-Command -Module <nombre del módulo>
```
``powershell
Get-Help <nombre del cmdlet>
```
``powershell
Obtener alias
```
``powershell
$nombre_variable = valor
```
``powershell
$nombre = "Juan"
```
``powershell
for($i=1; $i -le 5; $i++) {
Write-Host $i
}
```
``powershell
$número = 10
if ($número -gt 5) {
    Write-Host "El número es mayor que 5"
}
```
```powershell
function Añadir-Números {
    param (
        [int]$num1,
        [int]$num2
    )
    $resultado = $num1 + $num2
    devolver $resultado
}

$resultado = Suma-Números -num1 5 -num2 10
Write-Host "El resultado es $resultado"
```
```powershell
   Enable-PSRemoting -Force
```
``powershell
Set-Item wsman:\localhost\Client\TrustedHosts -Value <nombredelordenador> -Force
```
``powershell
Reiniciar servicio WinRM
```
``powershell
Invoke-Command -ComputerName <nombre del equipo> -ScriptBlock { <command> }
```
``powershell
Install-Module <nombre del módulo>
```
``powershell
Get-InstalledModule
```
``powershell
try {
    # algún código que pueda dar error
}
catch {
    Write-Error "Se ha producido un error: $_"
}
```
```powershell
Describe "Mi Script PowerShell" {
    "Hace algo" {
        # algo de código que debería devolver el resultado esperado
        $result = Hace-Algo
        $resultado | Debería -Ser "resultado esperado"
    }
}
```
```powershell
function Get-ProcessCount {
    $procesos = Get-Proceso
    $cuenta = $procesos.Cuenta
    return $cuenta
}

$count = Get-ProcessCount
Write-Host "Hay $count procesos en ejecución".
```
```powershell
param (
    [cadena]$nombre
)

Write-Host "¡Hola, $nombre!"
```
```powershell
function Get-ProcessCount {
    Write-Verbose "Obteniendo procesos..."
    $procesos = Obtener-Procesos
    $cuenta = $procesos.Cuenta
    return $cuenta
}

$count = Get-ProcessCount -Verbose
Write-Host "Hay $count procesos en ejecución".
```

  **शुरुआती लोगों के लिए PowerShell स्क्रिप्टिंग लर्निग** PowerShell Microsoft द्वारा एक शक्तिशाली कमांड-लाइन शेल और स्क्रिप्टिंग भाषा विकसित की गई है। यह विंडोज ऑपरेटिंग सिस्टम और अन्य माइक्रोसॉफ़्ट के निचले हिस्से को आपके और चालू रहने के लिए कमांड और सुविधा की एक विस्तृत श्रृंखला प्रदान करता है। इस लेख में, हम नौसिखियों के लिए पॉवरशेल स्क्रिप्टिंग की मूल बातें शामिल करेंगे और आरंभ करने के लिए चरण-दर-चरण विकल्प प्रदान करेंगे। ## PowerShell का परिचय PowerShell एक कमांड-लाइन शेल है जो ऑपरेटिंग सिस्टम और अन्य Microsoft तकनीकों को चालू करता है और आपको बनाने में सक्षम है। यह कमांड और सुविधा का एक व्यापक सेट प्रदान करता है जो उपयोगकर्ता दस्तावेज़ और निर्देशिकाएं, नेटवर्क फॉर्मेक्स और सिस्टम जैसे विभिन्न जम्पर कार्य करने में सक्षम हैं। PowerShell एक स्क्रिप्टिंग भाषा का भी समर्थन करता है जो जटिल उपयोगकर्ता स्क्रिप्ट बनाने और विभिन्न दर्ज करने वाले कार्यों को सक्रिय करने की अनुमति देता है। ## PowerShell के साथ शुरू करना ### PowerShell की स्थापना PowerShell विंडोज ऑपरेटिंग सिस्टम के सबसे पहले संस्करणों में सबसे पहले आती है। हालाँकि, यदि आप Windows के पुराने संस्करण का उपयोग कर रहे हैं या यदि आपको PowerShell के नए संस्करण की आवश्यकता है, तो आप इसे Microsoft वेबसाइट से डाउनलोड कर सकते हैं। PowerShell को डाउनलोड करें और डाउनलोड करने के लिए, ये चरण खुलते हैं: 1. [Microsoft PowerShell वेबसाइट](https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell -7.2) पर जाएं और PowerShell का वह संस्करण चुनें जिसे आप बनाना चाहते हैं। 2. स्थापना फ़ाइल डाउनलोड करें और इसे चला जाता है। 3. Microsoft PowerShell. स्थापना प्रक्रिया को पूरा करने के लिए अस्पष्ट निर्देशों का पालन करें। ### पावरशेल एक बार शुरू करना शुरू करें जब आप पावरशेल को स्थापित करें, तो आप इन चरणों को चेज़ करके इसे शुरू कर सकते हैं: 1. स्टार्ट मेन्यू पर क्लिक करें और सर्च बार में "पॉवरशेल" टाइप करें। 2. "Windows PowerShell" को जानें। 3. पावरशेल एक नए विंडो में खुलेगा। ### पावरशेल मूल बातें PowerShell एक कमांड-लाइन छाया प्रदान करता है जो उपयोगकर्ता को ऑपरेटिंग सिस्टम के साथ इंटरैक्ट करने की अनुमति देता है। PowerShell में कमांड को cmdlets कहा जाता है और वे मॉड्यूल में व्यवस्थित होते हैं। सत्र की सूची देखने के लिए, गेट-माइमर कमांडर का उपयोग करें: सत्र में cmdlets की सूची देखने के लिए, उपलब्ध गेट-कमांड कमांड का उपयोग करें: किसी cmdlet पर सहायता प्राप्त करने के लिए, गेट-हेल्प कमांड का उपयोग करें: PowerShell उपनामों का भी समर्थन करता है, जो cmdlets के लिए छोटे नाम हैं। उपयुक्त उपनामों की सूची देखने के लिए, गेट-अलियास कमांड का उपयोग करें: ### पावरशेल स्क्रिप्टिंग पावरशेल स्क्रिप्टिंग एक महत्वपूर्ण विशेषता है जो उपयोगकर्ता को विभिन्न संयोजन कार्य सक्रिय करती है। PowerShell स्क्रिप्ट चर, दोहराए गए कथन और दृष्टिकोण का समर्थन करता है, जिससे कई के लिए एक शक्तिशाली उपकरण बन जाता है। #### चर चर का उपयोग PowerShell स्क्रिप्ट में डेटा संग्रह करने के लिए किया जाता है। PowerShell में एक डॉलर चिह्न ($) से शुरू होते हैं। एक चर के लिए मान निर्दिष्ट करने के लिए, निम्नलिखित सिंटेक्स का उपयोग करें: उदाहरण के लिए: #### चार्ज निर्दिष्ट का उपयोग कोड के एक ब्लॉक को एक निश्चित संख्या में प्राप्त करने के लिए किया जाता है। PowerShell किसी भी प्रकार के नुकसान का समर्थन करता है: जिम्मेवार के लिए **: एक विशिष्ट संख्या के लिए कोड के एक ब्लॉक को दोहराता है। - **जबकि जिम्मेदार**: कोड के एक ब्लॉक को तब तक दोहराता है जब तक कोई शर्त सत्य है। - **डू-वैली जोखिम**: कम से कम एक बार कोड के ब्लॉक को डबलता है और तब तक डबलता है जब तक कोई शर्त सत्य है। - **या प्रत्येक संग्रह**: संग्रह में प्रत्येक वस्तु के लिए कोड का एक ब्लॉक डबलता है। उदाहरण के लिए, एक कोड 1 से 5 तक की संख्या को प्रिंट करने के लिए जमा करने के लिए घोषणा करता है: #### स्वीकार करता है कि कंजेशन घटा हुआ उपयोग कोड के एक ब्लॉक को कार्रवाई करने के लिए यदि कोई निश्चित है स्थिति सत्य है। PowerShell कुछ प्रकार के कथित बयानों का समर्थन करता है: - **Declaración If**: यदि कोई शर्त सही है तो कोड के एक ब्लॉक को निष्पादित करता है। - **अगर-अन्यथा कथन**: यदि कोई शर्त सही है तो कोड का एक ब्लॉक निष्पादित करता है, और यदि स्थिति गलत है तो कोड का एक और ब्लॉक निष्पादित करता है। - **स्विच ग्राह्य**: बीज मैचों के एक सेट के साथ एक मान की तुलना करता है और पहले मिले मैच के लिए कोड के एक ब्लॉक को निष्पादित करता है। उदाहरण के लिए, यदि कोई संख्या 5 से अधिक है, तो यह संक्षिप्त विवरण के लिए एक कोड एक है यदि कोई त्रुटि का उपयोग करता है: #### कार्य कोड के पुन: रचना खंड हैं जो एक विशिष्ट कार्य करते हैं। कार्य देखें। PowerShell निम्न प्रकार के कार्यों का समर्थन करता है: - **संचय ब्लॉक**: कोड का एक ब्लॉक जिसे क्रियान्वित किया जा सकता है। - **उन्नत निष्कर्ष**: एक समावेशन जिसमें मेटाडेटा और सत्यापन शामिल है। उदाहरण के लिए, एक कोड एक गाइड की परिभाषा जो दो नंबर क्वाड है: ### पावरशेल आई हैं पावरशेल आई हैं (इंटीग्रेटेड स्क्रिप्टिंग एनवायरनमेंट) पावरशेल स्क्रिप्टिंग के लिए एक ग्राफिकल कर्मी शैडो है। PowerShell ISE एक समृद्ध पाठ संपादक, डिबगिंग टूल और अन्य सुविधाएँ प्रदान करता है जो PowerShell स्क्रिप्ट को लिखना और परीक्षण करना आसान बनाता है। PowerShell ISE खोलने के लिए, इन चरणों का पालन करें: 1. स्टार्ट मेन्यू पर क्लिक करें और सर्च बार में "PowerShell ISE" टाइप करें। 2. पुश्ते से "Windows PowerShell ISE" चुनें। 3. PowerShell ISE एन चुनें। PowerShell ISE एक नए विंडो में खुलेगा। ### पावरशेल जूनियर दूरस्थ रूप से उपयोगकर्ता कंप्यूटर पर पावरशेल कमांड और स्क्रिप्ट क्रिएट करने की अनुमति देता है। PowerShell Remoting के लिए आवश्यक है कि WinRM सेवा स्थानीय और दूरस्थ कंप्यूटर दोनों पर चल रही हो। PowerShell दूरस्थ रूप से सक्षम होने के लिए, इन चरणों में परिवर्तन: 1. एक PowerShell प्रविष्टि चिह्न के साथ व्यवस्थापकीय विशेषाधिकार। 2. पावरशेल ने सक्षम होने के लिए निर्देश दिया है: 3. दूरस्थ कंप्यूटर को विश्वसनीय होस्ट सूची में जोड़ने के लिए निम्न कमांड चलाएँ: 4. WinRM सेवा को आजाएं किसी दूरस्थ कंप्यूटर पर PowerShell कमांड चलाने के लिए, इनवोक-कमांड cmdlet का उपयोग करें: ###शेल पावर मॉड्यूल cmdlets de PowerShell, संरचना और स्क्रिप्ट के संग्रह में से उनमें से विशिष्ट कार्य करने के लिए सत्र तैयार किए गए हैं। PowerShell मॉड्यूल को PowerShell गैलरी का उपयोग करके स्थापित किया जा सकता है और आपका किया जा सकता है, जो PowerShell प्रबंधन के लिए एक केंद्रीय भंडार है। PowerShell गैलरी से PowerShell मॉड्यूल व्यवस्थित करने के लिए, विशेष आदेश का उपयोग करें: PowerShell प्रबंधन कमांड की सूची स्थापित करें, Comando Get-InstalledModule का उपयोग करें: ### PowerShell स्क्रिप्टिंग के लिए सर्वश्रेष्ठ प्रयोग PowerShell स्क्रिप्ट पंजीकरण समय, यह सुनिश्चित करें सबसे पहले पहला अच्छा प्रयोग करना महत्वपूर्ण है कि स्क्रिप्ट सुरक्षित, विश्वसनीय और बनाए रखने योग्य हैं। यहाँ कुछ श्रेष्ठतम अभ्यासों को ध्यान में रखा गया है: वर्णात्मक चर नामों का उपयोग: चर नामों का उपयोग करें जो उनके उद्देश्य को स्पष्ट रूप से विवरण करते हैं। समावेशन _COPY3 उपयोग: कोड के उद्देश्य को समझने के लिए उपयोग करें। - **एर अकाउंट का इस्तेमाल करें**: एर अकाउंट का इस्तेमाल गलती से करें और एक्सेप्शन को बेहतर तरीके से हैंडल करें। - **पूरी तरह से स्क्रिप्ट का परीक्षण करें**: यह सुनिश्चित करने के लिए स्क्रिप्ट का पूरी तरह से परीक्षण करें कि वे उम्मीद के मुताबिक काम कर रहे हैं। - **फ़ंक्शन और मॉड्यूल का उपयोग करें**: कोड रूट करें और पुन: घोषणा में सुधार करने के लिए लॉकर और मॉड्यूल का उपयोग करें। - **हार्डकोडिंग सोच से बचें**: स्क्रिप्ट में एजेंसी की हार्डकोडिंग से बचें और इसके बजाय व्यू या चर का उपयोग करें। - **वर्बोज़ समाधान का उपयोग करें**: स्क्रिप्ट की प्रगति के बारे में अतिरिक्त जानकारी प्रदान करने के लिए वर्बोज़ समाधान का उपयोग करें। ### पावरशेल स्क्रिप्टिंग के लिए बेहतरीन प्रयोग पर विस्तार #### इरेजेक्शन का उपयोग करें त्रुटि प्रबंधन PowerShell स्क्रिप्टिंग का एक महत्वपूर्ण पहलू है, क्योंकि यह सुनिश्चित करता है कि स्क्रिप्ट विश्लेषण और अपवादों को शालीनता से हैंडल करता है। PowerShell पार्टनरशिप कई तरह से प्रदान की जाती है, जिसमें ट्राई-कैच कैटलॉग, ट्रैप पैकेजिंग और इरेक्शन इमेज शामिल हैं। ट्राई-कैच अपवाद को कैच और हैंडल के लिए उपयोग किया जाता है, जबकि ट्रैप का उपयोग को कैच और हैंडल के लिए किया जाता है। ErrorAction का उपयोग इसे नियंत्रित करने के लिए किया जाता है कि आपकी स्क्रिप्ट को कैसे जाना जाता है। किसी भी त्रुटि को गहन रूप से संभालने के लिए ट्राई-कैच रिपोर्ट का उपयोग करने का एक उदाहरण यहां दिया गया है: #### परीक्षण स्क्रिप्ट पूरी तरह से PowerShell स्क्रिप्ट का परीक्षण करने के लिए सुनिश्चित करने के लिए आवश्यक है कि वे नए हों हो हो रूप में काम करें से काम करती हैं। PowerShell कई परीक्षण उपकरण और रूपरेखा प्रदान करता है, जैसे एक पेस्टर, जो स्टिकहर्ट को अपनी स्क्रिप्ट के लिए रिकॉर्ड करता है और निष्पादित करने में सक्षम होता है। ये उपकरण कोड में मुद्दों की पहचान करते हैं और उन्हें अलग करने में मदद करते हैं और यह सुनिश्चित करते हैं कि स्क्रिप्ट संबंधी आवश्यकताओं को पूरा करता है। PowerShell स्क्रिप्ट का परीक्षण करने के लिए पत्रक _COPY9 उपयोग करने एक उदाहरण यहां दिया गया है: #### दस्तावेज़ और मॉड्यूल का उपयोग करें विकल्प और मॉड्यूल कोड दर्ज करें और PowerShell स्क्रिप्टिंग में पुन: स्क्रीन करें: सुधार के लिए आवश्यक हैं। नोएडा को समूह कोड को फिर से: साइट ब्लॉक में बनाया जाता है, जबकि उपयोगकर्ता पेज के साथ कोड को पैकेज और साझा करने में सक्षम होता है। लॉकर और मॉडरेशन, PowerShell स्क्रिप्ट का उपयोग अधिक मॉड्यूलर, कुशल और बनाए रखने योग्य बनाया जा सकता है। यहां PowerShell में पासवर्ड का उपयोग करने का एक उदाहरण दिया गया है: #### रिपोर्ट की हार्डकोडिंग से PowerShell स्क्रिप्ट में उपयोगकर्ता की हार्डकोडिंग करने से बचें, यह कम गोपनीयता और बनाए रखना कठिन हो जाता है। छवि को हार्डकोड करने के बजाय छद्म या वास्तविक उपयोग का उपयोग करना सबसे अच्छा है, जो उपयोगकर्ता स्क्रिप्ट पर चयन करने में पास करने में सक्षम है। या साइन चर का प्रकार, स्क्रिप्ट को अधिक पुन: उपयोग करें: निर्दिष्ट और निर्दिष्ट के अनुकूल बनाया जा सकता है। यहाँ PowerShell में एक विवरण का उपयोग करने का एक उदाहरण है: #### वर्बोज़ ग्लूज़ वर्बोज़ ग्लू का उपयोग स्क्रिप्ट की प्रगति के बारे में अतिरिक्त जानकारी प्रदान करता है, जो डिबगिंग और समस्या निवारण के लिए उपयोगी हो सकता है। PowerShell राइट-वर्बोज़ cmdlet प्रदान करता है, जो Google को वर्बोज़ जानकारी समस्या में समस्या उत्पन्न करता है। वर्बोज़ समस्या का उपयोग करके, PowerShell स्क्रिप्ट को अधिक जानकारी पूर्ण और डिबग करने में आसान बनाया जा सकता है। यहाँ PowerShell में वर्बोज़ समस्या का उपयोग करने का एक उदाहरण दिया गया है: ### नौसिखियों के लिए दस PowerShell स्क्रिप्ट विचार - **स्वीकृत प्राथमिक**: एक ऐसी स्क्रिप्ट बनाएं जो सूक्ष्म रूपरेखा और बाहरी हार्ड में निर्देशिकाओं को बैकअप करने की प्रक्रिया ड्राइव या क्लाउड स्टोरेज सेवा को सक्रिय करता है। - ** फाइल प्रबंधन**: एक ऐसी स्क्रिप्ट बनाएं जो सेटिंग्स और निर्देशिकाओं को फाइल प्रकार, आकार या अन्य लेआउट के आधार पर अलग-अलग फ़ोल्डर में न्यूट करके न्यूट करती है। - **सिस्टम की** जानकारी: एक ऐसी स्क्रिप्ट जो सिस्टम की जानकारी बनाती है, जैसे सीपीयू और मेमोरी उपयोग, डिस्क स्थान और नेटवर्क कैप्चर को जॉइंट करती है, और इसे रीडिंग में आसान ड्राफ्ट में चित्रित करती है। - ** पर्यावरण प्रबंधन**: एक ऐसी स्क्रिप्ट बनाएं जो विंडोज ऑपरेटिंग सिस्टम में उपयोगकर्ता और विज्ञापनों को जोड़ते, सक्रिय करने या हटाने की प्रक्रिया को सक्रिय करती है। - **सॉफ़्टवेयर**: एक ऐसी स्क्रिप्ट क्रिएट होती है जो एक साथ कई कंप्यूटरों पर दर्ज करती है और व्यंजक करती है, जिससे समय और प्रयास की बचत होती है। - **नेटवर्क**: एक ऐसी स्क्रिप्ट क्रिएट जो नेटवर्क कैप्चर को जहर करने की प्रक्रिया को स्वचालित करती है, जैसे IP पता, सबनेट मास्क और डिफ़ॉल्ट फाइल। - **सुरक्षा**: एक स्क्रिप्ट जो सुरक्षा कैप्चर का अधिलेखित करती है और निगरानी करती है और किसी भी तरह का बदलाव का रास्ता पर उपयोगकर्ता को सक्रिय करती है। - **टास्क शेड्यूलिंग**: एक स्क्रिप्ट बनाएं जो बैकअप, अपडेट और सिस्टम स्कैन जैसे पुनरावर्ती कार्यों को कार्य करता है और सक्रिय करता है। - **रजिस्ट्री हेराफेरी**: एक स्क्रिप्ट जो विशिष्ट प्राथमिकताओं या अनुमानों के लिए धारणा को सुसंगत या समान करती है। - **रिमोट एडमिनिस्ट्रेशन**: एक स्क्रिप्ट क्रिएट जो विंडोज कंप्यूटर के संबंध में एडमिनिस्ट्रेशन को कर सकती है, जिससे उपयोगकर्ता प्राधिकरण पर कमांड और स्क्रिप्ट को निष्पादित कर सकते हैं। ## निष्कर्ष विंडोज ऑपरेटिंग सिस्टम और अन्य माइक्रोसॉफ्ट तकनीकों के प्रबंधन और संसाधनों के लिए PowerShell एक शक्तिशाली उपकरण है। इस लेख में, हमने शुरुआती लोगों के लिए PowerShell स्क्रिप्टिंग की मूल बातें की हैं, जिनमें PowerShell को स्थापित करना और शुरू करना, cmdlets, चर, शामिल होना, धब्बेदार कथन और दृष्टिकोण का उपयोग करना और PowerShell ISE, PowerShell Remoting और PowerShell मॉड्यूल का उपयोग करना उपयोग करना शामिल है। मानदंड के पालन करके, PowerShell स्क्रिप्ट सुरक्षित, विश्वसनीय और बनाए रखने योग्य हो सकते हैं। अभ्यास के साथ, आप PowerShell स्क्रिप्टिंग में कुशल बन सकते हैं और विभिन्न कार्य आसानी से सक्रिय कर सकते हैं।