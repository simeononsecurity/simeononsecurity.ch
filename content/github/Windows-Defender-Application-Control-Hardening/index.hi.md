---
title: 'Complete Guide to Harden Windows with Windows Defender Application Control (WDAC)'
date: 2020-12-16
toc: true
draft: false
description: "Learn how to use Windows Defender Application Control (WDAC) to harden your Windows operating system with scripts and tools."
tags: ["Windows Defender Application Control (WDAC) Hardening", "PowerShell", "PowerShell Script", "Automation", "Compliance", "Blue-Team", "Windows Defender STIG Script", "Windows Defender Hardening", "Windows Defender STIG", "Defender STIG", "Windows Defender Exploit Protection (WDEP)", "Windows Defender Attack Surface Reduction (ASR)", "Windows Server 2016/2019", "Windows Server Core", "Microsoft WDAC-Toolkit", "Refresh CI Policy", "Microsoft Recommended block rules", "Microsoft Recommended driver block rules", "XML policies", "BIN policies", "Group Policy", "Microsoft Intune"]
---
```powershell
$PolicyPath = "C:\temp\Windows Defender\CIP\WDAC_V1_Recommended_Enforced\*.cip"
#https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deployment/deploy-wdac-policies-with-script
ForEach ($Policy in (Get-ChildItem -Recurse $PolicyPath).Fullname) {
  $PolicyBinary = "$Policy"
  $DestinationFolder = $env:windir+"\System32\CodeIntegrity\CIPolicies\Active\"
  $RefreshPolicyTool = "./Files/EXECUTABLES/RefreshPolicy(AMD64).exe"
  Copy-Item -Path $PolicyBinary -Destination $DestinationFolder -Force
  & $RefreshPolicyTool
}
```
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
Get-ChildItem -Recurse *.ps1 | Unblock-File
.\sos-wdachardening.ps1
```

 विंडोज कंप्यूटर कंट्रोल (WDAC) के साथ हार्डन विंडोज  ## सुचना: - विंडोज सर्वर 2016/2019 या संस्करण 1903 से पहले कुछ भी एक ही समय में केवल एक ही विरासत नीति का समर्थन करता है। - विंडोज सर्वर कोर संस्करण डी एसे का समर्थन करता है लेकिन ऐप लॉकर पर चिपका हुआ कुछ घटक काम नहीं करेगा - कृपया लागू करें या परीक्षण करने से पहले [अनुशंसित पठान] पढ़ें।  ## इस संग्रह द्वारा उपयोग की जाने वाली स्क्रिप्ट और टूल की सूची:  - [MicrosoftDocs - WDAC-Toolkit](https://github.com/MicrosoftDocs/WDAC-Toolkit) - [Microsoft - सीआई नीति ताज़ा करें](https://www.microsoft.com/en-us/download/details.aspx?id=102925)  ## अतिरिक्त विस्तार पर विचार किया गया:  - [माइक्रोसॉफ्ट - सुधार ब्लॉक नियम] - [माइक्रोसॉफ्ट - खराब ड्राइवर ब्लॉक नियम] - [माइक्रोसॉफ्ट - विनोद लाइसेस कंट्रोल] निर्देश)  ## व्याख्या:  ### यांत्रिकी बनाम रोलिंग:  - सीधे शब्दों में कहें, तो **"XML"** घना मशीन पर स्थानीय रूप से लागू करने के लिए हैं और **"BIN"** फ़ाइलें उन्हें [समूह नीति](https://docs.microsoft.com) के साथ लागू करने के लिए हैं /en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-use-group-policy) या [Microsoft Intune ](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control-policies-use-intune)। जब आप किसी स्थानीय परिनियोजन में XML, BIN, या CIP का उपयोग कर सकते हैं, तो आम तौर पर जहां संभव हो, आपको XML से विज्ञापन दिखाना चाहिए और विशेष रूप से समस्या या समस्या का खुलासा करना चाहिए।  ### नीति विवरण:  - **डिफॉल्ट प्रजनक:**   - "डिफॉल्ट" नेटवर्क केवल डब्लूडीआईएस-टूलकिट में उपलब्ध चूक सुविधा का उपयोग करता है। - **अनुशंसित प्रचार:**   - "अनुशंसित" फिक्स सिस्टम के साथ-साथ Microsoft की सूचना [ब्लॉक] का उपयोग करती हैं -अनुशंसित-ब्लॉक-नियम) और [ड्राइवर ब्लॉक] -ड्राइवर-ब्लॉक -नियम) नियम। - **ऑडिट अलाट:**   - "ऑडिट" देख रहे हैं, केवल आशंका के अपवाद होंगे। यह आपकी सहमति के लिए परीक्षण के लिए है, ताकि आप अपनी सहमति की आवश्यकताओं के अनुकूल होने के लिए उपलब्ध हों। - **लागू प्रचार:**   - "लागू" रैप्टर्स को किसी भी अपवाद की अनुमति नहीं देंगे, अगर वे संपर्क नहीं करते हैं, तो Apple, ड्राइवर, डीएलएस आदि को ब्लॉक कर दिया जाएगा।  ### ऑफर ऑफर:  - **एक्स कॉलेज:**   - **केवल अपकार:**     - `WDAC_V1_Default_Audit_{संस्करण}.xml`     - `WDAC_V1_अनुशंसित_ऑडिट_{संस्करण}.xml`   - **लागू:**     - `WDAC_V1_Default_Enforced_{संस्करण}.xml`     - `WDAC_V1_अनुशंसित_प्रवर्तित_{संस्करण}.xml` - **बिन:**   - **केवल अपकार:**     - `WDAC_V1_Default_Audit_{संस्करण}.बिन`     - `WDAC_V1_अनुशंसित_ऑडिट_{संस्करण}.बिन`   - **लागू:**     - `WDAC_V1_Default_Enforced_{संस्करण}.बिन`     - `WDAC_V1_अनुशंसित_प्रवर्तित_{संस्करण}.बिन` - **सीआईपी:**   - **केवल अपकार:**     - `WDAC_V1_Default_Audit\{uid}.cip`     - `WDAC_V1_अनुशंसित_ऑडिट\{uid}.cip`   - **लागू:**     - `WDAC_V1_Default_Enforced\{uid}.cip`     - `WDAC_V1_अनुशंसित_प्रवर्तित\{uid}.cip`  आप स्थानीय रूप से जो नीति चाहते हैं, उसका उपयोग करने के लिए स्क्रिप्ट में इसकी पंक्ति को अपडेट करें:   वैकल्पिक रूप से, आप [समूह नीति](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender-application-control- लेटर-यूजिंग-ग्रुप-पॉलिसी) या [माइक्रोसॉफ्ट इंट्यून](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-windows-defender- application-control-polices-use-intune) WDAC को लागू करने के लिए।  ## आफत करना:  आप नीचे इवेंट व्यूअर में WDAC इवेंट देख सकते हैं:  `अनुप्रयोग और सेवाएँ \ Microsoft \ Windows \ CodeIntegrity \ Operational`  ## सुधार पाठ:  - [Argonsys - Windows 10 एप नियंत्रण नीति योजना बनाना](https://argonsys.com/microsoft-cloud/library/deploying-windows-10-application-control-policy/) - [Microsoft - Windows डिफ़ेंडर का नियंत्रण दुर्घटना का शिकार हो जाएगा] application- control-नीतियां) - [Microsoft - एक संदर्भ कंप्यूटर का उपयोग करके फिक्स्ड-वर्कलोड डिवाइस के लिए WDAC नीति बनाएं](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control /रचना -प्रारंभिक-डिफॉल्ट-नीति) - [Microsoft - समूह नीति का उपयोग करके Windows डिफ़ेंडर एप नियंत्रण एक परियोजन तैयार करें](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy - विंडोज़- एससी-आवेदन- नियंत्रण-नीतियां- उपयोग-समूह-नीति) - [Microsoft - Microsoft Intune का उपयोग करके Windows डिफ़ेंडर ऐप नियंत्रण नियंत्रण योजना बनाएं](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy- अशुद्ध- एससी-एप्लीकेशन-नियंत्रक-पॉलिसी-यूजिंग-इंट्यून) - [Microsoft - स्क्रिप्ट का उपयोग करके WDAC सूचना अभ्यस्त करें](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deployment/deploy-wdac- Policies-with -लिखी हुई कहानी) - [Microsoft - Windows Defencer ऐप नियंत्रण नियंत्रण लागू करें](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/enforce-windows-defender-application - नियंत्रण-नीतियां) - [Microsoft - WDAC निषेध बनाने पर समर्थन] - [माइक्रोसॉफ्ट - कई विंडोज़ प्रोटेक्ट्स एक्ट कंट्रोल का उपयोग करें] -आवेदन-नियंत्रण-नीतियां)  ## स्क्रिप्ट कैसे चलाएं:  ### मैनुअल रिकॉर्ड करें:  यदि कोई किसी से डाउनलोड किया गया है, तो स्क्रिप्ट को [GitHub रिपॉजिटरी] (https://github.com/simeononsecurity/Windows-Defender-Application-Control-Hardening/archive/main) की सभी दस्तावेज़ निर्देशिकाओं में एक प्रत्यक्ष फ़ाइल से लॉन्च किया गया। फ़्रैंक) 