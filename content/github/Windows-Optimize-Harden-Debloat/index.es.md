---
title: "Optimize and Harden Your Windows System with the Windows-Optimize-Harden-Debloat Script"
date: 2020-12-29
toc: true
draft: false
description: "This comprehensive guide provides step-by-step instructions on how to optimize, harden, and debloat your Windows system for improved performance, security, and privacy."
tags: ["Windows optimization", "Windows hardening", "Windows debloating", "Windows security", "Windows performance", "Windows privacy", "Windows updates", "Group Policy Objects", "Adobe Acrobat Reader", "Firefox", "Google Chrome", "Internet Explorer", "Microsoft Chromium Edge", "Dot Net 4", "Microsoft Office", "Onedrive", "Oracle Java JRE 8", "Windows Firewall", "Windows Defender", "Applocker"]
---
```powershell
iwr -useb 'https://simeononsecurity.ch/scripts/windowsoptimizeandharden.ps1'|iex
```
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
Get-ChildItem -Recurse *.ps1 | Unblock-File
powershell.exe -ExecutionPolicy ByPass -File .\sos-optimize-windows.ps1 -cleargpos:$false -installupdates:$false
```

## Introducción: Windows 10 y Windows 11 son sistemas operativos invasivos e inseguros listos para usar. Organizaciones como [PrivacyTools.io](https://PrivacyTools.io), [Microsoft](https://microsoft.com), [Cyber.mil](https://public.cyber.mil), el [Departamento of Defense](https://dod.gov), y la [Agencia de Seguridad Nacional](https://www.nsa.gov/) han recomendado cambios de configuración para bloquear, fortalecer y asegurar el sistema operativo. Estos cambios cubren una amplia gama de mitigaciones, incluido el bloqueo de telemetría, macros, la eliminación de bloatware y la prevención de muchos ataques digitales y físicos en un sistema. Este script tiene como objetivo automatizar las configuraciones recomendadas por esas organizaciones. ## Notas, advertencias y consideraciones: **ADVERTENCIA:** Este script debería funcionar para la mayoría de los sistemas, si no todos, sin problemas. Si bien [@SimeonOnSecurity](https://github.com/simeononsecurity) crea, revisa y prueba cada repositorio de forma intensiva, no podemos probar todas las configuraciones posibles ni [@SimeonOnSecurity](https://github.com/simeononsecurity ) no asume ninguna responsabilidad por romper su sistema. Si algo sale mal, prepárate para enviar un [problema](../../problemas). - Este script está diseñado para funcionar principalmente en entornos de **Uso personal**. Con eso en mente, ciertas opciones de configuración empresarial no están implementadas. Este script no está diseñado para llevar a cabo un sistema al 100% de cumplimiento. Más bien, debe usar como un trampolín para completar la mayoría, si no todos, los cambios de configuración que se pueden programar mientras se saltan problemas pasados como la marca y los banners que no deben implementarse incluso en un entorno de uso personal reforzado. - Este script está diseñado de tal manera que las optimizaciones, a diferencia de otros scripts, no interrumpirán la funcionalidad principal de Windows. - Funciones como Windows Update, Windows Defender, Windows Store y Cortona se han restringido, pero no se encuentran en un estado disfuncional como la mayoría de los otros scripts de privacidad de Windows 10. - Si busca una secuencia de comandos minimizada dirigida solo a entornos comerciales, consulte este [repositorio de GitHub] (https://github.com/simeononsecurity/Standalone-Windows-STIG-Script) ** No ejecuta esta secuencia de comandos si no lo hace. No entiendo lo que hace. Es su responsabilidad revisar y probar el guión antes de ejecutarlo.** **POR EJEMPLO, LO SIGUIENTE SE ROMPERÁ SI EJECUTA ESTO SIN TOMAR MEDIDAS PREVENTIVAS:** - El uso de la cuenta de administrador predeterminado denominado &quot;Administrador&quot; está deshabilitado y renombrado según DoD STIG: no se aplica a la cuenta predeterminada creada, pero sí se aplica al uso de la cuenta de administrador predeterminado que se encuentra a menudo en las versiones Enterprise, IOT y Windows Server. Cree una nueva cuenta en Administración de computadoras y configúrela como administrador si lo desea. Luego, copie el contenido de la carpeta de usuarios anteriores en la nueva después de iniciar sesión en el nuevo usuario por primera vez para solucionar esto antes de ejecutar el script. - El inicio de sesión con una cuenta de Microsoft está deshabilitado por DoD STIG. - Cuando intente ser seguro y privado, no se recomienda iniciar sesión en su cuenta local a través de una cuenta de Microsoft. Esto se aplica mediante este repositorio. - Cree una nueva cuenta en Administración de equipos y configúrela como administrador si lo desea. Luego, copie el contenido de la carpeta de usuarios anteriores en la nueva después de iniciar sesión en el nuevo usuario por primera vez para solucionar esto antes de ejecutar el script. - Los PIN de la cuenta están deshabilitados por DoD STIG - Los PIN son inseguros cuando se usan únicamente en lugar de una contraseña y se pueden eludir fácilmente en cuestión de horas o incluso segundos o minutos - Eliminar el PIN de la cuenta y/o iniciar sesión con la contraseña después de ejecutar el script. - Los valores predeterminados de Bitlocker se cambiaron y soportaron debido a DoD STIG. - Debido a cómo se implementa BitLocker, cuando se producen estos cambios y si ya tiene habilitado BitLocker, se romperá la implementación de BitLocker. - Deshabilite BitLocker, ejecute el script y luego vuelva a habilitar BitLocker para solucionar este problema. ## Requisitos: - [x] Windows 10/11 Enterprise (**Preferido**) o Professional - Las ediciones de Windows 10/11 Home no mostraron configuraciones de GPO y no se han probado. - Las ediciones de la ventana &quot;N&quot; no se prueban. - [x] [Estándares](https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-highly-secure) para un dispositivo Windows 10 altamente seguro - [x] Sistema está [completamente actualizado y es compatible](https://support.microsoft.com/en-gb/help/4027667/windows-10-update) - Ejecute el [Asistente de actualización de Windows](https://support. microsoft .com/en-us/help/3159635/windows-10-update-assistant) para actualizar y verificar la versión principal más reciente. - [x] Bitlocker debe suspenderse o apagarse antes de implementar este script, se puede volver a habilitar después de reiniciar. - Las ejecuciones de seguimiento de este script se pueden ejecutar sin deshabilitar BitLocker. - [x] Requisitos de hardware - [Requisitos de hardware para la integridad de la memoria](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/requirements-and- deployment-planning-guidelines -for-virtualization-based-protection-of-code-integrity#baseline-protections) - [Requisitos de hardware para seguridad basada en virtualización](https://docs.microsoft.com/en-us/ windows-hardware/design/ device-experiences/oem-vbs) - [Requisitos de hardware para Windows Defender Application Guard](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows- defender-application-guard/reqs -wd-app-guard) - [Requisitos de hardware para Credential Guard de Windows Defender](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential -guard/credential-guard-requirements) ## Material de lectura recomendado: - [Lanzamiento seguro de System Guard](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender -system-guard/system-guard-secure-launch-and-smm-protection#requirements-met-by-system-guard-enabled-machines) - [Raíz de confianza de System Guard](https://docs.microsoft .com/es-es/windows/security/threat-protection/windows-defender-system-guard/system-guard-how-hardware-based-root-of-trust-helps-protect-windows) - [Aislamiento basado en hardware](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/overview-hardware-based-isolation) - [Integridad de la memoria](https:/ /docs.microsoft.com/en-us/windows/security /threat-protection/device-guard/memory-integrity) - [Protección de aplicaciones de Windows Defender](https://docs.microsoft.com/en-us /windows/security/threat-protection/windows-defender-application-guard /wd-app-guard-overview) - [Protección de credenciales de Windows Defender](https://docs.microsoft.com/en-us/windows /security /identity-protection/credential-guard/credential-guard-how-it -works) ## Adiciones, cambios notables y correcciones de errores: **Este script agrega, elimina y cambia la configuración de su sistema. Revise el script antes de ejecutarlo.** ### Navegadores: - Los navegadores tendrán extensiones adicionales instaladas para ayudar en la privacidad y la seguridad. - Consulte [aquí](https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat/issues/11) para obtener información adicional. - Debido a las STIG del Departamento de Defensa implementadas para los navegadores, se produjo la administración de extensiones y otras configuraciones empresariales. Para obtener instrucciones sobre cómo ver estas opciones, deberá consultar las instrucciones de GPO a continuación. ### Módulos Powershell: - Para ayudar a automatizar las actualizaciones de Windows, se agregará a su sistema el módulo PowerShell [PSWindowsUpdate](https://www.powershellgallery.com/packages/PSWindowsUpdate/2.0.0.4). ### Corrección de la cuenta de Microsoft, la tienda o los servicios de Xbox: esto se debe a que bloqueamos el inicio de sesión en las cuentas de Microsoft. La asociación de telemetría e identidad de Microsoft está mal vista. Sin embargo, si aún desea utilizar estos servicios, consulte los siguientes tickets de emisión para la resolución: - https://github.com/simeononsecurity/Windows-Optimize-Debloat/issues/1 - https://github.com/simeononsecurity / Windows-Optimize-Harden-Debloat/issues/16 - https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat/issues/22 ### Edición de políticas en la Política de grupo local después del hecho: si necesita modificar o cambiar una configuración, lo más probable es que se puedan configurar a través de GPO: - Importe las definiciones de la política ADMX de este [repo] (https://github.com/simeononsecurity/STIG-Compliant-Domain -Prep/tree/master/Files/ PolicyDefinitions) en _C:\windows\PolicyDefinitions_ en el sistema que intenta modificar. - Abra `gpedit.msc` en el sistema que está tratando de modificar. ## Una lista de scripts y herramientas que utiliza esta colección: ### First Party: - [.NET-STIG-Script](https://github.com/simeononsecurity/.NET-STIG-Script) - [Automate- Sysmon](https://github.com/simeononsecurity/Automate-Sysmon) - [FireFox-STIG-Script](https://github.com/simeononsecurity/FireFox-STIG-Script) - [JAVA-STIG-Script] ( https://github.com/simeononsecurity/JAVA-STIG-Script) - [Standalone-Windows-STIG-Script](https://github.com/simeononsecurity/Standalone-Windows-STIG-Script) - [Windows- Defender -STIG-Script](https://github.com/simeononsecurity/Windows-Defender-STIG-Script) - [Windows-Optimize-Debloat](https://github.com/simeononsecurity/Windows-Optimize-Debloat) # ## Terceros: - [Cyber.mil - Objetos de directiva de grupo](https://public.cyber.mil/stigs/gpo/) - [Microsoft Security Compliance Toolkit 1.0](https://www.microsoft. com/en-us/download/details.aspx?id=55319) - [Microsoft Sysinternals - Sysmon](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon) ## STIGS/SRG aplicados : - [Adobe Acrobat Pro DC continuo V2R1](https://public.cyber.mil/stigs/downloads/) - [Adobe Acrobat Reader DC continuo V2R1](https://public.cyber.mil/stigs/downloads/ ) - [Firefox V5R2](https://public.cyber.mil/stigs/downloads/) - [Google Chrome V2R4](https://public.cyber.mil/stigs/downloads/) - [Internet Explorer 11 V1R19 ]( https://public.cyber.mil/stigs/downloads/) - [Microsoft Edge V1R2](https://public.cyber.mil/stigs/downloads/) - [Microsoft .Net Framework 4 V1R9](https :/ /public.cyber.mil/stigs/downloads/) - [Microsoft Office 2013 V2R1](https://public.cyber.mil/stigs/downloads/) - [Microsoft Office 2016 V2R1](https://public .cyber .mil/stigs/downloads/) - [Microsoft Office 2019/Office 365 Pro Plus V2R3](https://public.cyber.mil/stigs/downloads/) - [Microsoft OneDrive STIG V2R1](https:// publico cyber.mil/stigs/downloads/) - [Oracle JRE 8 V1R5](https://public.cyber.mil/stigs/downloads/) - [Windows 10 V2R2](https://public.cyber.mil/ stigs /descargas/) - [Windows Defender Antivirus V2R2](https://public.cyber.mil/stigs/downloads/) - [Windows Firewall V1R7](https://public.cyber.mil/stigs/downloads/) # # Se consideraron configuraciones adicionales de: - [BuiltByBel - PrivateZilla](https://github.com/builtbybel/privatezilla) - [CERT - IE Scripting Engine Memory Corruption](https://kb.cert.org/vuls/ id /573168/) - [Dirteam - Endurecimiento de SSL](https://dirteam.com/sander/2019/07/30/howto-disable-weak-protocols-cipher-suites-and-hashing-algorithms-on- web - application-proxies-ad-fs-servers-and-windows-servers-running-azure-ad-connect/) - [MelodysTweaks - Ajustes básicos](https://sites.google.com/view/melodystweaks/basictweaks ) - [Microsoft: administración de la telemetría y las devoluciones de llamadas de Windows 10](https://docs.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components - to-microsoft-services) - [Microsoft: reduzca las superficies de ataque con reglas de reducción de superficie de ataque](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft- defender -atp/attack-surface-reduction) - [Microsoft - Reglas de bloqueo recomendadas](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/ microsoft -recommended-block-rules) - [Microsoft - Controlador recomendado reglas de bloqueo](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft - reglas-de-bloqueo-de-controladores-recomendadas) - [Microsoft - Specture y Meltdown Mitigations](https://support.microsoft.com/en-us/help/4072698/windows-server-speculative-execution-side - channel-vulnerabilities) - [Microsoft - Privacidad de Windows 10](https://docs .microsoft.com/en-us/windows/privacy/) - [Microsoft - Recomendaciones de Windows 10 VDI](https://docs . microsoft.com/ en-us/windows-server/remote/remote-desktop-services/ rds_vdi-recommendations-1909) - [Microsoft - Control de aplicaciones de Windows Defender](https://docs.microsoft.com/en- us/windows/ security/threat-protection/windows-defender-application-control/windows-defender-guía-de-diseño-de-control-de-aplicaciones) - [Mirinsoft - SharpApp](https://github.com /builtbybel/sharpapp ) - [Mirinsoft - debotnet](https://github.com/builtbybel/debotnet) - [NSACyber - Lista blanca de aplicaciones con Microsoft AppLocker](https://apps.nsa.gov/iad/library /ia-guidance /tech-briefs/application-whitelisting-using-microsoft-applocker.cfm) - [NSACyber - Guía de Bitlocker](https://github.com/nsacyber/BitLocker-Guidance) - [NSACyber - Hardware- and-Firmware- Security-Guidance](https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance) - [ NSACyber - Línea base de host seguro de Windows](https://github.com/ nsacyber/Windows-Secure-Host-Baseline) - [UnderGroundWires - Privacidad.S\*\*Y](https://github.com/undergroundwires/privacy.sexy) - [Sycnex - Windows10Debloater](https://github .com/Sycnex /Windows10Debloater) - [El equipo de escritorio virtual - Herramienta de optimización de escritorio virtual](https://github.com/ El equipo de escritorio virtual/Herramienta de optimización de escritorio virtual) - [TheVDIGuys - Windows 10 VDI Optimize](https://github.com/TheVDIGuys/Windows_10_VDI_Optimize) - [VectorBCO - windows-path-enumerate](https://github.com/VectorBCO/windows-path-enumerate) - [W4H4WK - Desbloquear Windows 10 ](https://github.com/W4RH4WK/Debloat-Windows-10/tree/master/scripts) - [Whonix - Desactivar marcas de tiempo TCP](https://www.whonix.org/wiki/Disable_TCP_and_ICMP_Timestamps) # # Cómo ejecutar el script: ### GUI - Instalación guiada: Descargue la última versión [aquí](https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat-GUI/releases/), elija las opciones que desee y ejerza presión. <img src="https://raw.githubusercontent.com/simeononsecurity/Windows-Optimize-Harden-Debloat/master/.github/images/WOHD-GUI.gif" alt="Ejemplo de instalación guiada basada en GUI de Windows-Optimize-Harden-Debloat"> ### Instalación automatizada: utilice este resumen para descargar automáticamente, descomprimir todos los archivos compatibles y ejecutar la última versión del script. <img src="https://raw.githubusercontent.com/simeononsecurity/Windows-Optimize-Harden-Debloat/master/.github/images/w10automatic.gif" alt="Ejemplo de instalación automática de Windows-Optimize-Harden-Debloat"> ### Manual de instalación: si se descarga manualmente, el script debe iniciarse desde un powershell administrativo en el directorio que contiene todos los archivos del [repositorio de GitHub] (https://github.com/simeononsecurity/Windows-Optimize-Harden - Debloat ) El script &quot;sos-optimize-windows.ps1&quot; incluye varios parámetros que permiten personalizar el proceso de optimización. Cada parámetro es un valor booleano que por defecto es verdadero si no se especifica. - **cleargpos**: borra la configuración de los objetos de directiva de grupo. - **installupdates**: instala actualizaciones en el sistema. - **adobe**: implementa las STIG de Adobe Acrobat Reader. - **firefox**: Implementa FireFox STIG. - **chrome**: Implementa Google Chrome STIG. - **IE11**: implementa Internet Explorer 11 STIG. - **borde**: implementa Microsoft Chromium Edge STIG. - **dotnet**: Implementa Dot Net 4 STIG. - **oficina**: implementa las STIG relacionadas con Microsoft Office. - **onedrive**: implementa las STIG de Onedrive. - **java**: Implementa Oracle Java JRE 8 STIG. - **ventanas**: implementa las STIG de escritorio de Windows. - **defensor**: implementa Windows Defender STIG. - **cortafuegos**: implementa el STIG del cortafuegos de Windows. - **mitigaciones**: implementa mitigaciones generales de mejores prácticas. - **defenderhardening**: implementa y fortalece Windows Defender más allá de los requisitos de STIG. - **pshardening**: implementa PowerShell Hardening and Logging. - **sslhardening**: Implementa SSL Hardening. - **smbhardening**: soportar la configuración del servidor y del cliente SMB. - **applockerhardening**: instala y configura Applocker (en modo de solo auditoría). - **bitlockerhardening**: soporta la implementación de Bitlocker. - **removebloatware**: Elimina programas y características necesarias del sistema. - **disabletelemetry**: deshabilita la recopilación de datos y la telemetría. - **privacidad**: realiza cambios para mejorar la privacidad. - **imagecleanup**: limpia archivos necesarios del sistema. - **nessusPID**: resuelve cadenas de sistema sin comillas en la ruta. - **sysmon**: instala y configura sysmon para mejorar las capacidades de auditoría. - **diskcompression**: Comprime el disco del sistema. - **emet**: implementa los requisitos STIG y el endurecimiento para EMET en sistemas Windows 7. - **administración de actualizaciones**: cambia la forma en que se administra y mejora las actualizaciones en el sistema. - **deviceguard**: Habilita el fortalecimiento de Device Guard. - **sosbrowsers**: Optimiza los navegadores web del sistema. Un ejemplo de cómo lanzar el script con parámetros sería específico: