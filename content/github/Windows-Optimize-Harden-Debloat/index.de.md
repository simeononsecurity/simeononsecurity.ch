---
title: "Optimize and Harden Your Windows System with the Windows-Optimize-Harden-Debloat Script"
date: 2020-12-29
toc: true
draft: false
description: "This comprehensive guide provides step-by-step instructions on how to optimize, harden, and debloat your Windows system for improved performance, security, and privacy."
tags: ["Windows optimization", "Windows hardening", "Windows debloating", "Windows security", "Windows performance", "Windows privacy", "Windows updates", "Group Policy Objects", "Adobe Acrobat Reader", "Firefox", "Google Chrome", "Internet Explorer", "Microsoft Chromium Edge", "Dot Net 4", "Microsoft Office", "Onedrive", "Oracle Java JRE 8", "Windows Firewall", "Windows Defender", "Applocker"]
---
```powershell
iwr -useb 'https://simeononsecurity.ch/scripts/windowsoptimizeandharden.ps1'|iex
```
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
Get-ChildItem -Recurse *.ps1 | Unblock-File
powershell.exe -ExecutionPolicy ByPass -File .\sos-optimize-windows.ps1 -cleargpos:$false -installupdates:$false
```

## Einführung: Windows 10 und Windows 11 sind invasive und unsichere Betriebssysteme, die sofort einsatzbereit sind. Organisationen wie [PrivacyTools.io](https://PrivacyTools.io), [Microsoft](https://microsoft.com), [Cyber.mil](https://public.cyber.mil), die [Department of Defense](https://dod.gov) und die [National Security Agency](https://www.nsa.gov/) haben Änderungen empfohlen, um das Betriebssystem zu sperren, abzusichern und abzusichern. Diese Änderungen umfassen eine breite Palette von Maßnahmen ab, darunter das Blockieren von Telemetrie und Makros, das Entfernen von Bloatware und das Verhindern vieler digitaler und körperlicher Angriffe auf ein System. Dieses Skript zielt darauf ab, die von diesen Organisationen empfohlenen Konfigurationen zu automatisieren. ## Hinweise, Warnungen und Überlegungen: **WARNUNG:** Dieses Skript sollte auf den meisten, wenn nicht allen Systemen ohne Probleme funktionieren. Während [@SimeonOnSecurity](https://github.com/simeononsecurity) jedes Repo intensiv erstellt, überprüft und getestet, können wir nicht jede mögliche Konfiguration testen, und [@SimeonOnSecurity](https://github.com/simeononsecurity) tut stirbt auch nicht. übernehmen Sie keine Verantwortung für das Brechen Ihres Systems. If etwas schief geht, seien Sie bereit, ein [Problem] (../../issues) einzureichen. - Dieses Skript ist hauptsächlich für den Betrieb in Umgebungen für den **persönlichen Gebrauch** konzipiert. Aus diesem Grund sind bestimmte Unternehmenskonfigurationseinstellungen nicht implementiert. Dieses Skript ist nicht darauf, ein System zu 100 % konform zu machen. sollte es als Sprungbrett used Werden, um die meisten, WENN nicht alle Konfigurationsänderungen, die per Skript vorgenommen werden, abgeschlossen werden können, während Probleme wie Branding und Banner überspringen Werden, wo diese nicht einmal in einer gehärteten Umgebung für den persönlichen Gebrauch implementiert werden sollten . - Dieses Skript ist so konzipiert, dass die Optimierungen im Gegensatz zu einigen anderen Skripts die Kernfunktionen von Windows nicht beeinträchtigen. - Funktionen wie Windows Update, Windows Defender, der Windows Store und Cortona wurden eingeschränkt, befinden sich aber nicht in dysfunktionalen Zustand wie die meisten anderen Windows 10-Datenschutzskripts. - Wenn Sie ein minimales Skript suchen, das nur auf kommerzielle Umgebungen ausgerichtet ist, lesen Sie bitte dieses [GitHub-Repository] (https://github.com/simeononsecurity/Standalone-Windows-STIG-Script) **Führen Sie dieses Skript nicht aus, wenn Sie es nicht tun. nicht verstehen, was es tut. Es liegt in Ihrer Verantwortung, das Skript zu überprüfen und zu testen, bevor Sie es ausführen.** “ wird deaktiviert und umbenannt per DoD STIG - Gilt nicht für das erstellte Standardkonto, gilt aber für die Verwendung des Standardadministratorkontos, das häufig in Enterprise- , IOT- und Windows Server-Versionen zu finden ist - Erstellen Sie ein neues Konto unter Computerverwaltung und legen Sie es als Administrator fest, wenn Sie dies wünschen. Kopieren Sie dann den Inhalt des ersten Benutzerordners in den neuen, nachdem Sie sich zum ersten Mal beim neuen Benutzer angemeldet haben, um dies zu umgehen, bevor Sie das Skript ausführen. - Die Anmeldung mit einem Microsoft-Konto ist per DoD STIG deaktiviert. - Wenn Sie versuchen, sicher und privat zu sein, wird davon abgeraten, sich über ein Microsoft-Konto bei Ihrem lokalen Konto anzumelden. Dies wird durch dieses Repo erzwungen. - Erstellen Sie ein neues Konto unter Computerverwaltung und stellen Sie es auf Wunsch als Administrator ein. Kopieren Sie dann den Inhalt des ersten Benutzerordners in den neuen, nachdem Sie sich zum ersten Mal beim neuen Benutzer angemeldet haben, um dies zu umgehen, bevor Sie das Skript ausführen. - Konto-PINs sind per DoD STIG deaktiviert - PINs sind unsicher, wenn sie nur anstelle eines Passworts verwendet werden, und innerhalb can von weniger Stunden oder möglicherweise sogar oder Sekunden Minuten leicht umgangen werden - Entfernen Sie die PIN aus dem Konto und/oder melden SIE SICH MIT DEM PASSWORT AN NACH AUSFÜHREN DES Skripts. - Bitlocker-Standardeinstellungen wurden aufgrund von DoD STIG geändert und gehärtet. - Aufgrund der Implementierung von Bitlocker WIRD sterben Bitlocker-Implementierung unterbrechen, WENN this Änderungen auftreten UND SIE Bitlocker bereits aktiviert Haben. - Deaktivieren Sie Bitlocker, führen Sie das Skript aus und aktivieren Sie Bitlocker erneut, um dieses Problem zu umgehen. ## Anforderungen: - [x] Windows 10/11 Enterprise (**Bevorzugt**) oder Professional - Windows 10/11 Home-Editionen unterstützen keine GPO-Konfigurationen und werden nicht getestet. - Window &quot;N&quot; Editionen wurden nicht getestet. - [x] [Standards](https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-highly-secure) für ein hochsicheres Windows 10-Gerät - [x] System ist [vollständig aktuell und wird unterstützt](https://support.microsoft.com/en-gb/help/4027667/windows-10-update) - Führen Sie den [Windows Upgrade Assistant](https://support.microsoft .com/en-us/help/3159635/windows-10-update-assistant), um die neueste Hauptversion zu aktualisieren und zu überprüfen. - [x] Bitlocker muss vor der Implementierung dieses Skripts angehalten oder ausgeschaltet werden, es kann nach dem Neustart wieder aktiviert werden. - Folgeausführungen dieses Skripts können ohne Deaktivierung von Bitlocker ausgeführt werden. - [x] Hardwareanforderungen - [Hardwareanforderungen für Speicherintegrität] (https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/requirements-and-deployment-planning-guidelines -for- virtualization-based-protection-of-code-integrity#baseline-protections) – [Hardwareanforderungen für virtualisierungsbasierte Sicherheit](https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem- vbs) – [Hardwareanforderungen für Windows Defender Application Guard](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard/reqs -wd-app-guard) – [Hardwareanforderungen für Windows Defender Credential Guard](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements) ## Empfohlenes Lesematerial: - [System Guard Secure Launch](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system-guard/system-guard-secure-launch-and-smm-protection#requirements -met-by-system-guard-enabled-machines) – [System Guard Root of Trust] (https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-system- guard/system-guard-how-hardware-based-root-of-trust-helps-protect-windows) – [Hardwarebasierte Isolation](https://docs.microsoft.com/en-us/windows/security/threat- protection/microsoft-defender-atp/overview-hardware-based-isolation) – [Speicherintegrität](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/memory-integrity ) – [Windows Defender Application Guard] (https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-guard /wd-app-guard-overview) – [Windows Defender Credential Guard](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-how-it -works) ## Ergänzungen, bemerkenswerte Änderungen und Bugfixes: **Dieses Skript fügt Einstellungen auf System hinzu, entfernt und sie ändert. Bitte überprüfen Sie das Skript, bevor Sie es ausführen.** ### Browser: - Browser haben zusätzliche Erweiterungen installiert, um den Datenschutz und die Sicherheit zu unterstützen. – Weitere Informationen finden Sie [hier](https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat/issues/11). - Aufgrund der für Browser implementierten DoD-STIGs werden Erweiterungsverwaltung und andere Unternehmenseinstellungen festgelegt. Anweisungen zum Anzeigen dieser Optionen finden Sie in den folgenden GPO-Anweisungen. ### Powershell-Modul: - Um die Automatisierung von Windows-Updates zu unterstützen, wird das PowerShell-Modul [PSWindowsUpdate](https://www.powershellgallery.com/packages/PSWindowsUpdate/2.0.0.4) zu Ihrem System hinzugefügt. ### Microsoft-Konto, Store oder Xbox-Dienste reparieren: Dies liegt daran, dass wir die Anmeldung bei Microsoft-Konten blockieren. Die Telemetrie- und Identitätszuordnung von Microsoft ist verpönt. Wenn Sie diese Dienste jedoch weiterhin nutzen möchten, sehen Sie sich die folgenden Problemtickets zur Lösung an: - https://github.com/simeononsecurity/Windows-Optimize-Debloat/issues/1 - https://github.com/simeononsecurity/ Windows-Optimize-Harden-Debloat/issues/16 – https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat/issues/22 ### Bearbeiten von Richtlinien in der lokalen Gruppenrichtlinie im Nachhinein: Falls erforderlich Ändern oder ändern Sie eine Einstellung, sie sind höchstwahrscheinlich über GPO konfigurierbar: - Importieren Sie die ADMX-Richtliniendefinitionen aus diesem [Repo] (https://github.com/simeononsecurity/STIG-Compliant-Domain-Prep/tree/master/Files/ PolicyDefinitions ) in _C:\windows\PolicyDefinitions_ auf dem System, das Sie ändern möchten. - Öffnen Sie „gpedit.msc“ auf dem System, das Sie ändern möchten. ## Eine Liste von Skripten und Tools, die diese Sammlung verwendet: ### Erstanbieter: - [.NET-STIG-Script](https://github.com/simeononsecurity/.NET-STIG-Script) - [Automate- Sysmon ](https://github.com/simeononsecurity/Automate-Sysmon) – [FireFox-STIG-Skript](https://github.com/simeononsecurity/FireFox-STIG-Skript) – [JAVA-STIG-Skript] ( https://github.com/simeononsecurity/JAVA-STIG-Script) - [Standalone-Windows-STIG-Script](https://github.com/simeononsecurity/Standalone-Windows-STIG-Script) - [Windows- Defender -STIG-Skript](https://github.com/simeononsecurity/Windows-Defender-STIG-Skript) - [Windows-Optimize-Debloat](https://github.com/simeononsecurity/Windows-Optimize-Debloat) # ## Drittanbieter: - [Cyber.mil – Gruppenrichtlinienobjekte](https://public.cyber.mil/stigs/gpo/) - [Microsoft Security Compliance Toolkit 1.0](https://www.microsoft.com/de- us/download/details.aspx?id=55319) – [Microsoft Sysinternals – Sysmon](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon) ## Angewendete STIGS/SRGs: – [Adobe Acrobat Pro DC Continuous V2R1](https://public.cyber.mil/stigs/downloads/) - [Adobe Acrobat Reader DC Continuous V2R1](https://public.cyber.mil/stigs/downloads/) - [Firefox V5R2](https://public.cyber.mil/stigs/downloads/) - [Google Chrome V2R4](https://public.cyber.mil/stigs/downloads/) - [Internet Explorer 11 V1R19]( https: //public.cyber.mil/stigs/downloads/) - [Microsoft Edge V1R2](https://public.cyber.mil/stigs/downloads/) - [Microsoft .Net Framework 4 V1R9](https:/ /public .cyber.mil/stigs/downloads/) - [Microsoft Office 2013 V2R1](https://public.cyber.mil/stigs/downloads/) - [Microsoft Office 2016 V2R1](https://public.cyber .mil /stigs/downloads/) - [Microsoft Office 2019/Office 365 Pro Plus V2R3](https://public.cyber.mil/stigs/downloads/) - [Microsoft OneDrive STIG V2R1](https://public. cyber.mil/stigs/downloads/) - [Oracle JRE 8 V1R5](https://public.cyber.mil/stigs/downloads/) - [Windows 10 V2R2](https://public.cyber.mil/stigs /downloads/) - [Windows Defender Antivirus V2R2](https://public.cyber.mil/stigs/downloads/) - [Windows-Firewall V1R7](https://public.cyber.mil/stigs/downloads/) # # Zusätzliche Konfigurationen wurden berücksichtigt von: - [BuiltByBel - PrivateZilla](https://github.com/builtbybel/privatezilla) - [CERT - IE Scripting Engine Memory Corruption](https://kb.cert.org/vuls/ id /573168/) – [Dirteam – SSL Hardening](https://dirteam.com/sander/2019/07/30/howto-disable-weak-protocols-cipher-suites-and-hashing-algorithms-on-web - application-proxys-ad-fs-servers-and-windows-servers-running-azure-ad-connect/) – [MelodysTweaks – Grundlegende Optimierungen](https://sites.google.com/view/melodystweaks/basictweaks) – [Microsoft – Verwalten von Windows 10-Telemetrie und Rückrufen](https://docs.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft- services) – [Microsoft – Reduzieren Sie Angriffsflächen mit Regeln zur Angriffsflächenreduzierung](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction) – [Microsoft – Empfohlene Sperrregeln](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules) – [Microsoft – Empfohlener Treiber Blockregeln](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules) – [Microsoft – Specture and Meltdown Mitigations](https://support.microsoft.com/en-us/help/4072698/windows-server-speculative-execution-side-channel-vulnerabilities) – [Microsoft – Windows 10 Privacy](https://docs .microsoft.com/en-us/windows/privacy/) – [Microsoft – Windows 10 VDI-Empfehlungen](https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services /rds_vdi-recommendations-1909) – [Microsoft – Windows Defender Application Control] (https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender - Application-Control-Design-Guide) – [Mirinsoft – SharpApp](https://github.com/builtbybel/sharpapp) – [Mirinsoft – debotnet](https://github.com/builtbybel/debotnet) – [NSACyber – Anwendungs-Whitelisting mit Microsoft AppLocker](https://apps.nsa.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm) – [NSACyber – Bitlocker Guidance] (https://github.com/nsacyber/BitLocker-Guidance) – [NSACyber – Hardware-and-Firmware-Security-Guidance](https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance) - [NSACyber – Windows Secure Host Baseline](https://github.com/nsacyber/Windows-Secure-Host-Baseline) – [UnderGroundWires – Privacy.S\*\*Y](https://github.com/ undergroundwires/privacy.sexy) - [Sycnex - Windows10Debloater](https://github.com/Sycnex/Windows10Debloater) - [Das-Virtual-Desktop-Team - Virtual-Desktop-Optimization-Tool](https://github. com/The-Virtual-Desktop-Team/Virtual-Desktop-Optimization-Tool) – [TheVDIGuys – Windows 10 VDI Optimize](https://github.com/TheVDIGuys/Windows_10_VDI_Optimize) – [VectorBCO – windows-path-enumerate] (https://github.com/VectorBCO/windows-path-enumerate) – [W4H4WK – Debloat Windows 10](https://github.com/W4RH4WK/Debloat-Windows-10/tree/master/scripts) – [ Whonix - TCP-Zeitstempel deaktivieren](https://www.whonix.org/wiki/Disable_TCP_and_ICMP_Timestamps) ## So führen Sie das Skript aus: ### GUI - Geführte Installation: Laden Sie die neueste Version [hier] herunter (https ://github.com /simeononsecurity/Windows-Optimize-Harden-Debloat-GUI/releases/), wählen Sie die gewünschten Optionen und klicken Sie auf Ausführen. <img src="https://raw.githubusercontent.com/simeononsecurity/Windows-Optimize-Harden-Debloat/master/.github/images/WOHD-GUI.gif" alt="Beispiel für eine geführte Installation auf Windows-Optimize-Harden-Debloat-GUI"> ### Automatisierte Installation: Verwenden Sie diesen Einzeiler, um alle unterstützenden Dateien automatisch herunterzuladen, zu entpacken und die neueste Version des Skripts auszuführen. <img src="https://raw.githubusercontent.com/simeononsecurity/Windows-Optimize-Harden-Debloat/master/.github/images/w10automatic.gif" alt="Beispiel für die automatische Installation von Windows-Optimize-Harden-Debloat"> ### Manuelle Installation: Wenn das Skript manuell heruntergeladen WIRD, muss es von einer administrativen Powershell in dem Verzeichnis gestartet werden, das alle Dateien aus dem [GitHub-Repository] enthält (https://github.com/simeononsecurity/Windows-Optimize -Harden-Debloat ) Das Skript „sos-optimize-windows.ps1“ enthält mehrere Parameter, die eine Anpassung des Optimierungsprozesses ermöglichen. Jeder Parameter ist ein boolescher Wert, der standardmäßig wahr ist, wenn er nicht angegeben wird. - **cleargpos**: Löscht die Einstellungen der Gruppenrichtlinienobjekte. - **installupdates**: Installiert Updates für das System. - **adobe**: Implementiert die Adobe Acrobat Reader STIGs. - **firefox**: Implementiert das Firefox-STIG. - **chrome**: Implementiert das Google Chrome STIG. - **IE11**: Implementiert den Internet Explorer 11 STIG. - **edge**: Implementiert Microsoft Chromium Edge STIG. - **dotnet**: Implementiert das DotNet 4 STIG. - **office**: Implementiert die Microsoft Office-bezogenen STIGs. - **onedrive**: Implementiert die Onedrive-STIGs. - **java**: Implementiert das Oracle Java JRE 8 STIG. - **windows**: Implementiert die Windows-Desktop-STIGs. - **defender**: Implementiert das Windows Defender STIG. - **Firewall**: Implementiert die Windows Firewall STIG. - **Minderungen**: Implementiert allgemeine Best-Practice-Minderungen. - **defenderhardening**: Implementiert und härtet Windows Defender über die STIG-Anforderungen hinaus. - **pshardening**: Implementiert PowerShell-Härtung und -Protokollierung. - **sslhardening**: SSL-Hardening implementiert. - **smbhardening**: Härtet die SMB-Client- und -Servereinstellungen. - **applockerhardening**: Installierter und konfigurierter Applocker (nur im Audit-Modus). - **bitlockerhardening**: Bitlocker-Implementierung härten. - **bloatware entfernen**: Entfernt unnötige Programme und Funktionen vom System. - **disabletelemetry**: Deaktiviert die Datenerfassung und Telemetrie. - **Datenschutz**: Nimmt Änderungen vor, um den Datenschutz zu verbessern. - **imagecleanup**: Bereinigt nicht benötigte Dateien aus dem System. - **nessusPID**: Löst Systemstrings ohne Anführungszeichen im Pfad auf. - **sysmon**: Installiert und konfiguriert sysmon, um die Überwachungsfunktionen zu verbessern. - **diskcompression**: Komprimiert die Systemfestplatte. - **emet**: Implementiert STIG-Anforderungen und Härtung für EMET auf Windows 7-Systemen. - **Updateverwaltung**: Ändert die Art und Weise, wie Updates auf dem System verwaltet und verbessert werden. - **deviceguard**: Device Guard Hardening aktiviert. - **sosbrowsers**: Optimiert die Webbrowser des Systems. Ein Beispiel für das Starten des Skripts mit bestimmten Parametern wäre: