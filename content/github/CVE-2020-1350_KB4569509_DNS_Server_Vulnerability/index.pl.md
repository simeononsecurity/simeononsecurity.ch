---
title: "Usunięcie luki w serwerze DNS Windows za pomocą KB4569509 - krytyczna poprawka RCE"
date: 2020-07-25
---

[KB4569509: Guidance for DNS Server Vulnerability CVE-2020-1350](https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability)

## Wprowadzenie

14 lipca 2020 roku firma Microsoft wydała aktualizację bezpieczeństwa dla błędu, który został opisany w CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability. To powiadomienie opisuje krytyczną lukę w zdalnym wykonywaniu kodu (RCE), która dotyczy serwerów Windows skonfigurowanych do uruchamiania roli DNS Server. Zalecamy administratorom serwerów jak najszybsze zainstalowanie aktualizacji zabezpieczeń.

Obejście oparte na rejestrze może być wykorzystane do ochrony dotkniętego luki serwera Windows i może być wdrożone bez konieczności ponownego uruchamiania serwera przez administratora. Ze względu na niestabilność tej luki, administratorzy mogą być zmuszeni do wdrożenia obejścia przed zastosowaniem aktualizacji zabezpieczeń, aby umożliwić im aktualizację systemów przy użyciu standardowej procedury wdrażania.


## Obejście

**Opcjonalnie:** Pobierz skrypt obejścia z witryny[GitHub Repository](https://github.com/simeononsecurity/CVE-2020-1350-Fix)


Aby obejść tę lukę, należy dokonać następującej zmiany w rejestrze, aby ograniczyć rozmiar największego przychodzącego pakietu odpowiedzi DNS opartego na TCP:



Wartość: TcpReceivePacketSize

Typ: DWORD

Dane wartości: 0xFF00

**Notatki:**

    Domyślna (również maksymalna) wartość Value data = 0xFFFF.
	
    Zalecane Dane wartości = 0xFF00 (255 bajtów mniej niż maksimum).
	
    Aby zmiana w rejestrze zaczęła obowiązywać, należy ponownie uruchomić usługę DNS. W tym celu należy uruchomić następujące polecenie w podwyższonym wierszu poleceń:

          ```net stop dns && net start dns```


## Ważne informacje o tym obejściu
Pakiety odpowiedzi DNS oparte na TCP, które przekraczają zalecaną wartość, zostaną porzucone bez błędu. Dlatego możliwe jest, że niektóre zapytania mogą pozostać bez odpowiedzi. Może to spowodować nieoczekiwaną awarię. Serwer DNS będzie miał negatywny wpływ na to obejście tylko wtedy, gdy otrzyma ważne odpowiedzi TCP, które są większe niż dozwolone w poprzednim łagodzeniu (więcej niż 65 280 bajtów).

Zmniejszona wartość prawdopodobnie nie wpłynie na standardowe wdrożenia lub zapytania rekurencyjne. Jednak w danym środowisku może istnieć niestandardowy przypadek użycia. Aby określić, czy wdrożenie serwera będzie miało negatywny wpływ na to obejście, należy włączyć logowanie diagnostyczne i przechwycić zestaw próbek, który jest reprezentatywny dla typowego przepływu biznesowego. Następnie należy przejrzeć pliki dziennika, aby zidentyfikować obecność anomalnie dużych pakietów odpowiedzi TCP

Aby uzyskać więcej informacji, zobacz[DNS Logging and Diagnostics](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn800669%28v=ws.11%29)