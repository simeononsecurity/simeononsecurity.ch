---
title: "Оптимизация обновлений Windows с помощью автоматизации с помощью Chocolatey, PSWindowsUpdate и сценариев запуска"
date: 2020-07-22
---
 Обновления Windows с помощью Chocolatey, PSWindowsUpdate и сценариев запуска**

В сегодняшней быстро меняющейся бизнес-среде время имеет решающее значение для системных администраторов. Обновление компьютеров с Windows, критический аспект системного администрирования, может быть чрезвычайно трудоемкой задачей, которая может занять до недели при наличии достаточного количества систем. Однако с некоторой помощью от Chocolatey, PSWindowsUpdates и Startup Scripts теперь можно развертывать обновления всего за одну перезагрузку каждой машины, что значительно сокращает время, необходимое для выполнения обновлений.

## Оптимизация обновлений Windows с помощью автоматизации

Обновления Windows имеют решающее значение для поддержания стабильности и безопасности компьютеров Windows. Выполнение обновлений на большом количестве машин может занять много времени, особенно для системных администраторов с ограниченными ресурсами. Однако с помощью средств автоматизации, таких как Chocolatey, PSWindowsUpdate и Startup Scripts, этот процесс можно упростить, чтобы позволить администраторам выполнять обновления с минимальными усилиями.

### Шоколадный

[Chocolatey](https://chocolatey.org/) — это менеджер пакетов для Windows, который можно использовать для автоматизации установки программного обеспечения на компьютерах с Windows. Он похож на apt-get в Ubuntu или homebrew в macOS, и его можно использовать для установки и управления широким спектром программных пакетов. Chocolatey можно использовать для автоматической установки пакетов, что означает, что они могут быть установлены без вмешательства пользователя.

### PSWindowsUpdate

[PSWindowsUpdate](https://www.powershellgallery.com/packages/PSWindowsUpdate/2.0.0.4) — это модуль PowerShell, который можно использовать для автоматизации установки обновлений Windows. Он предоставляет командлеты, которые можно использовать для установки, удаления и отображения обновлений Windows. PSWindowsUpdate — это мощный инструмент, который можно использовать для управления обновлениями Windows на нескольких компьютерах, что делает его идеальным для системных администраторов, которым необходимо управлять большим количеством компьютеров.

### Сценарии запуска

[Startup Scripts](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn789190(v=ws.11)) — это сценарии, которые можно использовать для автоматизации задач, которые необходимо выполнять при запуске или выключении машины. Эти сценарии можно использовать для выполнения таких задач, как установка программного обеспечения, настройка параметров и управление обновлениями Windows.

## Автоматизация обновлений Windows с помощью одной перезагрузки

Чтобы автоматизировать обновления Windows с помощью Chocolatey, PSWindowsUpdate и сценариев запуска, администраторы могут следовать приведенному ниже пошаговому руководству.

### Настройка сценария завершения работы
Загрузите все вспомогательные файлы с[GitHub Repository](https://github.com/simeononsecurity/ChocoAutomateWindowsUpdates)

1. Откройте редактор локальной групповой политики, нажав **"Win + R"** и введя **"gpedit.msc"**, а затем **"Ctrl + Shift + Enter"**.
2. Перейдите к компьютеру **Конфигурация\Настройки Windows\Сценарии (запуск/выключение)**.
3. В области результатов дважды щелкните Завершение работы.
4. Выберите вкладку PowerShell.
5. В диалоговом окне «Свойства выключения» нажмите «Добавить».
6. В поле «Имя сценария» введите путь к сценарию или нажмите «Обзор», чтобы выполнить поиск «*chocoautomatewindowsupdates.ps1*» в общей папке Netlogon на контроллере домена.
7. Перезагрузитесь.

Теперь все, что нужно сделать администратору, это перезагрузить компьютер, чтобы выполнить обновления Windows.

### Понимание скрипта

Сценарий, используемый для автоматизации обновлений Windows, называется «*chocoautomatewindowsupdates.ps1*». Он выполняет следующие задачи:

1. Устанавливает менеджер пакетов Chocolatey.
2. Включает несколько предпочтительных изменений конфигурации Chocolatey.
3. Обновляет все установленные пакеты Chocolatey.
4. Устанавливает модуль PSWindowsUpdate PowerShell.
5. Добавляет диспетчер службы Центра обновления Windows.
6. Устанавливает все доступные обновления Windows.
7. Устанавливает все отсутствующие драйверы или обновления, необходимые для ранее установленных обновлений.

### Преимущества автоматизации обновлений Windows

Автоматизация обновлений Windows с помощью Chocolatey, PSWindowsUpdate и сценариев запуска имеет несколько преимуществ для системных администраторов. Эти преимущества включают в себя:

- **Экономия времени**: автоматизация обновлений Windows значительно сокращает время, необходимое для выполнения обновлений. Администраторам больше не нужно вручную устанавливать обновления на каждую машину.
- **Согласованность**: автоматизация обновлений Windows гарантирует, что обновления будут установлены последовательно на всех компьютерах. Это снижает вероятность ошибок и уязвимостей безопасности.
- **Централизованное управление**: автоматизация обновлений Windows позволяет администраторам управлять обновлениями из центрального расположения, что упрощает отслеживание того, какие обновления были установлены и какие машины нуждаются в обновлениях.
- **Повышенная безопасность**: автоматизация обновлений Windows гарантирует, что на компьютерах будут установлены последние исправления безопасности, что снижает риск нарушения безопасности.

### Заключение

Автоматизация обновлений Windows с помощью Chocolatey, PSWindowsUpdate и сценариев запуска — это мощный инструмент, который может сэкономить системным администраторам много времени и усилий. Это позволяет последовательно и эффективно устанавливать обновления, гарантируя, что на компьютерах будут установлены последние исправления безопасности. Следуя шагам, описанным в этом руководстве, администраторы могут автоматизировать обновления Windows с помощью всего одной перезагрузки, что значительно ускорит и упростит процесс обновления компьютеров с Windows.
