---
title: "Chocolatey、PSWindowsUpdate、スタートアップ スクリプトを使用した自動化による Windows アップデートの効率化"
date: 2020-07-22
---
 Chocolatey、PSWindowsUpdate、スタートアップ スクリプトによる Windows 更新**

今日のペースの速いビジネス環境では、システム管理者にとって時間は非常に重要です。システム管理の重要な側面である Windows マシンの更新は、非常に時間のかかる作業であり、システムが十分にある場合には最大で 1 週間かかる場合があります。ただし、Chocolatey、PSWindowsUpdates、およびスタートアップ スクリプトの支援により、各マシンを 1 回再起動するだけで更新を展開できるようになり、更新の実行に必要な時間が大幅に短縮されます。

## 自動化による Windows 更新の合理化

Windows アップデートは、Windows マシンの安定性とセキュリティを維持するために重要です。多数のマシンで更新を実行することは、特にリソースが限られているシステム管理者にとっては、時間のかかる作業になる可能性があります。ただし、Chocolatey、PSWindowsUpdate、スタートアップ スクリプトなどの自動化ツールを使用すると、このプロセスを合理化し、管理者が最小限の労力で更新を実行できるようになります。

### チョコレートティ

[Chocolatey](https://chocolatey.org/) は、Windows マシンへのソフトウェアのインストールを自動化するために使用できる Windows 用のパッケージ マネージャーです。これは、Ubuntu の apt-get や macOS の homebrew に似ており、幅広いソフトウェア パッケージのインストールと管理に使用できます。 Chocolatey を使用すると、パッケージをサイレントにインストールできます。つまり、ユーザーの介入なしでパッケージをインストールできます。

### PSWindowsUpdate

[PSWindowsUpdate](https://www.powershellgallery.com/packages/PSWindowsUpdate/2.0.0.4) は、Windows 更新プログラムのインストールを自動化するために使用できる PowerShell モジュールです。 Windows 更新プログラムのインストール、アンインストール、一覧表示に使用できるコマンドレットが提供されます。 PSWindowsUpdate は、複数のマシン上の Windows 更新プログラムを管理するために使用できる強力なツールであり、多数のマシンを管理する必要があるシステム管理者にとって理想的です。

### 起動スクリプト

[Startup Scripts](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn789190(v=ws.11)) は、マシンの起動時またはシャットダウン時に実行する必要があるタスクを自動化するために使用できるスクリプトです。これらのスクリプトは、ソフトウェアのインストール、設定の構成、Windows アップデートの管理などのタスクを実行するために使用できます。

## 1 回の再起動で Windows アップデートを自動化する

Chocolatey、PSWindowsUpdate、およびスタートアップ スクリプトを使用して Windows 更新を自動化するには、管理者は以下のステップバイステップ ガイドに従うことができます。

### シャットダウン スクリプトの設定
すべてのサポート ファイルを次の場所からダウンロードします。[GitHub Repository](https://github.com/simeononsecurity/ChocoAutomateWindowsUpdates)

1. **「Win + R」** を押し、**「gpedit.msc」** に続いて **「Ctrl + Shift + Enter」** を入力して、ローカル グループ ポリシー エディターを開きます。
2. コンピューター **構成\Windows 設定\スクリプト (スタートアップ/シャットダウン)** に移動します。
3. 結果ペインで、「シャットダウン」をダブルクリックします。
4. [PowerShell] タブを選択します。
5. [シャットダウン プロパティ] ダイアログ ボックスで、[追加] をクリックします。
6. [スクリプト名] ボックスにスクリプトへのパスを入力するか、[参照] をクリックしてドメイン コントローラーの Netlogon 共有フォルダーで「*chocoautomatewindowsupdates.ps1*」を検索します。
7. 再起動します。

これで、管理者が行う必要があるのは、コンピュータを再起動して Windows アップデートを実行することだけです。

### スクリプトを理解する

Windows アップデートの自動化に使用されるスクリプトのタイトルは「*chocoautomatewindowsupdates.ps1*」です。次のタスクを実行します。

1. Chocolatey パッケージ マネージャーをインストールします。
2. いくつかの推奨される Chocolatey 構成変更を有効にします。
3. インストールされているすべての Chocolatey パッケージをアップグレードします。
4. PSWindowsUpdate PowerShell モジュールをインストールします。
5. Windows Update サービス マネージャーを追加します。
6. 利用可能なすべての Windows アップデートをインストールします。
7. 不足しているドライバーや、以前にインストールしたアップデートに必要なアップデートがあればインストールします。

### Windows アップデートを自動化する利点

Chocolatey、PSWindowsUpdate、およびスタートアップ スクリプトを使用して Windows 更新を自動化すると、システム管理者にとっていくつかの利点があります。これらの利点には次のものが含まれます。

- **時間の節約**: Windows アップデートを自動化すると、アップデートの実行に必要な時間が大幅に短縮されます。管理者は各マシンにアップデートを手動でインストールする必要がなくなりました。
- **一貫性**: Windows 更新を自動化することで、すべてのマシンに更新が一貫してインストールされるようになります。これにより、エラーやセキュリティ上の脆弱性が発生する可能性が軽減されます。
- **一元管理**: Windows 更新を自動化すると、管理者は更新を一元管理できるため、どの更新がインストールされているか、どのマシンに更新が必要かを簡単に追跡できるようになります。
- **セキュリティの強化**: Windows アップデートを自動化することで、マシンが最新のセキュリティ パッチで最新の状態に保たれ、セキュリティ侵害のリスクが軽減されます。

＃＃＃ 結論

Chocolatey、PSWindowsUpdate、およびスタートアップ スクリプトを使用して Windows 更新を自動化することは、システム管理者の時間と労力を大幅に節約できる強力なツールです。これにより、アップデートを一貫して効率的にインストールできるため、マシンが最新のセキュリティ パッチで最新の状態に保たれます。このチュートリアルで概説されている手順に従うことで、管理者は 1 回の再起動で Windows アップデートを自動化できるため、Windows マシンのアップデート プロセスがより迅速かつ簡単になります。
