---
title: "Streamline Windows Updates with Automation using Chocolatey, PSWindowsUpdate, and Startup Scripts"
date: 2020-07-22T17:46:00-05:00
toc: true
draft: false
description: "Learn how to automate Windows updates with a single reboot and save valuable time for system administrators using Chocolatey, PSWindowsUpdate, and Startup Scripts."
tags: ["Automation", "Windows Updates", "Windows 10", "Powershell", "Script", "Chocolatey", "PSWindowsUpdate", "Startup Scripts", "System Administrators", "Windows Update Processes", "Local Group Policy Editor", "GP", "GPO", "Group Policy Objects", "Package Manager", "Consistency", "Centralized Management", "Security", "Software Management", "Microsoft Updates"]
---

**Automatisation des mises à jour Windows avec Chocolatey, PSWindowsUpdate et les scripts de démarrage**  Dans l'environnement d'affaires en évolution rapide d'aujourd'hui, le temps est essentiel pour les administrateurs système. La mise à jour des machines Windows, un aspect critique de l'administration des systèmes, peut être une tâche extrêmement chronophage pouvant prendre jusqu'à une semaine, avec suffisamment de systèmes. Cependant, avec l'aide de Chocolatey, PSWindowsUpdates et des scripts de démarrage, il est désormais possible d'épuiser des mises à jour avec aussi peu qu'un seul permette de chaque machine, ce qui réduit peut-être le temps nécessaire pour effectuer les mises à jour.  ## Rationaliser les mises à jour Windows avec l'automatisation  Les mises à jour Windows sont essentielles pour maintenir la stabilité et la sécurité des machines Windows. L'exécution de mises à jour sur un grand nombre de machines peut être une tâche fastidieuse, en particulier pour les administrateurs système disposant de ressources limitées. Cependant, avec l'utilisation d'outils d'automatisation tels que Chocolatey, PSWindowsUpdate et les scripts de démarrage, ce processus peut être rationalisé pour permettre aux administrateurs d'effectuer des mises à jour avec un minimum d'effort.  ### Chocolat  [Chocolatey](https://chocolatey.org/) est un gestionnaire de packages pour Windows qui peut être utilisé pour automatiser l'installation de logiciels sur des machines Windows. Il est similaire à apt-get sur Ubuntu ou homebrew sur macOS, et il peut être utilisé pour installer et gérer une large gamme de packages logiciels. Chocolatey peut être utilisé pour installer des packages en mode silencieux, ce qui signifie qu'ils peuvent être installés sans intervention de l'utilisateur.  ### PSWindowsUpdate  [PSWindowsUpdate](https://www.powershellgallery.com/packages/PSWindowsUpdate/2.0.0.4) est un module PowerShell qui peut être utilisé pour automatiser l'installation des mises à jour Windows. Il peut fournir des applets de commande qui peuvent être utilisés pour installer, désinstaller et répertorier les mises à jour Windows. PSWindowsUpdate est un outil puissant qui peut être utilisé pour gérer les mises à jour Windows sur plusieurs machines, ce qui le rend idéal pour les administrateurs système qui doivent gérer un grand nombre de machines.  ### Scripts de démarrage  [Scripts de démarrage](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn789190(v=ws.11) ) sont des scripts qui peuvent être utilisés pour automatiser les tâches qui doivent être effectuées lorsqu'une machine démarre ou s'arrête. Ces scripts peuvent être utilisés pour effectuer des tâches telles que l'installation de logiciels, la configuration des paramètres et la gestion des mises à jour Windows.  ## Automatisation des mises à jour Windows avec un seul dépannage  Pour automatiser les mises à jour Windows à l'aide de Chocolatey, PSWindowsUpdate et des scripts de démarrage, les administrateurs peuvent suivre le guide étape par étape ci-dessous.  ### Configuration du script d'arrêt Téléchargez tous les fichiers de support à partir du [référentiel GitHub](https://github.com/simeononsecurity/ChocoAutomateWindowsUpdates)  1. Ouvrez l'éditeur de stratégie de groupe local en utilisant **"Win + R"** et en tapant **"gpedit.msc"** suivi de **"Ctrl + Maj + Entrée"**. 2. Accédez à Ordinateur **Configuration\Paramètres Windows\Scripts (Démarrage/Arrêt)**. 3. Dans le volet des résultats, double-cliquez sur Arrêter. 4. Sélectionnez l'onglet PowerShell. 5. Dans la boîte de dialogue Propriétés de l'arrêt, cliquez sur Ajouter. 6. Dans la zone Nom du script, saisissez le chemin d'accès au script ou cliquez sur Parcourir pour rechercher « *chocoautomatewindowsupdates.ps1* » dans le dossier partagé Netlogon sur le contrôleur de domaine. 7. Redémarrez.  Désormais, tout ce qu'un administrateur doit faire est de remettre à neuf l'ordinateur pour effectuer les mises à jour de Windows.  ### Comprendre le script  Le script utilisé pour automatiser les mises à jour de Windows s'intitule "*chocoautomatewindowsupdates.ps1*". Il effectue les tâches suivantes :  1. Installe le gestionnaire de paquets Chocolatey. 2. Activez quelques changements de configuration préférés de Chocolatey. 3. Met à jour tous les packages Chocolatey installés. 4. Installez le module PSWindowsUpdate PowerShell. 5. Ajout du gestionnaire de service Windows Update. 6. Installez toutes les mises à jour Windows disponibles. 7. Installez les pilotes manquants ou les mises à jour requises par les mises à jour précédemment installées.  ### Avantages de l'automatisation des mises à jour Windows  L'automatisation des mises à jour Windows à l'aide de Chocolatey, PSWindowsUpdate et des scripts de démarrage présente plusieurs avantages pour les administrateurs système. Ces avantages comprennent :  - **Gain de temps** : l'automatisation des mises à jour Windows réduit peut permettre le temps nécessaire pour effectuer les mises à jour. Les administrateurs n'ont plus à installer manuellement les mises à jour sur chaque machine. - **Cohérence** : l'automatisation des mises à jour Windows garantit que les mises à jour sont installées de manière cohérente sur toutes les machines. Cela réduit la probabilité d'erreurs et de failles de sécurité. - **Gestion centralisée** : l'automatisation des mises à jour Windows permet aux administrateurs de gérer les mises à jour à partir d'un emplacement central, ce qui facilite le suivi des mises à jour installées et des machines nécessitant des mises à jour. - **Sécurité accumulée** : l'automatisation des mises à jour Windows garantit que les machines sont mises à jour avec les derniers correctifs de sécurité, craignant ainsi le risque de failles de sécurité.  ### Conclusion  L'automatisation des mises à jour Windows à l'aide de Chocolatey, PSWindowsUpdate et des scripts de démarrage est un outil puissant qui peut faire gagner beaucoup de temps et d'efforts aux administrateurs système. Il permet d'installer les mises à jour de manière cohérente et efficace, garantissant que les machines sont à jour avec les derniers correctifs de sécurité. En suivant les étapes décrites dans ce didacticiel, les administrateurs peuvent automatiser les mises à jour Windows en un seul nettoyage, ce qui rend le processus de mise à jour des machines Windows beaucoup plus rapide et plus facile.