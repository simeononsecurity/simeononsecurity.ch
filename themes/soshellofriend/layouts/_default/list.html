{{ define "main" }}
{{ if or .isSection}}
{{ $cover := resources.Get (.Params.Cover)}}
{{ if .Params.UseRelativeCover }}
  {{ $cover = resources.GetRemote (printf "%s%s" .Permalink .Params.Cover) }}
{{ end }}
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "Section Name",
      "description": "Description of the section",
      "itemListElement": [
        {{ range .Paginator.Pages }}
        {
          "@type": "ListItem",
          "position": "{{ add .Paginator.PageNumber 1 }}",
          "item": {
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "WebPage",
              "@id": "{{ .Permalink }}"
            },
            "headline": "{{ .Title }}",
            "url": "{{ .Permalink }}",
            "datePublished": "{{ .Date.Format "2006-01-02" }}",
            "author": {
              "@type": "Person",
              "name": "{{ with .Params.Author }}{{ . }}{{ else }}SimeonOnSecurity{{ end }}", 
              "url": "{{ with .Params.Author }}{{ $.Site.BaseURL }}/authors/{{ . }}{{ else }}{{ "/authors/simeononsecurity" | absURL }}{{ end }}"
            },
            {{ if .Params.Cover }}
            "image": {
              "@type": "ImageObject",
              "url": "{{ $cover.Permalink }}"
            },
            {{ end }}
          }
        }{{ if not (last $.Paginator.Pages .) }},{{ end }}
        {{ end }}
      ]
    }
  </script>
{{ end }}
{{ partialCached "breadcrumbs.html" . .Page .Page.Page .Site.Language.Lang .Language.Lang}}
<br>
{{ partialCached "ads/random-eager.html" .Page .Page.Page }}
{{ partialCached "ads/random-eager-floating.html" .Page .Page.Page }}
<br>
{{ $languageCode := $.Site.LanguageCode }}
  <h1 class="post-title"><a title="{{ .Title | markdownify }}" href="{{ .Permalink }}" hreflang="{{ $languageCode }}">{{ if strings.Contains $.Permalink "/tags/" }}Other Posts Tagged "<u>{{ .Title | markdownify }}</u>"{{ else }}{{ .Title | markdownify }}{{ end }}</a></h1>
  <div class="posts" itemscope itemtype="https://schema.org/Blog">
    {{ $counter := 0 }}
    {{ range .Paginator.Pages }}
      {{ $counter = add $counter 1 }}
      {{ $imgloading := "" }}
      {{ if eq $counter 1 }}
        {{ $imgloading = "eager" }}
      {{ else }}
        {{ $imgloading = "lazy" }}
      {{ end }}
      <article class="post on-list" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
        <h2 class="post-title" itemprop="headline"><a href="{{ .Permalink }}" title="{{ .Title | markdownify }}" itemprop="url">{{ .Title | markdownify }}</a></h2>
        <div class="post-meta">
          {{ if .Date }}
            <time class="post-date" itemprop="datePublished" content="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format ($.Site.Params.DateFormatList | default "2006-01-02") }}</time>
            {{ if $.Site.Params.LastModDisplay }}
              {{ partialCached "lastmod.html" . .Page .Page.Page .Site.Language.Lang .Language.Lang}}
            {{ end }}
          {{ end }}
          {{ $excludePaths := slice "/about" "/contact" "/terms" "/privacy" "/authors" "/tools" "/practice-tests"}}
          {{ $currentPath := .Permalink }}
          {{ if not (in $currentPath $excludePaths) }}
            {{ if .Params.Author }}
              {{ with .Params.Author }}
                <span itemscope itemtype="https://schema.org/Author">
                  <span class="post-author" itemscope itemtype="https://schema.org/Person">
                    — {{ $.Site.Params.WrittenBy | default "Written by" }} 
                    <a href="{{ ("/authors/({{ . | lower }})"| absURL) }}" hreflang="{{ $languageCode }}" itemprop="url">
                      <span itemprop="name">{{ . }}</span>
                    </a>
                  </span>
                </span>
              {{ end }}
            {{ else }}
              <span itemscope itemtype="https://schema.org/Author">
                <span class="post-author" itemscope itemtype="https://schema.org/Person">
                  — {{ $.Site.Params.WrittenBy | default "Written by" }} 
                  <a href="{{ ("/authors/simeononsecurity"| absURL) }}" hreflang="{{ $languageCode }}" itemprop="url">
                    <span itemprop="name">SimeonOnSecurity</span>
                  </a>
                </span>
              </span>
            {{ end }}
          {{ end }}
          {{ if $.Site.Params.ShowReadingTime }}
            <span class="post-read-time">— {{ .ReadingTime }} {{ $.Site.Params.MinuteReadingTime | default "min read" }}</span>
          {{ end }}
        </div>
        <div class="post-content" itemprop="articleBody">
          {{ with .Description }}
            {{ . | markdownify }}
          {{ else }}
            {{ if .Truncated }}
              {{ .Summary }}
            {{ end }}
          {{ end }}
        </div>
        {{ if .Params.Cover }}
          <a href="{{ .Permalink }}" title="{{ .Title | markdownify }}" itemprop="url">
            {{ partialCached "postcover.html" (dict "context" . "imgloading" $imgloading) .Page .Page.Page}}
          </a>
        {{ end }}
        {{ if .Params.tags }}
          <span class="post-tags">
            {{ $tags := .Params.tags | first 10 }}
            {{ range $tags }}
              <a href="{{ (urlize (printf "tags/%s" .)) | absLangURL }}/" title="{{ . }}" hreflang="{{ $languageCode }}" rel="nofollow">#{{ . }}</a>&nbsp;
            {{ end }}
          </span>
        {{ end }}
        {{ if not .Params.hideReadMore }}
          <div>
            <a class="read-more button" title="read more" href="{{ .RelPermalink }}" hreflang="{{ $languageCode }}">{{ $.Site.Params.ReadMore | default "Read more" }} →</a>
          </div>
        {{ end }}
      </article>
    {{ end }}
    {{ partial "pagination.html" . .Page .Page.Page .Site.Language.Lang .Language.Lang}}
    {{ partialCached "displayads-responsive-horizontal-index.list..html" . }}
  </div>
{{ end }}
