<script
  async
  src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"
></script>
<script
  async
  data-ad-client="ca-pub-4092442123207538"
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4092442123207538"
  crossorigin="anonymous"
></script>
<script async>
  const adPlaceholders = document.querySelectorAll(".ad-placeholder");

  function loadAd(adPlaceholder) {
    const adClientId = adPlaceholder.getAttribute("data-ad-client");
    const randomInt = adPlaceholder.getAttribute("random-int");
  
    if (!adClientId || !randomInt) {
      console.error("Ad client ID or random-int attribute not found.");
      return;
    }
  
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: adClientId,
      enable_page_level_ads: true,
      done_loading: function () {
        adPlaceholder.style.visibility = "visible";
        const imgPlaceholder = adPlaceholder.querySelector('img[alt="Ad Placeholder"]');
        if (imgPlaceholder) {
          imgPlaceholder.remove();
        }
      },
    });
  
    console.log("Ad loaded with random-int:", randomInt);
  }

  function checkIfAdShouldLoad(adPlaceholder) {
    const randomInt = adPlaceholder.getAttribute("random-int");
    if (window.innerHeight + window.scrollY < document.body.offsetHeight || !randomInt) {
      return;
    }
    const adLoaded = adPlaceholder.classList.contains("ad-loaded");
    if (!adLoaded) {
      loadAd(adPlaceholder);
      adPlaceholder.classList.add("ad-loaded");
    }
  }

  function debounce(func, delay) {
    let timeoutId;
    let rafId;

    function wrappedFunc() {
      clearTimeout(timeoutId);
      rafId = requestAnimationFrame(() => {
        func();
        rafId = null;
      });
    }

    return function () {
      clearTimeout(timeoutId);
      cancelAnimationFrame(rafId);
      timeoutId = setTimeout(wrappedFunc, delay);
    };
  }

  function onPageLoad() {
    adPlaceholders.forEach(function (adPlaceholder) {
      lazyLoadAd(adPlaceholder);
    });
  }

  function lazyLoadAd(adPlaceholder) {
    const observerCallback = debounce(function (entries, observer) {
      entries.forEach(function (entry) {
        if (entry.isIntersecting) {
          const adLoaded = adPlaceholder.classList.contains("ad-loaded");
          if (!adLoaded) {
            loadAd(adPlaceholder);
            adPlaceholder.classList.add("ad-loaded");
          }
          observer.unobserve(entry.target);
        }
      });
    }, 200);

    const observer = new IntersectionObserver(observerCallback, { rootMargin: "200px", threshold: 0 });

    try {
      observer.observe(adPlaceholder);
    } catch (error) {
      console.error("Error observing ad placeholder element:", error);
    }
  }

  window.addEventListener("load", onPageLoad, { passive: true });
</script>

<script defer>
  window.addEventListener("DOMContentLoaded", function() {
    try {
      var iframes = document.querySelectorAll(
        'iframe[src*="https://googleads.g.doubleclick.net"], iframe[data-google-container-id]'
      );

      iframes.forEach(function(iframe) {
        iframe.setAttribute("title", "google ads");
        iframe.setAttribute("role", "banner");

        if (iframe.hasAttribute("data-google-container-id") && iframe.complete) {
          setAttributes(iframe);
        } else {
          iframe.addEventListener("load", function() {
            setAttributes(iframe);
          });
        }
      });

      function setAttributes(iframe) {
        var containerId = iframe.getAttribute("data-google-container-id");
        iframe.setAttribute("title", "google ads");
        iframe.setAttribute("role", "banner");
      }
    } catch (error) {
      // Handle any errors that occur during the execution of the code
      console.error("An error occurred:", error);
    }
  });
</script>